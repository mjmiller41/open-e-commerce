import{r as d,j as e,M as mt,S as ut,I as ht,C as Ge,a as pt,X as K,u as ie,b as Ke,P as Se,c as je,L as q,d as Ne,U as Me,e as ke,O as Ye,F as xt,f as gt,T as ft,Y as bt,h as yt,V as Re,G as vt,i as jt,k as Nt,l as wt,m as Je,n as _t,R as Ct,o as Qe,p as xe,H as St,q as kt,s as Pt,A as Xe,t as Ze,v as Et,w as At,x as Ee,y as It,z as Dt,B as Ft,D as zt,E as Mt,J as ye,K as Rt,N as Tt,Q as Lt,W as Ot,Z as $t,_ as qt,$ as Te,a0 as ge,a1 as Ut,a2 as Bt,a3 as Wt,a4 as Vt,a5 as G,a6 as Ht}from"./react-vendor-ECFXBBGq.js";import{c as Gt}from"./supabase-BUiByx9r.js";import{t as Kt,c as Yt}from"./ui-vendor-BNe0Xlio.js";import{t as et}from"./taxonomy-8tmzMNDP.js";import{P as Le}from"./utils-BrpajXRa.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const m of l.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function s(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(r){if(r.ep)return;r.ep=!0;const l=s(r);fetch(r.href,l)}})();function Jt(){const[t,a]=d.useState(()=>{const n=localStorage.getItem("theme");return n||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});d.useEffect(()=>{document.documentElement.setAttribute("data-theme",t),localStorage.setItem("theme",t)},[t]);const s=()=>{a(n=>n==="light"?"dark":"light")};return e.jsx("button",{onClick:s,className:"btn btn-ghost","aria-label":"Toggle theme",title:`Switch to ${t==="light"?"dark":"light"} mode`,children:t==="light"?e.jsx(mt,{size:20}):e.jsx(ut,{size:20})})}const tt=d.createContext(void 0);function Qt(){const t=d.useContext(tt);if(!t)throw new Error("useToast must be used within a ToastProvider");return t}function Xt({children:t}){const[a,s]=d.useState([]),n=d.useCallback((l,m="info")=>{const u=crypto.randomUUID();s(i=>[...i,{id:u,message:l,type:m}])},[]),r=d.useCallback(l=>{s(m=>m.filter(u=>u.id!==l))},[]);return e.jsxs(tt.Provider,{value:{addToast:n,removeToast:r},children:[t,e.jsx("div",{className:"fixed bottom-4 right-4 z-[100] flex flex-col gap-2 pointer-events-none",children:a.map(l=>e.jsx(Zt,{toast:l,onRemove:r},l.id))})]})}function Zt({toast:t,onRemove:a}){const[s,n]=d.useState(!1),r=d.useRef(null);d.useEffect(()=>(requestAnimationFrame(()=>n(!0)),r.current=setTimeout(()=>{n(!1),setTimeout(()=>a(t.id),300)},3e3),()=>{r.current&&clearTimeout(r.current)}),[t.id,a]);const l={success:pt,error:Ge,info:ht}[t.type];return e.jsxs("div",{className:`
        pointer-events-auto flex items-center gap-3 px-4 py-3 rounded-md shadow-lg border transition-all duration-300 transform
        ${s?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}
        ${t.type==="success"?"bg-background border-green-500/50 text-foreground":""}
        ${t.type==="error"?"bg-destructive/10 border-destructive/50 text-destructive":""}
        ${t.type==="info"?"bg-background border-blue-500/50 text-foreground":""}
      `,children:[e.jsx(l,{size:18,className:t.type==="success"?"text-green-500":t.type==="error"?"text-destructive":"text-blue-500"}),e.jsx("span",{className:"text-sm font-medium",children:t.message}),e.jsx("button",{onClick:()=>{n(!1),setTimeout(()=>a(t.id),300)},className:"ml-2 opacity-70 hover:opacity-100",children:e.jsx(K,{size:16})})]})}const es="https://wvgdmsgtthglwcjziwxo.supabase.co",ts="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind2Z2Rtc2d0dGhnbHdjanppd3hvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY0MzgzMDcsImV4cCI6MjA4MjAxNDMwN30.tKYG2ollZ-AszhVmYLzEYu78lTetsYhHuAA4Q6BHlrI",k=Gt(es,ts);async function ss(t){const a=`${Date.now()}_${t.name.replace(/\s+/g,"-")}`,{data:s,error:n}=await k.storage.from("products").upload(a,t);if(n)throw n;const{data:{publicUrl:r}}=k.storage.from("products").getPublicUrl(s.path);return r}const F={info:(t,...a)=>{console.info(`[INFO] ${t}`,...a)},warn:(t,...a)=>{console.warn(`[WARN] ${t}`,...a)},error:(t,a,...s)=>{console.error(`[ERROR] ${t}`,a,...s)}},st=[{name:"Assistant-Bold",fileName:"Assistant-Bold.woff2",family:"Assistant"},{name:"Assistant-Regular",fileName:"Assistant-Regular.woff2",family:"Assistant"},{name:"Inter-Bold",fileName:"Inter-Bold.woff2",family:"Inter"},{name:"Inter-Regular",fileName:"Inter-Regular.woff2",family:"Inter"},{name:"OpenSans-Bold",fileName:"OpenSans-Bold.woff2",family:"Open Sans"},{name:"OpenSans-Regular",fileName:"OpenSans-Regular.woff2",family:"Open Sans"},{name:"PlayfairDisplay-Bold",fileName:"PlayfairDisplay-Bold.woff2",family:"Playfair Display"},{name:"PlayfairDisplay-Regular",fileName:"PlayfairDisplay-Regular.woff2",family:"Playfair Display"},{name:"Roboto-Bold",fileName:"Roboto-Bold.woff2",family:"Roboto"},{name:"Roboto-Regular",fileName:"Roboto-Regular.woff2",family:"Roboto"}],rt=d.createContext({settings:null,loading:!0,updateSettings:async()=>{},refreshSettings:async()=>{}}),ae=()=>d.useContext(rt);function rs({children:t}){const[a,s]=d.useState(null),[n,r]=d.useState(!0),l=d.useCallback(async()=>{try{const{data:i,error:c}=await k.from("store_settings").select("*").eq("id",1).single();c?F.warn("Error fetching store settings:",c):(s(i),m(i))}catch(i){F.error("Unexpected error fetching store settings:",i)}finally{r(!1)}},[]),m=i=>{let c=document.getElementById("store-theme-style");c||(c=document.createElement("style"),c.id="store-theme-style",document.head.appendChild(c));const p=st.map(v=>{const f=v.name.toLowerCase().includes("bold")?"700":"400",N="/open-e-commerce/".endsWith("/")?"/open-e-commerce/":"/open-e-commerce//";return`
				@font-face {
					font-family: '${v.family}';
					src: url('${N}fonts/${v.fileName}') format('woff2');
					font-weight: ${f};
					font-style: normal;
					font-display: swap;
				}
			`}).join(`
`),_=`
			:root {
				--accent: ${i.primary_color||"#2563eb"};
				--brand-secondary: ${i.secondary_color||"#64748b"};
				
				--bg-primary: ${i.colors_background_light||"#ffffff"};
				--text-primary: ${i.colors_text_light||"#0f172a"};
				--accent-foreground: ${i.colors_solid_button_labels||"#ffffff"};

				/* Accent 1: Main Borders */
				--border: ${i.colors_accent_1||"#64748b"};
				--input: ${i.colors_accent_1||"#64748b"};

				/* Accent 2: Focus Rings & Strong Borders */
				--ring: ${i.colors_accent_2||"#475569"};

				/* Typography */
				--font-header: '${i.type_header_font}', sans-serif;
				--font-body: '${i.type_body_font}', sans-serif;

				/* Layout */
				--container-width: ${i.page_width}px;
				--grid-spacing-horizontal: ${i.spacing_grid_horizontal}px;
				--grid-spacing-vertical: ${i.spacing_grid_vertical}px;
			}
		`,x=`
			[data-theme="dark"] {
				--bg-primary: ${i.colors_background_dark||"#0f172a"};
				--text-primary: ${i.colors_text_dark||"#f8fafc"};
				
				/* Dark Mode Border Adjustments (Optional: could map to same or standard dark border) */
				--border: ${i.colors_accent_1?i.colors_accent_1:"#334155"};
				--input: ${i.colors_accent_1?i.colors_accent_1:"#334155"};
				--ring: ${i.colors_accent_2?i.colors_accent_2:"#475569"};
			}

			:root {
				/* Buttons & Inputs */
				--btn-border-width: ${i.buttons_border_thickness}px;
				--btn-opacity: ${i.buttons_opacity/100};
				--btn-radius: ${i.buttons_radius}px;
				--btn-shadow-opacity: ${i.buttons_shadow_opacity/100};
				--btn-shadow-offset-x: ${i.buttons_shadow_horizontal_offset}px;
				/* Shadow construction: offset-x | offset-y (0) | blur (4px) | spread (0) | color (black with opacity) */
				--btn-shadow: ${i.buttons_shadow_horizontal_offset}px 4px 6px -1px rgba(0, 0, 0, ${i.buttons_shadow_opacity/100});

				/* Product Card */
				--card-image-ratio: ${i.image_ratio==="square"?"1/1":i.image_ratio==="portrait"?"3/4":"auto"};
				--card-show-secondary-image: ${i.show_secondary_image?"1":"0"};
				--card-show-brand: ${i.show_brand?"block":"none"};
				--card-show-rating: ${i.show_rating?"flex":"none"}; /* Using flex for stars alignment */
				--card-show-quick-add: ${i.enable_quick_add?"block":"none"};
			}
		`;c.innerHTML=p+_+x,i.favicon_url&&document.querySelectorAll("link[rel*='icon']").forEach(f=>{f.href=i.favicon_url})},u=async i=>{try{const{error:c}=await k.from("store_settings").update(i).eq("id",1);if(c)throw c;if(a){const p={...a,...i};s(p),m(p)}await l()}catch(c){throw F.error("Error updating settings:",c),c}};return d.useEffect(()=>{l();const i=k.channel("store_settings_changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"store_settings",filter:"id=eq.1"},c=>{const p=c.new;s(p),m(p)}).subscribe();return()=>{k.removeChannel(i)}},[l]),e.jsx(rt.Provider,{value:{settings:a,loading:n,updateSettings:u,refreshSettings:l},children:t})}const nt=d.createContext(void 0);function me(){const t=d.useContext(nt);if(t===void 0)throw new Error("useCart must be used within a CartProvider");return t}const Oe="open-ecommerce-cart";function ns(t){const{children:a}=t,[s,n]=d.useState(()=>{const h=localStorage.getItem(Oe);return h?JSON.parse(h):[]}),{settings:r}=ae(),{addToast:l}=Qt(),m=ie();d.useEffect(()=>{localStorage.setItem(Oe,JSON.stringify(s))},[s]);const u=h=>{n(y=>y.find(j=>j.productId===h.id)?y.map(j=>j.productId===h.id?{...j,quantity:j.quantity+1}:j):[...y,{id:crypto.randomUUID(),productId:h.id,quantity:1,product:h}]),r?.cart_type==="drawer"?v(!0):r?.cart_type==="notification"?l(`Added ${h.name} to cart`,"success"):r?.cart_type==="page"&&m("/cart")},i=(h,y)=>{n(b=>b.map(j=>{if(j.productId===h){const o=j.quantity+y;return o>0?{...j,quantity:o}:j}return j}).filter(j=>j.quantity>0))},c=h=>{n(y=>y.filter(b=>b.productId!==h))},p=()=>{n([])},_=s.reduce((h,y)=>h+y.quantity,0),[x,v]=d.useState(!1),f=()=>v(!0),N=()=>v(!1);return e.jsx(nt.Provider,{value:{cartItems:s,addToCart:u,updateQuantity:i,removeFromCart:c,clearCart:p,cartCount:_,isCartOpen:x,openCart:f,closeCart:N},children:a})}var as={siteTitle:"Open E-Commerce",footer:{text:"Open E-Commerce. Built with Vite, React & TypeScript"}};const Pe=as;Pe||F.error("Global configuration not found. Ensure site.config.jsonc exists and build process injected __APP_CONFIG__.");const at=d.createContext({user:null,session:null,role:null,loading:!0,isAdmin:!1,signOut:async()=>{}}),ue=()=>d.useContext(at);function os({children:t}){const[a,s]=d.useState(null),[n,r]=d.useState(null),[l,m]=d.useState(null),[u,i]=d.useState(!0);d.useEffect(()=>{k.auth.getSession().then(({data:{session:v}})=>{r(v),s(v?.user??null),v?.user?c(v.user.id):i(!1)});const{data:{subscription:x}}=k.auth.onAuthStateChange((v,f)=>{r(f),s(f?.user??null),f?.user?c(f.user.id):(m(null),i(!1))});return()=>x.unsubscribe()},[]);const c=async x=>{try{const{data:v,error:f}=await k.from("profiles").select("role").eq("id",x).maybeSingle();f?(F.error("Error fetching role:",f),m("customer")):m(v?v.role:"customer")}catch(v){F.error("Error fetching role:",v),m("customer")}finally{i(!1)}},_={user:a,session:n,role:l,loading:u,isAdmin:l==="admin",signOut:async()=>{await k.auth.signOut(),m(null),s(null),r(null)}};return e.jsx(at.Provider,{value:_,children:t})}function re(t,a){if(!a)return`$${t.toFixed(2)}`;const s="en-US",n="USD";return a.currency_code_enabled?new Intl.NumberFormat(s,{style:"currency",currency:n,currencyDisplay:"code"}).format(t):new Intl.NumberFormat(s,{style:"currency",currency:n,currencyDisplay:"symbol"}).format(t)}function we({quantity:t,onDecrease:a,onIncrease:s,maxQuantity:n=1/0,size:r="sm",className:l=""}){const m=r==="sm",u=m?16:20;return e.jsxs("div",{className:`flex items-center rounded-lg overflow-hidden border border-border ${m?"h-8":"h-10"} ${l}`,children:[e.jsx("button",{onClick:i=>{i.preventDefault(),a()},className:"btn btn-primary rounded-none border-r border-primary-foreground/20 px-3 h-full flex items-center justify-center hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex-1","aria-label":"Decrease quantity",children:e.jsx(Ke,{size:u})}),e.jsx("span",{className:`bg-primary text-primary-foreground font-medium min-w-[3rem] text-center flex items-center justify-center h-full flex-1 ${m?"text-sm":"text-base"}`,children:t}),e.jsx("button",{onClick:i=>{i.preventDefault(),s()},className:"btn btn-primary rounded-none border-l border-primary-foreground/20 px-3 h-full flex items-center justify-center hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex-1","aria-label":"Increase quantity",disabled:t>=n,children:e.jsx(Se,{size:u})})]})}function de(...t){return Kt(Yt(t))}function J(t){const a="/open-e-commerce/";if(!t)return`${a}logo.png`;if(t.startsWith("http"))return t;let s=t;t.startsWith("/images/products/")?s=t.replace("/images/products/",""):t.startsWith("images/products/")&&(s=t.replace("images/products/",""));{const{data:n}=k.storage.from("products").getPublicUrl(s);return n.publicUrl}}function is(){const{cartItems:t,isCartOpen:a,closeCart:s,updateQuantity:n,removeFromCart:r}=me(),{settings:l}=ae(),m=ie(),[u,i]=d.useState(new Map);if(d.useEffect(()=>(a?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[a]),d.useEffect(()=>{async function x(){if(t.length===0)return;const v=t.filter(N=>!u.has(N.productId)).map(N=>N.productId);if(v.length===0)return;const{data:f}=await k.from("products").select("*").in("id",v);f&&i(N=>{const h=new Map(N);return f.forEach(y=>h.set(y.id,y)),h})}a&&x()},[t,a,u]),!a)return null;const c=t.map(x=>{const v=x.product||u.get(x.productId);return v?{...x,product:v}:null}).filter(x=>x!==null),p=c.reduce((x,v)=>x+v.product.price*v.quantity,0),_=()=>{m("/cart"),s()};return e.jsxs("div",{className:"fixed inset-0 z-50 flex justify-end",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:s}),e.jsxs("div",{className:"relative w-full max-w-md bg-background h-full shadow-2xl flex flex-col animate-in slide-in-from-right duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx(je,{size:20}),"Your Cart",e.jsxs("span",{className:"text-sm font-normal text-muted-foreground ml-2",children:["(",t.reduce((x,v)=>x+v.quantity,0),")"]})]}),e.jsx("button",{onClick:s,className:"btn btn-ghost p-2 h-auto",children:e.jsx(K,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:c.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(je,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Your cart is empty."}),e.jsx("button",{onClick:s,className:"text-primary hover:underline mt-2",children:"Continue Shopping"})]}):c.map(({productId:x,quantity:v,product:f})=>e.jsxs("div",{className:"flex gap-4 p-2 rounded-lg hover:bg-muted/30 transition-colors",children:[e.jsx("div",{className:"w-20 h-20 rounded-md bg-muted overflow-hidden shrink-0 border border-border",children:e.jsx("img",{src:J(f.images?.[0]||f.image),alt:f.name,className:"w-full h-full object-cover",onError:N=>{N.currentTarget.src="/open-e-commerce/logo.png",N.currentTarget.onerror=null}})}),e.jsxs("div",{className:"flex-1 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium line-clamp-1",children:f.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:f.variant})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx(we,{quantity:v,onDecrease:()=>{v>1?n(x,-1):r(x)},onIncrease:()=>n(x,1),maxQuantity:f.on_hand,className:"scale-90 origin-left"}),e.jsx("div",{className:"font-bold text-sm",children:re(f.price*v,l)})]})]})]},x))}),c.length>0&&e.jsxs("div",{className:"p-4 border-t border-border bg-muted/20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 text-lg font-bold",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:re(p,l)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(q,{to:"/cart",className:"btn btn-outline w-full text-center",onClick:s,children:"View Cart"}),e.jsx("button",{onClick:_,className:"btn btn-primary w-full",children:"Checkout"})]})]})]})]})}function ls(){const{cartCount:t,openCart:a}=me(),{user:s,role:n,isAdmin:r,signOut:l}=ue(),[m,u]=d.useState(!1),i=d.useRef(null),c=ie(),{settings:p}=ae();d.useEffect(()=>{function x(v){i.current&&!i.current.contains(v.target)&&u(!1)}return document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[]);const _=async()=>{await l(),u(!1),c("/")};return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(is,{}),e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--bg-header)] backdrop-blur-md border-b border-border transition-colors duration-300",children:e.jsxs("div",{className:"mx-auto px-4 h-16 flex items-center justify-between",style:{maxWidth:"var(--container-width, 1200px)"},children:[e.jsxs(q,{to:"/",className:"flex items-center gap-2 text-primary hover:opacity-80 transition-opacity",children:[e.jsx("img",{src:p?.logo_url?p.logo_url.startsWith("http")||p.logo_url.startsWith("data:")?p.logo_url:`/open-e-commerce/${p.logo_url.replace(/^\//,"")}`:"/open-e-commerce/logo.png",alt:"Logo",className:"w-8 h-8 object-contain"}),e.jsx("h1",{className:"font-bold text-xl text-primary leading-none",children:p?.store_name||Pe.siteTitle})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Jt,{}),p?.cart_type==="drawer"?e.jsxs("button",{onClick:()=>a(),className:"btn btn-ghost relative","aria-label":"Cart",children:[e.jsx(Ne,{size:20}),t>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-primary text-primary-foreground w-5 h-5 rounded-full flex items-center justify-center text-[10px] font-bold",children:t})]}):e.jsxs(q,{to:"/cart",className:"btn btn-ghost relative","aria-label":"Cart",children:[e.jsx(Ne,{size:20}),t>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-primary text-primary-foreground w-5 h-5 rounded-full flex items-center justify-center text-[10px] font-bold",children:t})]}),s?e.jsxs("div",{className:"relative",ref:i,children:[e.jsxs("button",{className:"btn btn-ghost flex items-center gap-2",onClick:()=>u(!m),"aria-label":"User menu",children:[e.jsx(Me,{size:20}),e.jsx(ke,{size:16,className:`transition-transform duration-200 ${m?"rotate-180":""}`})]}),m&&e.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-card border border-border rounded-lg shadow-lg py-1 z-50",children:[e.jsxs("div",{className:"px-4 py-2 border-b border-border",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:s?.email}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:n||"User"})]}),e.jsx(q,{to:"/profile",className:"block w-full text-left px-4 py-2 text-sm text-foreground hover:bg-secondary transition-colors",onClick:()=>u(!1),children:"My Profile"}),r&&e.jsx(q,{to:"/admin",className:"block w-full text-left px-4 py-2 text-sm text-foreground hover:bg-secondary transition-colors",onClick:()=>u(!1),children:"Admin Dashboard"}),e.jsx("div",{className:"border-t border-border mt-1 pt-1",children:e.jsx("button",{onClick:_,className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:"Sign Out"})})]})]}):e.jsx(q,{to:"/login",className:"btn btn-ghost","aria-label":"Sign In",children:e.jsx(Me,{size:20})})]})]})}),e.jsx("main",{className:"flex-1 py-8",children:e.jsx("div",{className:"mx-auto px-4",style:{maxWidth:"var(--container-width, 1200px)"},children:e.jsx(Ye,{})})}),e.jsx("footer",{className:"mt-auto border-t border-border py-8 bg-muted text-muted-foreground text-center text-sm",children:e.jsxs("div",{className:"mx-auto px-4 space-y-4",style:{maxWidth:"var(--container-width, 1200px)"},children:[e.jsxs("div",{className:"flex justify-center gap-4",children:[p?.social_facebook_link&&e.jsx("a",{href:p.social_facebook_link,target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors","aria-label":"Facebook",children:e.jsx(xt,{size:20})}),p?.social_instagram_link&&e.jsx("a",{href:p.social_instagram_link,target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors","aria-label":"Instagram",children:e.jsx(gt,{size:20})}),p?.social_twitter_link&&e.jsx("a",{href:p.social_twitter_link,target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors","aria-label":"Twitter",children:e.jsx(ft,{size:20})}),p?.social_youtube_link&&e.jsx("a",{href:p.social_youtube_link,target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors","aria-label":"YouTube",children:e.jsx(bt,{size:20})}),p?.social_pinterest_link&&e.jsx("a",{href:p.social_pinterest_link,target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors","aria-label":"Pinterest",children:e.jsx(yt,{size:20})}),p?.social_tiktok_link&&e.jsx("a",{href:p.social_tiktok_link,target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors","aria-label":"TikTok",children:e.jsx(Re,{size:20})}),p?.social_snapchat_link&&e.jsx("a",{href:p.social_snapchat_link,target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors","aria-label":"Snapchat",children:e.jsx(vt,{size:20})}),p?.social_tumblr_link&&e.jsx("a",{href:p.social_tumblr_link,target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors","aria-label":"Tumblr",children:e.jsx(jt,{size:20})}),p?.social_vimeo_link&&e.jsx("a",{href:p.social_vimeo_link,target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors","aria-label":"Vimeo",children:e.jsx(Re,{size:20})}),p?.social_github_link&&e.jsx("a",{href:p.social_github_link,target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors","aria-label":"GitHub",children:e.jsx(Nt,{size:20})})]}),e.jsxs("p",{children:["© ",new Date().getFullYear()," ",Pe.footer?.text]})]})})]})}function Z({variant:t="neutral",className:a,children:s,...n}){const r={success:"badge-success",warning:"badge-warning",error:"badge-error",info:"badge-info",neutral:"badge-neutral",purple:"badge-purple",orange:"badge-orange"}[t];return e.jsx("span",{className:de("badge",r,a),...n,children:s})}function ot(t){const[a,s]=d.useState(0),[n,r]=d.useState(0),[l,m]=d.useState(!0);return d.useEffect(()=>{if(!t){m(!1);return}let u=!0;async function i(){try{const[c,p]=await Promise.all([k.rpc("get_product_average_rating",{p_id:t}),k.rpc("get_product_review_count",{p_id:t})]);if(u){if(c.error)throw c.error;if(p.error)throw p.error;s(c.data||0),r(p.data||0)}}catch(c){F.error(`Error fetching rating for product ${t}:`,c)}finally{u&&m(!1)}}return i(),()=>{u=!1}},[t]),{rating:a,count:n,loading:l}}function oe({rating:t,maxStars:a=5,size:s=20,interactive:n=!1,onRatingChange:r,className:l=""}){const m=[];for(let u=1;u<=a;u++)m.push(e.jsx("button",{type:"button",disabled:!n,onClick:()=>n&&r?.(u),className:`${n?"cursor-pointer hover:scale-110 transition-transform":"cursor-default"} ${l}`,"aria-label":`Rate ${u} stars`,children:e.jsx(wt,{size:s,className:`${u<=t?"fill-yellow-400 text-yellow-400":"fill-transparent text-muted-foreground/30"}`})},u));return e.jsx("div",{className:"flex items-center gap-0.5",children:m})}function cs({product:t,cartQuantity:a,onAddToCart:s,onUpdateQuantity:n,onRemoveFromCart:r}){const l=t.category?t.category.split(">").map(_=>_.trim()):[],m=l.length>0?l[l.length-1]:t.category,u=l.length>0?`/category/${l.map(_=>encodeURIComponent(_)).join("/")}`:"#",{settings:i}=ae(),{rating:c,count:p}=ot(t.id);return e.jsxs("div",{className:"card flex flex-col h-full group hover:shadow-lg hover:border-accent/50 transition-all duration-300 relative",children:[e.jsxs(q,{to:`/product/${t.id}`,className:"relative bg-muted overflow-hidden block",style:{aspectRatio:"var(--card-image-ratio, auto)"},children:[e.jsx("img",{src:J(t.images?.[0]||t.image),alt:t.name,className:"w-full h-full object-cover transition-all duration-500 mix-blend-multiply dark:mix-blend-normal group-hover:scale-105",loading:"lazy",onError:_=>{_.currentTarget.src="/open-e-commerce/logo.png",_.currentTarget.onerror=null}}),t.images&&t.images.length>1&&e.jsx("img",{src:J(t.images[1]),alt:t.name,className:"absolute inset-0 w-full h-full object-cover transition-opacity duration-500 mix-blend-multiply dark:mix-blend-normal opacity-0 group-hover:opacity-100",style:{opacity:"calc(var(--card-show-secondary-image, 0) * 1)"},loading:"lazy"}),t.on_hand<=0&&e.jsx(Z,{variant:"error",className:"absolute top-2 right-2 backdrop-blur-sm tracking-wider z-10",children:"Out of Stock"})]}),e.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[l.length>0?e.jsx(q,{to:u,className:"font-semibold text-xs uppercase tracking-wider hover:underline block",children:m}):e.jsx("div",{className:"font-semibold text-xs uppercase tracking-wider",children:t.category}),e.jsx("div",{className:"text-[10px] text-muted-foreground uppercase font-medium",style:{display:"var(--card-show-brand, none)"},children:t.brand||"Brand"})]}),t.variant&&e.jsx("div",{className:"text-[10px] text-muted-foreground uppercase font-medium mt-0.5",children:t.variant})]}),e.jsx(q,{to:`/product/${t.id}`,className:"block mb-1",children:e.jsx("h3",{className:"font-semibold text-lg leading-snug group-hover:text-primary transition-colors",children:t.name})}),e.jsxs("div",{className:"flex items-center gap-1 mb-2 h-4",style:{display:"var(--card-show-rating, flex)"},children:[e.jsx("div",{className:"flex text-yellow-400 text-xs",children:e.jsx(oe,{rating:c,size:14})}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",p,")"]})]}),e.jsx("div",{className:"font-bold text-xl mt-auto",children:re(t.price,i)}),e.jsx("div",{className:"mt-4 pt-4 border-t border-border",style:{display:"var(--card-show-quick-add, block)"},children:a>0?e.jsx(we,{quantity:a,onIncrease:()=>n(t.id,1),onDecrease:()=>{a>1?n(t.id,-1):r(t.id)},maxQuantity:t.on_hand,className:"w-full"}):e.jsxs("button",{onClick:_=>{_.preventDefault(),s(t)},disabled:t.on_hand<=0,className:"btn btn-primary w-full flex items-center justify-center gap-2 py-2 text-sm",children:[e.jsx(Ne,{size:16}),t.on_hand>0?"Add to Cart":"Out of Stock"]})})]})]})}async function ds(){const{data:t,error:a}=await k.from("products").select("category").eq("status","active").not("category","is",null);return a?(console.error("Error fetching categories:",a),[]):Array.from(new Set(t.map(n=>n.category))).filter(Boolean)}function ms(t){const a=[];t.forEach(n=>{const r=n.split(/\s*>\s*/);let l=a,m="";r.forEach(u=>{m=m?`${m} > ${u}`:u;let i=l.find(c=>c.name===u);i||(i={name:u,fullName:m,children:[]},l.push(i)),l=i.children})});const s=n=>{n.sort((r,l)=>r.name.localeCompare(l.name)),n.forEach(r=>s(r.children))};return s(a),a}function us({onSearch:t,onFilterChange:a,onSortChange:s,categories:n=[]}){const[r,l]=d.useState(""),[m,u]=d.useState({minPrice:"",maxPrice:"",category:""}),[i,c]=d.useState("newest"),[p,_]=d.useState(!1),[x,v]=d.useState(!1),f=d.useRef(null),[N,h]=d.useState([]),[y,b]=d.useState(!1),j=d.useRef(null),{settings:o}=ae();d.useEffect(()=>{const A=setTimeout(()=>{t(r),o?.predictive_search_enabled&&r.length>2?w(r):h([])},500);return()=>clearTimeout(A)},[r,t,o?.predictive_search_enabled]);const w=async A=>{const{data:S}=await k.from("products").select("id, name, price, image, category").ilike("name",`%${A}%`).limit(5);if(S){const D=await Promise.all(S.map(async O=>{const{data:Y}=await k.rpc("get_product_average_rating",{p_id:O.id}),{data:g}=await k.rpc("get_product_review_count",{p_id:O.id});return{...O,rating:Y||0,review_count:g||0}}));h(D),b(!0)}};d.useEffect(()=>{function A(S){j.current&&!j.current.contains(S.target)&&b(!1),f.current&&!f.current.contains(S.target)&&v(!1)}return document.addEventListener("mousedown",A),()=>{document.removeEventListener("mousedown",A)}},[]);const C=(A,S)=>{const D={...m,[A]:S};u(D),a(D)},I=A=>{const S=A.target.value;c(S),s(S)},U=()=>{l(""),u({minPrice:"",maxPrice:"",category:""}),c("newest"),t(""),a({minPrice:"",maxPrice:"",category:""}),s("newest")},M=r||m.minPrice||m.maxPrice||m.category||i!=="newest",T=({node:A,depth:S=0})=>{const[D,O]=d.useState(!1),Y=A.children&&A.children.length>0,g=R=>{R.stopPropagation(),C("category",A.fullName),v(!1)},L=R=>{R.stopPropagation(),O(!D)};return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:`flex items-center group cursor-pointer ${m.category===A.fullName?"bg-secondary/50 font-medium":"hover:bg-secondary"} `,style:{paddingLeft:`${S*12+16}px`},children:[e.jsx("div",{className:"flex-1 py-2 pr-2",onClick:g,title:`Filter by ${A.name}`,children:e.jsx("span",{className:"whitespace-nowrap block",children:A.name})}),Y&&e.jsx("div",{className:"border-l border-border h-full flex items-center px-2 hover:bg-muted/50 transition-colors",onClick:L,title:D?"Collapse subcategories":"Expand subcategories",children:D?e.jsx(ke,{size:14,className:"text-muted-foreground"}):e.jsx(Qe,{size:14,className:"text-muted-foreground"})})]}),D&&Y&&e.jsx("div",{className:"border-l border-border ml-4",children:A.children.map(R=>e.jsx(T,{node:R,depth:S+1},R.fullName))})]})};return e.jsxs("div",{className:"bg-card border border-border rounded-lg shadow-sm p-4 mb-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",ref:j,children:[e.jsx(Je,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Search products...",value:r,onChange:A=>{l(A.target.value),A.target.value.length<=2&&b(!1)},onFocus:()=>{N.length>0&&b(!0)},className:"w-full pl-9 pr-4 py-2 rounded-md border border-input bg-background focus:outline-none focus:ring-2 focus:ring-primary/50"}),y&&N.length>0&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-card border border-border rounded-md shadow-lg z-50 overflow-hidden",children:[e.jsx("div",{className:"p-2 text-xs font-semibold text-muted-foreground uppercase tracking-wider bg-muted/30",children:"Suggestions"}),N.map(A=>e.jsxs(q,{to:`/product/${A.id}`,className:"flex items-center gap-3 p-2 hover:bg-secondary/50 transition-colors border-b border-border/50 last:border-0",onClick:()=>b(!1),children:[e.jsx("div",{className:"w-10 h-10 rounded bg-muted overflow-hidden shrink-0",children:e.jsx("img",{src:J(A.image),alt:A.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate text-sm",children:A.name}),e.jsx("div",{className:"text-xs text-muted-foreground truncate",children:A.category}),A.rating!==void 0&&e.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[e.jsx("div",{className:"flex text-yellow-500 transform scale-75 origin-left",children:e.jsx(oe,{rating:A.rating,size:12})}),e.jsxs("span",{className:"text-[10px] text-muted-foreground",children:["(",A.review_count,")"]})]})]}),e.jsx("div",{className:"font-semibold text-sm whitespace-nowrap",children:A.price!==void 0?re(A.price,o):""})]},A.id))]})]}),e.jsxs("div",{className:"relative hidden md:block",ref:f,children:[e.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 border border-input rounded-md bg-background text-sm min-w-[150px] justify-between",onClick:()=>v(!x),children:[e.jsx("span",{className:"truncate max-w-[120px]",children:m.category?m.category.split(" > ").pop():"All Categories"}),e.jsx(ke,{size:14,className:`transition-transform ${x?"rotate-180":""}`})]}),x&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 min-w-[16rem] w-max max-w-[80vw] bg-card border border-border rounded-lg shadow-lg py-2 z-50 max-h-[300px] overflow-y-auto",children:[e.jsx("div",{className:`px-4 py-2 hover:bg-secondary cursor-pointer border-b border-border ${m.category===""?"bg-secondary/50 font-medium":""}`,onClick:()=>{C("category",""),v(!1)},children:"All Categories"}),n.map(A=>e.jsx(T,{node:A},A.fullName)),n.length===0&&e.jsx("div",{className:"px-4 py-2 text-sm text-muted-foreground text-center",children:"Loading categories..."})]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium whitespace-nowrap",children:"Price:"}),e.jsx("input",{type:"number",placeholder:"Min",value:m.minPrice,onChange:A=>C("minPrice",A.target.value),className:"w-20 px-2 py-1 text-sm rounded-md border border-input bg-background",min:"0"}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx("input",{type:"number",placeholder:"Max",value:m.maxPrice,onChange:A=>C("maxPrice",A.target.value),className:"w-20 px-2 py-1 text-sm rounded-md border border-input bg-background",min:"0"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium whitespace-nowrap",children:"Sort:"}),e.jsxs("select",{value:i,onChange:I,className:"px-2 py-1 text-sm rounded-md border border-input bg-background focus:outline-none",children:[e.jsx("option",{value:"newest",children:"Newest"}),e.jsx("option",{value:"price_asc",children:"Price: Low to High"}),e.jsx("option",{value:"price_desc",children:"Price: High to Low"}),e.jsx("option",{value:"name_asc",children:"Name: A-Z"})]})]}),M&&e.jsxs("button",{onClick:U,className:"text-sm text-muted-foreground hover:text-foreground flex items-center gap-1",children:[e.jsx(K,{size:14})," Clear"]})]}),e.jsxs("div",{className:"md:hidden flex justify-between items-center",children:[e.jsxs("button",{onClick:()=>_(!p),className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(_t,{size:16}),"Filters"]}),M&&e.jsxs("button",{onClick:U,className:"text-sm text-muted-foreground hover:text-foreground flex items-center gap-1",children:[e.jsx(K,{size:14})," Clear All"]})]})]}),p&&e.jsxs("div",{className:"md:hidden mt-4 pt-4 border-t border-border space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Category"}),e.jsxs("select",{value:m.category,onChange:A=>C("category",A.target.value),className:"w-full px-3 py-2 text-sm rounded-md border border-input bg-background",children:[e.jsx("option",{value:"",children:"All Categories"}),n.map(A=>e.jsxs(Ct.Fragment,{children:[e.jsx("option",{value:A.fullName,children:A.name}),A.children.map(S=>e.jsxs("option",{value:S.fullName,children:["  ",S.name]},S.fullName))]},A.fullName))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Price Range"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",placeholder:"Min",value:m.minPrice,onChange:A=>C("minPrice",A.target.value),className:"flex-1 px-3 py-2 text-sm rounded-md border border-input bg-background"}),e.jsx("span",{className:"text-muted-foreground",children:"-"}),e.jsx("input",{type:"number",placeholder:"Max",value:m.maxPrice,onChange:A=>C("maxPrice",A.target.value),className:"flex-1 px-3 py-2 text-sm rounded-md border border-input bg-background"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Sort By"}),e.jsxs("select",{value:i,onChange:I,className:"w-full px-3 py-2 text-sm rounded-md border border-input bg-background focus:outline-none",children:[e.jsx("option",{value:"newest",children:"Newest"}),e.jsx("option",{value:"price_asc",children:"Price: Low to High"}),e.jsx("option",{value:"price_desc",children:"Price: High to Low"}),e.jsx("option",{value:"name_asc",children:"Name: A-Z"})]})]})]})]})}function $e(){const[t,a]=d.useState(null),[s,n]=d.useState(!0),{cartItems:r,addToCart:l,updateQuantity:m,removeFromCart:u}=me(),c=xe()["*"],p=new Map(r.map(w=>[w.productId,w.quantity])),[_,x]=d.useState(""),[v,f]=d.useState({minPrice:"",maxPrice:"",category:""}),[N,h]=d.useState("newest"),[y,b]=d.useState([]);d.useEffect(()=>{async function w(){const C=await ds(),I=ms(C);b(I)}w()},[]),d.useEffect(()=>{async function w(){n(!0);let C=k.from("products").select("*").eq("status","active"),I=v.category;switch(!I&&c&&(I=decodeURIComponent(c).replace(/\//g," > ")),I&&(C=C.ilike("category",`${I}%`)),_&&(C=C.or(`name.ilike.%${_}%,description.ilike.%${_}%`)),v.minPrice&&(C=C.gte("price",parseFloat(v.minPrice))),v.maxPrice&&(C=C.lte("price",parseFloat(v.maxPrice))),N){case"price_asc":C=C.order("price",{ascending:!0});break;case"price_desc":C=C.order("price",{ascending:!1});break;case"name_asc":C=C.order("name",{ascending:!0});break;default:C=C.order("id",{ascending:!1});break}N==="newest"&&(C=C.order("id",{ascending:!1}));const{data:U,error:M}=await C;M?F.error("Error fetching products:",M):a(U),n(!1)}w()},[c,_,v,N]);const j=()=>{if(!c)return null;const w=c.split("/");let C="/category";return e.jsxs("nav",{className:"flex items-center text-sm text-muted-foreground mb-8 overflow-x-auto whitespace-nowrap pb-2",children:[e.jsxs(q,{to:"/",className:"hover:text-primary flex items-center gap-1 transition-colors",children:[e.jsx(St,{size:14}),"Home"]}),w.map((I,U)=>{C+=`/${I}`;const M=U===w.length-1,T=decodeURIComponent(I);return e.jsxs("div",{className:"flex items-center",children:[e.jsx(Qe,{size:14,className:"mx-2 shrink-0"}),M?e.jsx("span",{className:"font-medium text-foreground",children:T}):e.jsx(q,{to:C,className:"hover:text-primary transition-colors",children:T})]},C)})]})},o=c?decodeURIComponent(c.split("/").pop()||"Category"):"Welcome to Open E-Commerce";return e.jsxs("div",{className:"animate-in fade-in duration-700",children:[j(),e.jsxs("div",{className:"text-center mb-12 max-w-2xl mx-auto",children:[e.jsx("h2",{className:"text-4xl font-extrabold mb-4 bg-gradient-to-r from-foreground to-muted-foreground bg-clip-text text-transparent capitalize",children:o}),e.jsx("p",{className:"text-muted-foreground text-lg",children:c?`Explore our collection of ${o}.`:"Explore our premium selection of cutting-edge technology and accessories."})]}),e.jsx(us,{onSearch:x,onFilterChange:f,onSortChange:h,categories:y}),s?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]",role:"status",children:e.jsx("span",{className:"!absolute !-m-px !h-px !w-px !overflow-hidden !whitespace-nowrap !border-0 !p-0 ![clip:rect(0,0,0,0)]",children:"Loading..."})}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading products..."})]}):!t||t.length===0?e.jsx("div",{className:"text-center py-16 px-4 border border-dashed border-border rounded-lg",children:e.jsxs("p",{style:{marginBottom:"1rem"},children:["No products found ",c?"in this category":"in the database","."]})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-x-[var(--grid-spacing-horizontal)] gap-y-[var(--grid-spacing-vertical)]",children:t.map(w=>e.jsx(cs,{product:w,cartQuantity:p.get(w.id)||0,onAddToCart:l,onUpdateQuantity:m,onRemoveFromCart:u},w.id))})]})}function it({productId:t,orderId:a,userId:s,onReviewSubmitted:n,onCancel:r}){const[l,m]=d.useState(5),[u,i]=d.useState(""),[c,p]=d.useState(!1),[_,x]=d.useState(null),v=async f=>{f.preventDefault(),p(!0),x(null);try{const{error:N}=await k.from("reviews").insert({product_id:t,order_id:a,user_id:s,rating:l,comment:u,status:"pending"});if(N)throw N;n()}catch(N){F.error("Error submitting review:",N),x("Failed to submit review. Please try again.")}finally{p(!1)}};return e.jsxs("form",{onSubmit:v,className:"bg-card p-6 rounded-xl border border-border shadow-sm animate-in fade-in zoom-in-95 duration-200",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Write a Review"}),_&&e.jsx("div",{className:"bg-destructive/10 text-destructive text-sm p-3 rounded-lg mb-4",children:_}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Rating"}),e.jsx(oe,{rating:l,interactive:!0,onRatingChange:m,size:32})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"comment",className:"block text-sm font-medium mb-2",children:"Review"}),e.jsx("textarea",{id:"comment",value:u,onChange:f=>i(f.target.value),className:"w-full px-3 py-2 bg-background border border-input rounded-md focus:ring-2 focus:ring-primary focus:border-transparent min-h-[120px]",placeholder:"Share your experience with this product...",required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:r,disabled:c,className:"px-4 py-2 text-sm font-medium text-muted-foreground hover:text-foreground transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c,className:"btn btn-primary flex items-center gap-2",children:c?"Submitting...":e.jsxs(e.Fragment,{children:[e.jsx(kt,{size:16})," Submit Review"]})})]})]})}const fe=43200,qe=1440,Ue=Symbol.for("constructDateFrom");function Ae(t,a){return typeof t=="function"?t(a):t&&typeof t=="object"&&Ue in t?t[Ue](a):t instanceof Date?new t.constructor(a):new Date(a)}function ne(t,a){return Ae(t,t)}let hs={};function ps(){return hs}function Be(t){const a=ne(t),s=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()));return s.setUTCFullYear(a.getFullYear()),+t-+s}function Ie(t,...a){const s=Ae.bind(null,t||a.find(n=>typeof n=="object"));return a.map(s)}function ve(t,a){const s=+ne(t)-+ne(a);return s<0?-1:s>0?1:s}function xs(t){return Ae(t,Date.now())}function gs(t,a,s){const[n,r]=Ie(s?.in,t,a),l=n.getFullYear()-r.getFullYear(),m=n.getMonth()-r.getMonth();return l*12+m}function fs(t){return a=>{const n=(t?Math[t]:Math.trunc)(a);return n===0?0:n}}function bs(t,a){return+ne(t)-+ne(a)}function ys(t,a){const s=ne(t);return s.setHours(23,59,59,999),s}function vs(t,a){const s=ne(t),n=s.getMonth();return s.setFullYear(s.getFullYear(),n+1,0),s.setHours(23,59,59,999),s}function js(t,a){const s=ne(t);return+ys(s)==+vs(s)}function Ns(t,a,s){const[n,r,l]=Ie(s?.in,t,t,a),m=ve(r,l),u=Math.abs(gs(r,l));if(u<1)return 0;r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-m*u);let i=ve(r,l)===-m;js(n)&&u===1&&ve(n,l)===1&&(i=!1);const c=m*(u-+i);return c===0?0:c}function ws(t,a,s){const n=bs(t,a)/1e3;return fs(s?.roundingMethod)(n)}const _s={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Cs=(t,a,s)=>{let n;const r=_s[t];return typeof r=="string"?n=r:a===1?n=r.one:n=r.other.replace("{{count}}",a.toString()),s?.addSuffix?s.comparison&&s.comparison>0?"in "+n:n+" ago":n};function Ce(t){return(a={})=>{const s=a.width?String(a.width):t.defaultWidth;return t.formats[s]||t.formats[t.defaultWidth]}}const Ss={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ks={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Ps={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Es={date:Ce({formats:Ss,defaultWidth:"full"}),time:Ce({formats:ks,defaultWidth:"full"}),dateTime:Ce({formats:Ps,defaultWidth:"full"})},As={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Is=(t,a,s,n)=>As[t];function he(t){return(a,s)=>{const n=s?.context?String(s.context):"standalone";let r;if(n==="formatting"&&t.formattingValues){const m=t.defaultFormattingWidth||t.defaultWidth,u=s?.width?String(s.width):m;r=t.formattingValues[u]||t.formattingValues[m]}else{const m=t.defaultWidth,u=s?.width?String(s.width):t.defaultWidth;r=t.values[u]||t.values[m]}const l=t.argumentCallback?t.argumentCallback(a):a;return r[l]}}const Ds={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Fs={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},zs={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Ms={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Rs={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Ts={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Ls=(t,a)=>{const s=Number(t),n=s%100;if(n>20||n<10)switch(n%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},Os={ordinalNumber:Ls,era:he({values:Ds,defaultWidth:"wide"}),quarter:he({values:Fs,defaultWidth:"wide",argumentCallback:t=>t-1}),month:he({values:zs,defaultWidth:"wide"}),day:he({values:Ms,defaultWidth:"wide"}),dayPeriod:he({values:Rs,defaultWidth:"wide",formattingValues:Ts,defaultFormattingWidth:"wide"})};function pe(t){return(a,s={})=>{const n=s.width,r=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],l=a.match(r);if(!l)return null;const m=l[0],u=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],i=Array.isArray(u)?qs(u,_=>_.test(m)):$s(u,_=>_.test(m));let c;c=t.valueCallback?t.valueCallback(i):i,c=s.valueCallback?s.valueCallback(c):c;const p=a.slice(m.length);return{value:c,rest:p}}}function $s(t,a){for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&a(t[s]))return s}function qs(t,a){for(let s=0;s<t.length;s++)if(a(t[s]))return s}function Us(t){return(a,s={})=>{const n=a.match(t.matchPattern);if(!n)return null;const r=n[0],l=a.match(t.parsePattern);if(!l)return null;let m=t.valueCallback?t.valueCallback(l[0]):l[0];m=s.valueCallback?s.valueCallback(m):m;const u=a.slice(r.length);return{value:m,rest:u}}}const Bs=/^(\d+)(th|st|nd|rd)?/i,Ws=/\d+/i,Vs={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Hs={any:[/^b/i,/^(a|c)/i]},Gs={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Ks={any:[/1/i,/2/i,/3/i,/4/i]},Ys={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Js={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Qs={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Xs={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Zs={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},er={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},tr={ordinalNumber:Us({matchPattern:Bs,parsePattern:Ws,valueCallback:t=>parseInt(t,10)}),era:pe({matchPatterns:Vs,defaultMatchWidth:"wide",parsePatterns:Hs,defaultParseWidth:"any"}),quarter:pe({matchPatterns:Gs,defaultMatchWidth:"wide",parsePatterns:Ks,defaultParseWidth:"any",valueCallback:t=>t+1}),month:pe({matchPatterns:Ys,defaultMatchWidth:"wide",parsePatterns:Js,defaultParseWidth:"any"}),day:pe({matchPatterns:Qs,defaultMatchWidth:"wide",parsePatterns:Xs,defaultParseWidth:"any"}),dayPeriod:pe({matchPatterns:Zs,defaultMatchWidth:"any",parsePatterns:er,defaultParseWidth:"any"})},sr={code:"en-US",formatDistance:Cs,formatLong:Es,formatRelative:Is,localize:Os,match:tr,options:{weekStartsOn:0,firstWeekContainsDate:1}};function rr(t,a,s){const n=ps(),r=s?.locale??n.locale??sr,l=2520,m=ve(t,a);if(isNaN(m))throw new RangeError("Invalid time value");const u=Object.assign({},s,{addSuffix:s?.addSuffix,comparison:m}),[i,c]=Ie(s?.in,...m>0?[a,t]:[t,a]),p=ws(c,i),_=(Be(c)-Be(i))/1e3,x=Math.round((p-_)/60);let v;if(x<2)return s?.includeSeconds?p<5?r.formatDistance("lessThanXSeconds",5,u):p<10?r.formatDistance("lessThanXSeconds",10,u):p<20?r.formatDistance("lessThanXSeconds",20,u):p<40?r.formatDistance("halfAMinute",0,u):p<60?r.formatDistance("lessThanXMinutes",1,u):r.formatDistance("xMinutes",1,u):x===0?r.formatDistance("lessThanXMinutes",1,u):r.formatDistance("xMinutes",x,u);if(x<45)return r.formatDistance("xMinutes",x,u);if(x<90)return r.formatDistance("aboutXHours",1,u);if(x<qe){const f=Math.round(x/60);return r.formatDistance("aboutXHours",f,u)}else{if(x<l)return r.formatDistance("xDays",1,u);if(x<fe){const f=Math.round(x/qe);return r.formatDistance("xDays",f,u)}else if(x<fe*2)return v=Math.round(x/fe),r.formatDistance("aboutXMonths",v,u)}if(v=Ns(c,i),v<12){const f=Math.round(x/fe);return r.formatDistance("xMonths",f,u)}else{const f=v%12,N=Math.trunc(v/12);return f<3?r.formatDistance("aboutXYears",N,u):f<9?r.formatDistance("overXYears",N,u):r.formatDistance("almostXYears",N+1,u)}}function nr(t,a){return rr(t,xs(t),a)}function ar({productId:t,hideWriteButton:a=!1}){const[s,n]=d.useState([]),[r,l]=d.useState(!0),[m,u]=d.useState(null),[i,c]=d.useState(null),[p,_]=d.useState(!1),[x,v]=d.useState(0),f=d.useCallback(async()=>{try{const{data:h,error:y}=await k.from("reviews").select(`
          *,
          profiles (full_name)
        `).eq("product_id",t).eq("status","approved").order("created_at",{ascending:!1});if(y)throw y;n(h||[])}catch(h){F.error("Error fetching reviews:",h)}finally{l(!1)}},[t]),N=d.useCallback(async()=>{try{const{data:h,error:y}=await k.rpc("get_product_average_rating",{p_id:t});y?F.warn("Error fetching average rating RPC:",y):v(h)}catch(h){F.error("Error in fetchAverageRating:",h)}},[t]);return d.useEffect(()=>{k.auth.getUser().then(({data:h})=>u(h.user)),f(),N()},[t,f,N]),d.useEffect(()=>{m&&t&&(async()=>{try{if(!m?.id||a)return;const{data:y,error:b}=await k.from("order_items").select("order_id").eq("user_id",m.id).eq("product_id",t);if(b||!y||y.length===0)return;const j=y.map(I=>I.order_id),{data:o,error:w}=await k.from("orders").select("id, status").in("id",j).eq("status","shipped");if(w||!o||o.length===0)return;const{data:C}=await k.from("reviews").select("id").eq("user_id",m.id).eq("product_id",t);if(C&&C.length>0)return;c(o[0].id)}catch(y){F.error("Error checking review eligibility:",y)}})()},[m,t,a]),r?e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"Loading reviews..."}):e.jsxs("div",{id:"reviews",className:"space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold",children:"Customer Reviews"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(oe,{rating:x,size:24}),e.jsx("span",{className:"text-lg font-medium",children:x?.toFixed(1)||"No ratings"}),e.jsxs("span",{className:"text-muted-foreground",children:["(",s.length," reviews)"]})]})]}),i&&!p&&!a&&e.jsx("button",{onClick:()=>_(!0),className:"btn btn-primary",children:"Write a Review"})]}),p&&i&&m&&e.jsx("div",{className:"max-w-2xl",children:e.jsx(it,{productId:t,userId:m.id,orderId:i,onReviewSubmitted:()=>{_(!1),c(null),f(),alert("Review submitted for approval!")},onCancel:()=>_(!1)})}),e.jsx("div",{className:"space-y-6",children:s.length===0?e.jsxs("div",{className:"text-center py-12 bg-muted/30 rounded-xl border border-dashed border-border",children:[e.jsx(Pt,{className:"mx-auto h-12 w-12 text-muted-foreground/50 mb-3"}),e.jsx("h4",{className:"text-lg font-medium",children:"No reviews yet"}),e.jsx("p",{className:"text-muted-foreground",children:"Be the first to review this product!"})]}):s.map(h=>e.jsxs("div",{className:"border-b border-border pb-6 last:border-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold",children:h.profiles?.full_name?.charAt(0)||"U"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:h.profiles?.full_name||"Anonymous User"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Verified Purchase"})]})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:nr(new Date(h.created_at),{addSuffix:!0})})]}),e.jsx("div",{className:"mb-2",children:e.jsx(oe,{rating:h.rating,size:16})}),e.jsx("p",{className:"text-foreground/90 leading-relaxed",children:h.comment})]},h.id))})]})}function or(){const{id:t}=xe(),a=parseInt(t||"0"),[s,n]=d.useState(null),[r,l]=d.useState(!0),{cartItems:m,addToCart:u,updateQuantity:i,removeFromCart:c}=me(),p=m.find(o=>o.productId===a),{settings:_}=ae(),{rating:x,count:v}=ot(a),[f,N]=d.useState(""),[h,y]=d.useState(!1);d.useEffect(()=>{async function o(){if(!a)return;const{data:w,error:C}=await k.from("products").select("*").eq("id",a).eq("status","active").single();C?F.error("Error fetching product:",C):(n(w),N(w.images?.[0]||w.image||"")),l(!1)}o()},[a]);const b=()=>{s&&(y(!0),u(s),setTimeout(()=>y(!1),500))};if(a===0||!s&&!r)return r?e.jsx("div",{className:"empty-cart",children:"Loading..."}):e.jsx("div",{className:"empty-cart",children:"Product not found"});if(r||!s)return e.jsx("div",{className:"empty-cart",children:"Loading..."});const j={"@context":"https://schema.org/","@type":"Product",name:s.name,image:s.images&&s.images.length>0?s.images.map(o=>J(o)):[J(s.image)],description:s.description,sku:s.sku,mpn:s.mpn,brand:{"@type":"Brand",name:s.brand||"Open E-Commerce"},offers:{"@type":"Offer",url:window.location.href,priceCurrency:"USD",price:s.price,itemCondition:s.condition==="new"?"https://schema.org/NewCondition":s.condition==="used"?"https://schema.org/UsedCondition":"https://schema.org/RefurbishedCondition",availability:s.on_hand>0?"https://schema.org/InStock":"https://schema.org/OutOfStock"},gtin:s.gtin,category:s.category,weight:s.weight?{"@type":"QuantitativeValue",value:s.weight,unitCode:"LBR"}:void 0};return e.jsxs("div",{className:"max-w-6xl mx-auto animate-in fade-in duration-500 pb-16",children:[e.jsx("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(j)}}),e.jsxs(q,{to:"/",className:"inline-flex items-center gap-2 text-muted-foreground mb-8 font-medium hover:text-primary transition-colors",children:[e.jsx(Xe,{size:20})," Back to Products"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"rounded-2xl bg-muted overflow-hidden aspect-square border border-border",children:e.jsx("img",{src:J(f),alt:s.name,className:"w-full h-full object-cover mix-blend-multiply dark:mix-blend-normal",onError:o=>{o.currentTarget.src="/open-e-commerce/logo.png",o.currentTarget.onerror=null}})}),s.images&&s.images.length>1&&e.jsx("div",{className:"flex gap-4 overflow-x-auto pb-2",children:s.images.map((o,w)=>e.jsx("button",{onClick:()=>N(o),className:`relative w-24 h-24 rounded-lg overflow-hidden border-2 transition-all shrink-0 ${f===o?"border-primary ring-2 ring-primary/20":"border-transparent hover:border-muted-foreground/50"}`,children:e.jsx("img",{src:J(o),alt:`${s.name} view ${w+1}`,className:"w-full h-full object-cover",onError:C=>{C.currentTarget.src="/open-e-commerce/logo.png",C.currentTarget.onerror=null}})},w))})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-col gap-1 mb-2",children:[e.jsx(q,{to:`/category/${s.category.split(">").map(o=>encodeURIComponent(o.trim())).join("/")}`,className:"text-primary font-bold text-sm uppercase tracking-wider hover:underline",children:e.jsx("h4",{children:s.category})}),s.brand&&e.jsx("h4",{className:"text-muted-foreground font-medium text-base",children:s.brand}),s.variant&&e.jsx("span",{className:"inline-block px-2 py-0.5 rounded bg-muted text-muted-foreground text-xs font-medium w-fit mt-1",children:s.variant})]}),e.jsx("h2",{className:"text-4xl font-bold mb-4 leading-tight",children:s.name}),e.jsxs("div",{className:"flex items-baseline gap-4 mb-6",children:[e.jsx("div",{className:"text-3xl font-bold text-foreground",children:re(s.price,_)}),e.jsxs("div",{className:"flex items-center gap-2 border-l border-border pl-4",children:[e.jsx(oe,{rating:x,size:18}),e.jsxs("a",{href:"#reviews",className:"text-sm font-medium hover:underline text-muted-foreground",children:[x.toFixed(1)," (",v," reviews)"]})]}),s.on_hand>0?e.jsxs("span",{className:"text-green-600 dark:text-green-400 font-medium text-sm flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-current"}),"In Stock"]}):e.jsxs("span",{className:"text-destructive font-medium text-sm flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-current"}),"Out of Stock"]})]}),e.jsx("div",{className:"text-lg text-muted-foreground leading-relaxed mb-8 prose dark:prose-invert",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8 text-sm p-4 bg-muted/30 rounded-lg border border-border/50",children:[s.sku&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground block text-xs uppercase tracking-wide opacity-70",children:"SKU"}),e.jsx("span",{className:"font-medium font-mono",children:s.sku})]}),s.weight&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground block text-xs uppercase tracking-wide opacity-70",children:"Weight"}),e.jsxs("span",{className:"font-medium",children:[s.weight," lb"]})]}),s.condition&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground block text-xs uppercase tracking-wide opacity-70",children:"Condition"}),e.jsx("span",{className:"font-medium capitalize",children:s.condition})]}),s.gtin&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground block text-xs uppercase tracking-wide opacity-70",children:"Barcode/GTIN"}),e.jsx("span",{className:"font-medium font-mono text-xs",children:s.gtin})]}),s.mpn&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground block text-xs uppercase tracking-wide opacity-70",children:"MPN"}),e.jsx("span",{className:"font-medium font-mono text-xs",children:s.mpn})]})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-8",children:s.tags.map(o=>e.jsxs("span",{className:"px-3 py-1 bg-secondary text-secondary-foreground rounded-full text-xs font-medium",children:["#",o]},o))}),e.jsxs("div",{className:"bg-card border border-border p-6 rounded-xl shadow-sm mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-4",children:[e.jsx(Ze,{size:18}),e.jsx("span",{children:s.on_hand>0?`${s.on_hand} units available`:"Currently unavailable"})]}),p?e.jsx(we,{quantity:p.quantity,onDecrease:()=>{p.quantity>1?i(a,-1):c(a)},onIncrease:()=>i(a,1),maxQuantity:s.on_hand,className:"w-full"}):e.jsx("button",{onClick:b,disabled:s.on_hand<=0||h,className:`btn btn-primary w-full shadow-md hover:shadow-lg transition-all ${h?"opacity-80 scale-[0.98]":"hover:scale-[1.01]"}`,children:h?"Added to Cart!":e.jsxs(e.Fragment,{children:[e.jsx(Ne,{size:20})," Add to Cart"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50 text-sm text-foreground/80",children:[e.jsx(Et,{size:20,className:"text-primary"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Free Shipping"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"On orders over $50"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50 text-sm text-foreground/80",children:[e.jsx(At,{size:20,className:"text-primary"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Secure Payment"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"100% Request Protection"})]})]})]})]})]}),e.jsx("div",{className:"mt-16 pt-16 border-t border-border",children:e.jsx(ar,{productId:a,hideWriteButton:!0})})]})}const ir=async(t,a,s,n)=>{throw F.error("Google Address Validation API Key or Endpoint is missing."),new Error("Address validation service is not configured.")};function lr({isOpen:t,onClose:a,onConfirm:s,enteredAddress:n,suggestedAddress:r}){return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[200] animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-card w-full max-w-2xl p-6 rounded-lg shadow-xl border border-border animate-in zoom-in-95 duration-300",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Confirm Address"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"We found a standardized version of your address. Which one would you like to use?"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[e.jsxs("div",{className:"border border-border rounded-lg p-4 bg-muted/30 hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>s(n),children:[e.jsx("h3",{className:"font-semibold mb-3 text-sm uppercase tracking-wide text-muted-foreground",children:"You Entered"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium",children:n.address_line1}),n.address_line2&&e.jsx("div",{children:n.address_line2}),e.jsxs("div",{children:[n.city,", ",n.state," ",n.zip_code]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{className:"btn btn-outline w-full text-sm",onClick:l=>{l.stopPropagation(),s(n)},children:"Use Original"})})]}),e.jsxs("div",{className:"border border-primary rounded-lg p-4 bg-primary/5 hover:bg-primary/10 transition-colors cursor-pointer relative",onClick:()=>s(r),children:[e.jsx("div",{className:"absolute top-0 right-0 bg-primary text-primary-foreground text-xs font-bold px-2 py-1 rounded-bl-lg rounded-tr-lg",children:"Recommended"}),e.jsx("h3",{className:"font-semibold mb-3 text-sm uppercase tracking-wide text-primary",children:"Standardized"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium",children:r.address_line1}),r.address_line2&&e.jsx("div",{children:r.address_line2}),e.jsxs("div",{children:[r.city,", ",r.state," ",r.zip_code]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{className:"btn btn-primary w-full text-sm",onClick:l=>{l.stopPropagation(),s(r)},children:"Use Standardized"})})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:a,className:"btn btn-ghost text-muted-foreground hover:text-foreground",children:"Cancel"})})]})}):null}function lt({initialData:t,onSave:a,onCancel:s,isSaving:n=!1}){const[r,l]=d.useState({address_line1:t?.address_line1||"",address_line2:t?.address_line2||"",city:t?.city||"",state:t?.state||"",zip_code:t?.zip_code||"",country:t?.country||"US",is_default:t?.is_default||!1}),[m,u]=d.useState(!1),[i,c]=d.useState(!1),[p,_]=d.useState(null),x=async f=>{f.preventDefault(),u(!0);try{const N=await ir([r.address_line1,r.address_line2||""],r.city,r.state,r.zip_code);if(N.isValid&&N.components){const h=N.components.street||[],y={address_line1:h[0]||r.address_line1,address_line2:h.length>1?h.slice(1).join(", "):"",city:N.components.city||r.city,state:N.components.state||r.state,zip_code:N.components.zip||r.zip_code,country:"US",is_default:r.is_default};_(y),y.address_line1.toLowerCase()===r.address_line1.toLowerCase()&&(y.address_line2||"").toLowerCase()===(r.address_line2||"").toLowerCase()&&y.city.toLowerCase()===r.city.toLowerCase()&&y.state.toLowerCase()===r.state.toLowerCase()&&y.zip_code===r.zip_code?await a(r):c(!0)}else if(N.components&&(N.components.city||N.components.zip)){const h=N.components.street||[],y={address_line1:h[0]||r.address_line1,address_line2:h.length>1?h.slice(1).join(", "):"",city:N.components.city||r.city,state:N.components.state||r.state,zip_code:N.components.zip||r.zip_code,country:"US",is_default:r.is_default};_(y),c(!0)}else window.confirm("We could not verify this address. Save anyway?")&&await a(r)}catch(N){F.error("Address Validation Failed",N),await a(r)}finally{u(!1)}},v=async f=>{c(!1),await a(f)};return e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:x,className:"space-y-4 animate-in slide-in-from-top-2 duration-200",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Address Line 1"}),e.jsx("input",{type:"text",required:!0,value:r.address_line1,onChange:f=>l({...r,address_line1:f.target.value}),className:"form-input w-full",placeholder:"123 Main St"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Address Line 2 (Optional)"}),e.jsx("input",{type:"text",value:r.address_line2||"",onChange:f=>l({...r,address_line2:f.target.value}),className:"form-input w-full",placeholder:"Apt 4B"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"City"}),e.jsx("input",{type:"text",required:!0,value:r.city,onChange:f=>l({...r,city:f.target.value}),className:"form-input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"State"}),e.jsx("input",{type:"text",required:!0,value:r.state,onChange:f=>l({...r,state:f.target.value}),className:"form-input w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"ZIP Code"}),e.jsx("input",{type:"text",required:!0,value:r.zip_code,onChange:f=>l({...r,zip_code:f.target.value}),className:"form-input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Country"}),e.jsx("input",{type:"text",required:!0,value:r.country,onChange:f=>l({...r,country:f.target.value}),className:"form-input w-full"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"default-address",checked:r.is_default,onChange:f=>l({...r,is_default:f.target.checked}),className:"rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("label",{htmlFor:"default-address",className:"text-sm font-medium text-foreground",children:"Set as default address"})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"btn btn-secondary",disabled:m||n,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:m||n,children:m?"Validating...":n?"Saving...":"Verify & Save"})]})]}),e.jsx(lr,{isOpen:i,onClose:()=>c(!1),onConfirm:v,enteredAddress:r,suggestedAddress:p||r})]})}function cr({isOpen:t,onClose:a,totalAmount:s}){const{user:n}=ue(),{cartItems:r,clearCart:l}=me(),[m,u]=d.useState([]),[i,c]=d.useState("new"),[p,_]=d.useState(!1),[x,v]=d.useState(!1),[f,N]=d.useState(null);if(d.useEffect(()=>{t&&n&&(async()=>{if(n){_(!0);try{const{data:b,error:j}=await k.from("addresses").select("*").eq("user_id",n.id).order("is_default",{ascending:!1}).order("created_at",{ascending:!1});if(j)throw j;u(b||[]),b&&b.length>0?c(b[0].id):c("new")}catch(b){F.error("Failed to fetch addresses:",b)}finally{_(!1)}}})()},[t,n]),!t)return null;const h=async y=>{if(y.preventDefault(),!!n){v(!0),N(null);try{let b="";if(i==="new")throw new Error("Please add and save a new address before checking out.");{const I=m.find(U=>U.id===i);if(!I)throw new Error("Selected address not found.");b=`${I.address_line1}, ${I.address_line2?I.address_line2+", ":""}${I.city}, ${I.state} ${I.zip_code}`}await new Promise(I=>setTimeout(I,2e3));const{data:j,error:o}=await k.from("orders").insert({user_id:n.id,total_amount:s,shipping_address:b,status:"pending"}).select().single();if(o)throw o;const w=r.filter(I=>I.product).map(I=>({order_id:j.id,user_id:n.id,product_id:I.productId,product_name:I.product.name,quantity:I.quantity,price:I.product.price}));if(w.length===0)throw new Error("No valid items in cart");const{error:C}=await k.from("order_items").insert(w);if(C)throw C;l(),alert("Order placed successfully!"),a()}catch(b){F.error("Checkout error:",b);const j=b instanceof Error?b.message:"Failed to place order. Please try again.";N(j)}finally{v(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[100] animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-card w-full max-w-lg p-6 rounded-lg shadow-xl animate-in zoom-in-95 duration-300 border border-border max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-bold mb-6",children:"Checkout"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground",children:"Total Amount"}),e.jsxs("div",{className:"text-lg font-bold text-foreground",children:["$",s.toFixed(2)]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground",children:"Shipping Address"}),p?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading addresses..."}):e.jsxs("div",{className:"space-y-3",children:[m.map(y=>e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-md border border-input hover:bg-accent/50 transition-colors",children:[e.jsx("input",{type:"radio",id:`addr-${y.id}`,name:"shippingAddress",value:y.id,checked:i===y.id,onChange:b=>c(b.target.value),className:"mt-1"}),e.jsxs("label",{htmlFor:`addr-${y.id}`,className:"text-sm cursor-pointer flex-1 user-select-none",children:[e.jsx("div",{className:"font-medium",children:y.address_line1}),y.address_line2&&e.jsx("div",{children:y.address_line2}),e.jsxs("div",{className:"text-muted-foreground",children:[y.city,", ",y.state," ",y.zip_code]})]})]},y.id)),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-md border border-input hover:bg-accent/50 transition-colors",children:[e.jsx("input",{type:"radio",id:"addr-new",name:"shippingAddress",value:"new",checked:i==="new",onChange:y=>c(y.target.value)}),e.jsx("label",{htmlFor:"addr-new",className:"text-sm font-medium cursor-pointer",children:"Use a new address"})]})]})]}),i==="new"&&e.jsx("div",{className:"space-y-3 p-4 bg-muted/30 rounded-lg border border-border animate-in slide-in-from-top-2 duration-200",children:e.jsx(lt,{onSave:async y=>{try{const{data:b,error:j}=await k.from("addresses").insert({user_id:n.id,...y,is_default:m.length===0?!0:y.is_default}).select().single();if(j)throw j;u(o=>[b,...o]),c(b.id)}catch(b){F.error("Failed to save address",b),alert("Failed to save address")}},onCancel:()=>c(m.length>0?m[0].id:"")})}),e.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg border border-border",children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground mb-2 uppercase tracking-wide",children:"Payment Details (Dummy)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",placeholder:"Card Number",disabled:!0,className:"form-input bg-background/50 text-muted-foreground cursor-not-allowed w-full",value:"**** **** **** 4242"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"MM/YY",disabled:!0,className:"form-input bg-background/50 text-muted-foreground cursor-not-allowed w-1/2",value:"12/25"}),e.jsx("input",{type:"text",placeholder:"CVC",disabled:!0,className:"form-input bg-background/50 text-muted-foreground cursor-not-allowed w-1/2",value:"123"})]})]})]}),f&&e.jsx("div",{className:"p-3 rounded-md bg-destructive/10 text-destructive text-sm",children:f}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-border",children:[e.jsx("button",{type:"button",onClick:a,disabled:x,className:"btn btn-ghost",children:"Cancel"}),e.jsx("button",{type:"button",onClick:h,disabled:x,className:"btn btn-primary",children:x?"Processing...":"Pay Now"})]})]})]})})}function De({title:t,description:a,children:s,className:n}){return e.jsxs("div",{className:de("page-header",n),children:[e.jsxs("div",{children:[e.jsx("h2",{className:"page-title",children:t}),a&&e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:a})]}),s&&e.jsx("div",{className:"flex gap-2 items-center",children:s})]})}function dr(){const{cartItems:t,updateQuantity:a,removeFromCart:s}=me(),{settings:n}=ae(),[r,l]=d.useState(new Map),[m,u]=d.useState(!0),[i,c]=d.useState(!1);d.useEffect(()=>{async function f(){if(t.length===0){u(!1);return}const N=t.map(b=>b.productId),{data:h,error:y}=await k.from("products").select("*").in("id",N);if(y)F.error("Error fetching cart products:",y);else if(h){const b=new Map;h.forEach(j=>b.set(j.id,j)),l(b)}u(!1)}f()},[t]);const p=(f,N,h)=>{N+h<=0?s(f):a(f,h)},_=f=>s(f);if(m)return e.jsx("div",{className:"empty-cart",children:"Loading cart..."});const x=t.map(f=>{const N=r.get(f.productId);return N?{...f,product:N}:null}).filter(f=>f!==null),v=x.reduce((f,N)=>f+N.product.price*N.quantity,0);return x.length===0?e.jsxs("div",{className:"text-center py-16 px-4 animate-in fade-in duration-500",children:[e.jsx("div",{className:"w-20 h-20 bg-muted text-muted-foreground rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(je,{size:40})}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Your Cart is Empty"}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-md mx-auto",children:"Looks like you haven't added anything to your cart yet. Explore our products to find something you'll love."}),e.jsx(q,{to:"/",className:"btn btn-primary",children:"Start Shopping"})]}):e.jsxs("div",{className:"animate-in fade-in duration-500",children:[e.jsx(De,{title:e.jsxs("span",{className:"flex items-center gap-4",children:[e.jsx(je,{className:"text-primary",size:32}),e.jsx("span",{children:"Shopping Cart"}),e.jsxs("span",{className:"text-xl text-muted-foreground font-normal",children:["(",x.length," items)"]})]}),className:"mb-8"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2 flex flex-col gap-4",children:x.map(({productId:f,quantity:N,product:h})=>e.jsxs("div",{className:"card flex items-center gap-6 p-6",children:[e.jsx("div",{className:"w-24 h-24 rounded-lg bg-muted object-cover overflow-hidden shrink-0",children:e.jsx("img",{src:J(h.image),alt:h.name,className:"w-full h-full object-cover mix-blend-multiply dark:mix-blend-normal",onError:y=>{y.currentTarget.src="/open-e-commerce/logo.png",y.currentTarget.onerror=null}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(q,{to:`/product/${h.id}`,className:"block mb-1 group",children:e.jsx("h3",{className:"font-semibold text-lg group-hover:text-primary transition-colors",children:h.name})}),e.jsx(q,{to:`/category/${h.category.split(">").map(y=>encodeURIComponent(y.trim())).join("/")}`,className:"text-sm text-muted-foreground",children:h.category}),e.jsx("div",{className:"text-primary font-bold mt-1",children:re(h.price,n)})]}),e.jsxs("div",{className:"flex flex-col items-end gap-4",children:[e.jsx(we,{quantity:N,onDecrease:()=>p(f,N,-1),onIncrease:()=>p(f,N,1),maxQuantity:h.on_hand,className:"w-32"}),e.jsxs("button",{onClick:()=>_(f),className:"text-destructive text-sm flex items-center gap-1 hover:underline",children:[e.jsx(Ee,{size:16})," Remove"]})]})]},f))}),e.jsx("div",{children:e.jsxs("div",{className:"card p-6 sticky top-24",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Order Summary"}),e.jsxs("div",{className:"flex justify-between mb-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:re(v,n)})]}),e.jsxs("div",{className:"flex justify-between mb-2 text-sm text-muted-foreground",children:[e.jsx("span",{children:"Shipping"}),e.jsx("span",{className:"text-green-600",children:"Free"})]}),e.jsxs("div",{className:"flex justify-between mb-6 text-sm text-muted-foreground",children:[e.jsx("span",{children:"Tax"}),e.jsx("span",{children:"Calculated at checkout"})]}),e.jsxs("div",{className:"flex justify-between border-t border-border pt-4 mb-6 font-bold text-xl",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"text-primary",children:re(v,n)})]}),e.jsxs("button",{className:"btn btn-primary w-full",onClick:()=>c(!0),children:["Proceed to Checkout ",e.jsx(It,{size:18})]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground mt-4",children:"Secure Checkout powered by OpenStore"})]})})]}),e.jsx(cr,{isOpen:i,onClose:()=>c(!1),totalAmount:v})]})}function mr(){const[t,a]=d.useState(""),[s,n]=d.useState(""),[r,l]=d.useState(!1),[m,u]=d.useState(null),i=ie(),c=async p=>{p.preventDefault(),l(!0),u(null);const{data:_,error:x}=await k.auth.signInWithPassword({email:t,password:s});if(x)u(x.message),l(!1);else{const{data:v}=await k.from("profiles").select("role").eq("id",_.user?.id).single();v?.role==="admin"?i("/admin",{replace:!0}):i("/",{replace:!0})}};return e.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-200px)] py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 animate-in fade-in zoom-in duration-500",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Dt,{className:"mx-auto h-12 w-12 text-primary"}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-foreground",children:"Sign in to your account"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-muted-foreground",children:["Or"," ",e.jsx(q,{to:"/register",className:"font-medium text-primary hover:text-accent transition-colors",children:"create a new account"})]})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:c,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"form-input",placeholder:"Email address",value:t,onChange:p=>a(p.target.value)})}),e.jsx("div",{children:e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"form-input",placeholder:"Password",value:s,onChange:p=>n(p.target.value)})})]}),m&&e.jsx("div",{className:"rounded-md bg-destructive/10 p-4 text-sm text-destructive text-center",children:m}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:r,className:"btn btn-primary w-full",children:r?"Signing in...":"Sign in"})})]})]})})}function ur(){const[t,a]=d.useState(""),[s,n]=d.useState(""),[r,l]=d.useState(""),[m,u]=d.useState(!1),[i,c]=d.useState(null),p=ie(),_=async x=>{x.preventDefault(),u(!0),c(null);const{error:v}=await k.auth.signUp({email:s,password:r,options:{data:{full_name:t}}});v?(c(v.message),u(!1)):p("/")};return e.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-200px)] py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 animate-in fade-in zoom-in duration-500",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(Ft,{className:"mx-auto h-12 w-12 text-primary"}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-foreground",children:"Create a new account"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-muted-foreground",children:["Or"," ",e.jsx(q,{to:"/login",className:"font-medium text-primary hover:text-accent transition-colors",children:"sign in to your existing account"})]})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:_,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsx("input",{id:"full-name",name:"full-name",type:"text",autoComplete:"name",required:!0,className:"form-input",placeholder:"Full Name",value:t,onChange:x=>a(x.target.value)})}),e.jsx("div",{children:e.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"form-input",placeholder:"Email address",value:s,onChange:x=>n(x.target.value)})}),e.jsx("div",{children:e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,className:"form-input",placeholder:"Password",value:r,onChange:x=>l(x.target.value)})})]}),i&&e.jsx("div",{className:"rounded-md bg-destructive/10 p-4 text-sm text-destructive text-center",children:i}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:m,className:"btn btn-primary w-full",children:m?"Creating account...":"Sign up"})})]})]})})}const Fe=(t,a=null,s={})=>{const[n,r]=d.useState(a);return{items:d.useMemo(()=>{const u=[...t];return n!==null&&u.sort((i,c)=>{let p,_;return s[n.key]?(p=s[n.key](i),_=s[n.key](c)):(p=i[n.key],_=c[n.key]),typeof p=="string"&&typeof _=="string"&&(p=p.toLowerCase(),_=_.toLowerCase()),p==null?1:_==null?-1:p<_?n.direction==="ascending"?-1:1:p>_?n.direction==="ascending"?1:-1:0}),u},[t,n,s]),requestSort:u=>{let i="ascending";n&&n.key===u&&n.direction==="ascending"&&(i="descending"),r({key:u,direction:i})},sortConfig:n}};function se({title:t,description:a,children:s,className:n}){return e.jsxs("div",{className:de("section-header",n),children:[e.jsxs("div",{children:[e.jsx("h3",{className:"section-title",children:t}),a&&e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:a})]}),s&&e.jsx("div",{className:"flex gap-2 items-center",children:s})]})}function $({label:t,sortKey:a,currentSort:s,onSort:n,className:r,align:l="left"}){const m=s?.key===a,u=s?.direction,i={left:"justify-start",center:"justify-center",right:"justify-end"}[l];return e.jsx("th",{className:de("table-header cursor-pointer hover:text-foreground transition-colors",r),onClick:()=>n(a),children:e.jsxs("div",{className:de("flex items-center gap-1",i),children:[t,m&&(u==="ascending"?e.jsx(zt,{size:14,className:"inline ml-1"}):e.jsx(Mt,{size:14,className:"inline ml-1"}))]})})}function hr(){const[t,a]=d.useState([]),[s,n]=d.useState({}),[r,l]=d.useState(!0),[m,u]=d.useState([]),[i,c]=d.useState([]);d.useEffect(()=>{(async()=>{l(!0);try{const{data:w,error:C}=await k.from("orders").select("*").order("created_at",{ascending:!1});if(C)throw C;const I=w||[];a(I);const U=Array.from(new Set(I.map(M=>M.user_id)));if(U.length>0){const{data:M,error:T}=await k.from("profiles").select("*").in("id",U);if(T)F.error("Error fetching profiles for orders:",T);else{const A=(M||[]).reduce((S,D)=>({...S,[D.id]:D}),{});n(A)}}}catch(w){F.error("Error fetching data:",w)}finally{l(!1)}})()},[]);const p=o=>t.filter(w=>{const C=o==="status"||m.length===0||m.includes(w.status),I=o==="customer"||i.length===0||i.includes(w.user_id);return C&&I}),_=p("customer"),x=Array.from(new Set(_.map(o=>o.user_id))),v=p(null),{items:f,requestSort:N,sortConfig:h}=Fe(v,{key:"created_at",direction:"descending"},{customer_name:o=>s[o.user_id]?.full_name||s[o.user_id]?.email||o.user_id}),y=(o,w,C)=>{C&&C!=="all"&&!o.includes(C)&&w([...o,C])},b=(o,w,C)=>{w(o.filter(I=>I!==C))},j=async(o,w)=>{const C=[...t];a(t.map(M=>M.id===o?{...M,status:w}:M));const{data:I,error:U}=await k.from("orders").update({status:w}).eq("id",o).select();U?(F.error("Error updating order:",U),alert("Failed to update status"),a(C)):(!I||I.length===0)&&(F.error("Error updating order: No rows affected. Check RLS policies."),alert("Failed to update status: You may not have permission to update this order."),a(C))};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(se,{title:"Order Management"}),e.jsxs("div",{className:"filter-section",children:[e.jsxs("div",{className:"space-y-2 w-full sm:flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsxs("select",{value:"",onChange:o=>y(m,u,o.target.value),className:"input",children:[e.jsx("option",{value:"",children:"Select Status..."}),["pending","processing","shipped","cancelled"].filter(o=>m.indexOf(o)===-1).map(o=>e.jsx("option",{value:o,className:"capitalize",children:o},o))]}),m.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(o=>e.jsxs("div",{onClick:()=>b(m,u,o),className:"filter-chip",children:[e.jsx("span",{className:"capitalize",children:o}),e.jsx(K,{size:14,className:"opacity-50 group-hover:opacity-100"})]},o))})]}),e.jsxs("div",{className:"space-y-2 w-full sm:flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Customer"}),e.jsxs("select",{value:"",onChange:o=>y(i,c,o.target.value),className:"input",children:[e.jsx("option",{value:"",children:"Select Customer..."}),x.filter(o=>!i.includes(o)).map(o=>{const w=s[o];return e.jsx("option",{value:o,children:w?.full_name||w?.email||o},o)})]}),i.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:i.map(o=>{const w=s[o];return e.jsxs("div",{onClick:()=>b(i,c,o),className:"filter-chip group",children:[w?.full_name||w?.email||o,e.jsx(K,{size:14,className:"opacity-50 group-hover:opacity-100"})]},o)})})]}),e.jsx("button",{onClick:()=>{u([]),c([])},className:"btn btn-primary h-[38px] whitespace-nowrap shrink-0 mt-[28px]",children:"Clear Filters"})]}),r?e.jsx("div",{className:"text-center p-8",children:"Loading orders..."}):v.length===0?e.jsx("div",{className:"text-center p-8 text-muted-foreground",children:"No orders found matching your filters."}):e.jsx("div",{className:"overflow-x-auto border border-border rounded-lg",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted",children:[e.jsx($,{label:"Order ID",sortKey:"id",onSort:N,currentSort:h}),e.jsx($,{label:"Date",sortKey:"created_at",onSort:N,currentSort:h}),e.jsx($,{label:"Customer",sortKey:"customer_name",onSort:N,currentSort:h}),e.jsx($,{label:"Total",sortKey:"total_amount",onSort:N,currentSort:h}),e.jsx($,{label:"Status",sortKey:"status",onSort:N,currentSort:h}),e.jsx("th",{className:"p-3 text-sm font-semibold text-muted-foreground border-b border-border",children:"Actions"})]})}),e.jsx("tbody",{children:f.map(o=>{const w=s[o.user_id];return e.jsxs("tr",{className:"border-b border-border last:border-0 hover:bg-muted/50 transition-colors",children:[e.jsx("td",{className:"p-3 text-sm",children:e.jsxs(q,{to:`/order/${o.id}`,className:"hover:text-primary ",children:["#",o.id]})}),e.jsx("td",{className:"p-3 text-sm",children:new Date(o.created_at).toLocaleDateString()}),e.jsxs("td",{className:"p-3 text-sm",children:[e.jsx("div",{className:"font-medium text-foreground",children:w?.full_name||"Unknown User"}),e.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:w?.email||o.user_id.split("-")[0]})]}),e.jsxs("td",{className:"p-3 text-sm font-medium",children:["$",o.total_amount.toFixed(2)]}),e.jsx("td",{className:"p-3 text-sm",children:e.jsx(Z,{variant:o.status==="shipped"?"success":o.status==="processing"?"info":o.status==="cancelled"?"neutral":"warning",children:o.status})}),e.jsx("td",{className:"p-3 text-sm",children:e.jsxs("select",{name:"status-select",value:o.status,onChange:C=>j(o.id,C.target.value),className:"h-8 px-2 text-xs rounded border border-input bg-background focus:ring-2 focus:ring-ring",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})})]},o.id)})})]})})]})}function pr(){const{isAdmin:t}=ue(),[a,s]=d.useState([]),[n,r]=d.useState(!0),[l,m]=d.useState(null),[u,i]=d.useState([]),[c,p]=d.useState([]);d.useEffect(()=>{(async()=>{r(!0);const{data:w,error:C}=await k.from("profiles").select("*").order("updated_at",{ascending:!1});C?F.error("Error fetching profiles:",C):s(w||[]),r(!1)})()},[]);const _=Array.from(new Set(a.map(o=>o.role))).filter(Boolean),x=a.filter(o=>{const w=u.length===0||u.includes(o.role),C=c.length===0?!0:c.includes(o.email_verified?"verified":"unverified");return w&&C}),{items:v,requestSort:f,sortConfig:N}=Fe(x,{key:"full_name",direction:"ascending"},{email_verified_status:o=>o.email_verified?"Verified":"Unverified"}),h=(o,w,C)=>{C&&C!=="all"&&!o.includes(C)&&w([...o,C])},y=(o,w,C)=>{w(o.filter(I=>I!==C))},b=async o=>{if(o.preventDefault(),!l)return;const w={full_name:l.full_name,phone_number:l.phone_number};t&&(w.role=l.role);const{error:C}=await k.from("profiles").update(w).eq("id",l.id);C?(F.error("Error updating profile:",C),alert("Failed to update profile")):(s(a.map(I=>I.id===l.id?l:I)),m(null))},j=async o=>{if(!confirm("Are you sure you want to delete this profile? This cannot be undone."))return;const{error:w,data:C}=await k.from("profiles").delete().eq("id",o).select("*");w?(F.error("Error deleting profile:",w),alert("Failed to delete profile")):C.length>0?s(a.filter(I=>I.id!==o)):(F.error("Profile not found",o),alert("Profile not found"))};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(se,{title:"Customer Management"}),e.jsxs("div",{className:"filter-section",children:[e.jsxs("div",{className:"space-y-2 w-full sm:flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Filter by Role"}),e.jsxs("select",{value:"",onChange:o=>h(u,i,o.target.value),className:"input",children:[e.jsx("option",{value:"",children:"Select Role..."}),_.filter(o=>!u.includes(o)).map(o=>e.jsx("option",{value:o,children:o},o))]}),u.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(o=>e.jsxs("div",{onClick:()=>y(u,i,o),className:"filter-chip group",children:[o,e.jsx(K,{size:14,className:"opacity-50 group-hover:opacity-100"})]},o))})]}),e.jsxs("div",{className:"space-y-2 w-full sm:flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsxs("select",{value:"",onChange:o=>h(c,p,o.target.value),className:"input",children:[e.jsx("option",{value:"",children:"Select Status..."}),["verified","unverified"].filter(o=>!c.includes(o)).map(o=>e.jsx("option",{value:o,className:"capitalize",children:o},o))]}),c.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(o=>e.jsxs("div",{onClick:()=>y(c,p,o),className:"filter-chip group",children:[e.jsx("span",{className:"capitalize",children:o}),e.jsx(K,{size:14,className:"opacity-50 group-hover:opacity-100"})]},o))})]}),e.jsx("button",{onClick:()=>{i([]),p([])},className:"btn btn-primary h-[38px] whitespace-nowrap shrink-0 mt-[28px]",children:"Clear Filters"})]}),n?e.jsx("div",{className:"text-center p-8",children:"Loading customers..."}):x.length===0?e.jsx("div",{className:"text-center p-8 text-muted-foreground",children:"No customers found."}):e.jsx("div",{className:"overflow-x-auto border border-border rounded-lg",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted",children:[e.jsx($,{label:"Name",sortKey:"full_name",onSort:f,currentSort:N}),e.jsx($,{label:"Email",sortKey:"email",onSort:f,currentSort:N}),e.jsx($,{label:"Role",sortKey:"role",onSort:f,currentSort:N}),e.jsx($,{label:"Phone",sortKey:"phone_number",onSort:f,currentSort:N}),e.jsx($,{label:"Status",sortKey:"email_verified_status",onSort:f,currentSort:N}),e.jsx("th",{className:"p-3 text-sm font-semibold text-muted-foreground border-b border-border",children:"Actions"})]})}),e.jsx("tbody",{children:v.map(o=>e.jsxs("tr",{className:"border-b border-border last:border-0 hover:bg-muted/50 transition-colors",children:[e.jsxs("td",{className:"p-3 text-sm font-medium",children:[e.jsx(q,{to:`/profile/${o.id}`,className:"hover:text-primary ",children:o.full_name||e.jsx("span",{className:"text-muted-foreground italic",children:"No Name"})}),e.jsxs("div",{className:"text-xs text-muted-foreground font-mono mt-0.5",children:[o.id.split("-")[0],"..."]})]}),e.jsx("td",{className:"p-3 text-sm",children:e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{children:o.email||e.jsx("span",{className:"text-muted-foreground italic",children:"Hidden"})})})}),e.jsx("td",{className:"p-3 text-sm",children:e.jsx(Z,{variant:o.role==="admin"?"purple":"neutral",children:o.role})}),e.jsx("td",{className:"p-3 text-sm",children:o.phone_number||"-"}),e.jsx("td",{className:"p-3 text-sm",children:e.jsx(Z,{variant:o.email_verified?"success":"warning",children:o.email_verified?"Verified":"Unverified"})}),e.jsx("td",{className:"p-3 text-sm",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>m(o),className:"btn btn-secondary btn-sm",children:"Edit"}),e.jsx("button",{onClick:()=>j(o.id),className:"btn btn-danger btn-sm text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:"Delete"})]})})]},o.id))})]})}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-background rounded-lg shadow-lg w-full max-w-md p-6 animate-in fade-in zoom-in-95 duration-200 max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Edit Customer"}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:l.full_name||"",onChange:o=>m({...l,full_name:o.target.value}),className:"w-full h-9 px-3 rounded-md border border-input bg-background"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email Status"}),e.jsxs("div",{className:"flex items-center h-9 px-3 rounded-md border border-input bg-muted/50 text-sm text-muted-foreground",children:[e.jsx(Z,{variant:l.email_verified?"success":"warning",className:"mr-2",children:l.email_verified?"Verified":"Unverified"}),l.email]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Role"}),t?e.jsxs("select",{value:l.role,onChange:o=>m({...l,role:o.target.value}),className:"w-full h-9 px-3 rounded-md border border-input bg-background",children:[e.jsx("option",{value:"customer",children:"Customer"}),e.jsx("option",{value:"admin",children:"Admin"})]}):e.jsx("div",{className:"h-9 px-3 flex items-center rounded-md border border-input bg-muted text-sm text-muted-foreground capitalize",children:l.role})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:l.phone_number||"",onChange:o=>m({...l,phone_number:o.target.value}),className:"w-full h-9 px-3 rounded-md border border-input bg-background"})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>m(null),className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Changes"})]})]})]})})]})}const xr="Aberd.",gr="Aberdeensh.",fr="abl.",br="Abol.",yr="Aborig.",vr="Abridg.",jr="Abridgem.",Nr="Absol.",wr="abstr.",_r="Accept.",Cr="Accomm.",Sr="Accompl.",kr="Acct.",Pr="Accts.",Er="accus.",Ar="Achievem.",Ir="Addr.",Dr="adjs.",Fr="Adm.",zr="Admir.",Mr="Admonit.",Rr="Adv.",Tr="Adv.",Lr="advs.",Or="Advt.",$r="Advts.",qr="Adv.",Ur="Advoc.",Br="Aerodynam.",Wr="Aff.",Vr="Affect.",Hr="agst.",Gr="Alch.",Kr="Alg.",Yr="Alleg.",Jr="Allit.",Qr="Alm.",Xr="alt.",Zr="Anal.",en="Anc.",tn="Anecd.",sn="Angl.",rn="Anniv.",nn="Annot.",an="Ann.",on="Anon.",ln="Answ.",cn="a",dn="Anthrop.",mn="Ant.",un="app.",hn="App.",pn="Appl.",xn="Apr.",gn="Arab.",fn="Arb.",bn="arch.",yn="Abp.",vn="Archipel.",jn="Arch.",Nn="Argt.",wn="Arith.",_n="Arrangem.",Cn="art.",Sn="Artic.",kn="Artific.",Pn="Artill.",En="Ashm.",An="Assoc.",In="Assyriol.",Dn="Astrol.",Fn="Astr.",zn="Att.",Mn="Aug.",Rn="Autobiog.",Tn="Ayrsh.",Ln="Bedfordsh.",On="bef.",$n="Belg.",qn="Berksh.",Un="Berwicksh.",Bn="betw.",Wn="Bibliogr.",Vn="Biog.",Hn="Bp.",Gn="BLK",Kn="BLU",Yn="Bk.",Jn="Bks.",Qn="Bord.",Xn="Braz.",Zn="BRN",ea="Bucks.",ta="Build.",sa="Bull.",ra="Bur.",na="Calc.",aa="Calend.",oa="Calif.",ia="Calligr.",la="Cambr.",ca="Campanol.",da="Canad.",ma="Canterb.",ua="Capt.",ha="Catal.",pa="Catech.",xa="Cath.",ga="Cent.",fa="Cent.",ba="Ceram.",ya="Certif.",va="Chamb.",ja="Charac.",Na="Chas.",wa="Chesh.",_a="Chr.",Ca="Chrons.",Sa="Chronol.",ka="Ch.",Pa="c",Ea="Circ.",Aa="Class.",Ia="Classif.",Da="cl.",Fa="Climatol.",za="Clin.",Ma="Cl.",Ra="Collect.",Ta="Coll.",La="Colloq.",Oa="Col.",$a="Coloss.",qa="Combs.",Ua="Commandm.",Ba="Commend.",Wa="Comm.",Va="Commerc.",Ha="Commiss.",Ga="Comm.",Ka="Comm.",Ya="Commonw.",Ja="Comp.",Qa="Comp.",Xa="Compar.",Za="compl.",eo="Compl.",to="Compos.",so="cpd.",ro="conc.",no="Conch.",ao="Conc.",oo="Concl.",io="Conf.",lo="Conf.",co="Confid.",mo="Confl.",uo="Confut.",ho="Congreg.",po="Congr.",xo="Congress.",go="conj.",fo="conj.",bo="Conn.",yo="Consc.",vo="Consol.",jo="cons.",No="Constr.",wo="Contempl.",_o="Contemp.",Co="Content.",So="Contin.",ko="Contradict.",Po="Contrib.",Eo="Controv.",Ao="Controv.",Io="Convent.",Do="Conversat.",Fo="Convoc.",zo="Cor.",Mo="Cornw.",Ro="Coron.",To="Corresp.",Lo="Counc.",Oo="Ct.",$o="Ct.",qo="Crts.",Uo="Courtsh.",Bo="Craniol.",Wo="Craniom.",Vo="Crim.",Ho="Crit.",Go="Crit.",Ko="Cryptogr.",Yo="Crystallogr.",Jo="Cumbld.",Qo="Cycl.",Xo="Dan.",Zo="dat.",ei="Dau.",ti="Deb.",si="Dec.",ri="Declar.",ni="Ded.",ai="Ded.",oi="Def.",ii="def.",li="def.",ci="Deliv.",di="Demonstr.",mi="dem.",ui="Dept.",hi="Depredat.",pi="Dep.",xi="Derbysh.",gi="derog.",fi="Deut.",bi="Devel.",yi="Devonsh.",vi="Dial.",ji="Dict.",Ni="dim.",wi="Direct.",_i="Discipl.",Ci="Disc.",Si="Discov.",ki="Discrim.",Pi="Discuss.",Ei="Diss.",Ai="Distemp.",Ii="Distill.",Di="Distrib.",Fi="Dist.",zi="Divers.",Mi="Div.",Ri="Div.",Ti="Doctr.",Li="Domest.",Oi="Dk.",$i="Durh.",qi="dyslog.",Ui="e.",Bi="Eccles.",Wi="Eccles.",Vi="Ecclus.",Hi="Edinb.",Gi="Ed.",Ki="ELEC",Yi="Edw.",Ji="Egypt.",Qi="Egyptol.",Xi="Eliz.",Zi="Elizab.",el="Emb.",tl="Engin.",sl="Englishw.",rl="Enq.",nl="Enthus.",al="Enzymol.",ol="Ephes.",il="Epil.",ll="Episc.",cl="Epist.",dl="Epit.",ml="Equip.",ul="Esd.",hl="esp.",pl="Essent.",xl="Establ.",gl="Esth.",fl="Ethnol.",bl="etym.",yl="Eval.",vl="Evang.",jl="Even.",Nl="Evid.",wl="Exalt.",_l="Exam.",Cl="exc.",Sl="Exch.",kl="Exch.",Pl="Exec.",El="Exec.",Al="Exod.",Il="Exped.",Dl="Explan.",Fl="Explic.",zl="Explor.",Ml="Ezek.",Rl="Fam.",Tl="Farew.",Ll="Fr.",Ol="Feb.",$l="fem.",ql="Fifesh.",Ul="f.",Bl="Ff.",Wl="Footpr.",Vl="Forfarsh.",Hl="Fortif.",Gl="Fortn.",Kl="Fratern.",Yl="Fr.",Jl="freq.",Ql="Friendsh.",Xl="Fr.",Zl="Furnit.",ec="fut.",tc="Gal.",sc="Gastron.",rc="Gaz.",nc="Gen.",ac="Gen.",oc="gen.",ic="Geog.",lc="Geomorphol.",cc="Geo.",dc="Ger.",mc="gerund.",uc="Glasg.",hc="Gloss.",pc="Gloucestersh.",xc="GLD",gc="Gd.",fc="Govt.",bc="Gram.",yc="GRY",vc="Gt.",jc="GRN",Nc="GRY",wc="Gynaecol.",_c="Hab.",Cc="Haematol.",Sc="Hag.",kc="HMR",Pc="Hants.",Ec="Handbk.",Ac="HDWR",Ic="Heb.",Dc="HDPH",Fc="Hebr.",zc="Hen.",Mc="Her.",Rc="Herb.",Tc="Herefordsh.",Lc="Hertfordsh.",Oc="Hierogl.",$c="hist.",qc="Hom.",Uc="Horol.",Bc="Hos.",Wc="Hosp.",Vc="Househ.",Hc="Housek.",Gc="Husb.",Kc="Hydraul.",Yc="Ichth.",Jc="Icthyol.",Qc="Idol.",Xc="imit.",Zc="Immunol.",ed="imp.",td="impf.",sd="impers.",rd="Impr.",nd="Impr.",ad="Inaug.",od="Inclos.",id="indef.",ld="indic.",cd="indir.",dd="Industr.",md="Ind.",ud="infin.",hd="Infl.",pd="infl.",xd="Inorg.",gd="Inq.",fd="Instr.",bd="instr.",yd="Intellect.",vd="Interc.",jd="interj.",Nd="Interl.",wd="Internat.",_d="Interpr.",Cd="interrog.",Sd="intrans.",kd="Intro.",Pd="Investig.",Ed="Investm.",Ad="Invoc.",Id="Irel.",Dd="Ir.",Fd="iron.",zd="Isa.",Md="Ital.",Rd="Jahrb.",Td="Jas.",Ld="Jam.",Od="Jan.",$d="Jap.",qd="Jer.",Ud="Josh.",Bd="Jrnl.",Wd="Jrnls.",Vd="Judg.",Hd="Jul.",Gd="Jun.",Kd="Jun.",Yd="Jurisdict.",Jd="Jurispr.",Qd="Justific.",Xd="Kpr.",Zd="Kent.",em="K.",tm="Kingd.",sm="Kgs.",rm="Knowl.",nm="Lab.",am="Lament",om="Lament.",im="Lancs.",lm="Lang.",cm="Langs.",dm="L",mm="Lat.",um="LAV",hm="Leechd.",pm="Leics.",xm="Let.",gm="Lett.",fm="Lev.",bm="Lex.",ym="Libr.",vm="Limnol.",jm="Lincs.",Nm="l.",wm="ll.",_m="Linn.",Cm="Lithogr.",Sm="Lithol.",km="Liturg.",Pm="Lond.",Em="Ld.",Am="Lds.",Im="Macc.",Dm="Mag.",Fm="Mal.",zm="Managem.",Mm="Manch.",Rm="Manip.",Tm="Man.",Lm="MS.",Om="MSS.",$m="Mar.",qm="MAR",Um="masc.",Bm="Mass.",Wm="Matt.",Vm="Meas.",Hm="Measurem.",Gm="med.",Km="Medit.",Ym="M",Jm="Mtg.",Qm="Merc.",Xm="Metallif.",Zm="Metallogr.",eu="Metall.",tu="Metamorph.",su="Metaph.",ru="Mex.",nu="Mic.",au="Mich.",ou="Microbiol.",iu="Milit.",lu="Min.",cu="Miscell.",du="mispr.",mu="Mod.",uu="Monum.",hu="Morphol.",pu="Mts.",xu="Munic.",gu="Munif.",fu="Munim.",bu="Mus.",yu="Myst.",vu="Mythol.",ju="Nah.",Nu="Narrat.",wu="Nat.",_u="Naut.",Cu="Nav.",Su="Navig.",ku="NVY",Pu="Neh.",Eu="Nerv.",Au="Neurosurg.",Iu="n.",Du="Newc.",Fu="Newspr.",zu="nom.",Mu="Norf.",Ru="n.",Tu="Northants.",Lu="Northumbld.",Ou="Northumbr.",$u="Norweg.",qu="Notts.",Uu="n.",Bu="ns.",Wu="Nov.",Vu="Nucl.",Hu="No.",Gu="Num.",Ku="Numism.",Yu="Obad.",Ju="Obed.",Qu="obl.",Xu="Obs.",Zu="Occas.",eh="occas.",th="Occurr.",sh="Oct.",rh="Offic.",nh="Okla.",ah="OLV",oh="Ont.",ih="Ophthalm.",lh="Oppress.",ch="Opt.",dh="ORG",mh="Org.",uh="Orig.",hh="Orkn.",ph="Ornith.",xh="Orthogr.",gh="Outl.",fh="Oxf.",bh="Oxon.",yh="p.",vh="Palaeobot.",jh="Palaeogr.",Nh="Palaeont.",wh="Parasitol.",_h="Parnass.",Ch="Pt.",Sh="ppl.",kh="pple.",Ph="pples.",Eh="pa.",Ah="Penins.",Ih="Pa.",Dh="pf.",Fh="perh.",zh="Pers.",Mh="Pers.",Rh="personif.",Th="Perthsh.",Lh="Pet.",Oh="Pharmaceut.",$h="Pharm.",qh="Philad.",Uh="Philem.",Bh="Philipp.",Wh="Phoen.",Vh="Phonol.",Hh="Photog.",Gh="phr.",Kh="Phrenol.",Yh="Physiogr.",Jh="Phys.",Qh="Pict.",Xh="PNK",Zh="plur.",ep="Poet.",tp="Pop.",sp="Porc.",rp="Port.",np="poss.",ap="Postm.",op="Pott.",ip="Pract.",lp="Pract.",cp="prec.",dp="pred.",mp="Predict.",up="Pref.",hp="pref.",pp="Preh.",xp="Prerog.",gp="Presb.",fp="Presb.",bp="Pres.",yp="Preserv.",vp="Print.",jp="priv.",Np="prob.",wp="Probl.",_p="Proc.",Cp="Prol.",Sp="pron.",kp="Pronunc.",Pp="prop.",Ep="propr.",Ap="Pros.",Ip="Prov.",Dp="Prov.",Fp="Provinc.",zp="Provis.",Mp="Ps.",Rp="Psychoanal.",Tp="Psychoanalyt.",Lp="Psych.",Op="Publ.",$p="Purg.",qp="PPL",Up="Q.",Bp="Q.",Wp="Qld.",Vp="quot.",Hp="quots.",Gp="Radiol.",Kp="Rebell.",Yp="Reclam.",Jp="Recoll.",Qp="RED",Xp="Redempt.",Zp="redupl.",ex="Ref.",tx="refl.",sx="Ref.",rx="Refus.",nx="Refut.",ax="Regic.",ox="Regr.",ix="reg.",lx="rel.",cx="Rel.",dx="rel.",mx="Remonstr.",ux="Renfrewsh.",hx="Rept.",px="Repub.",xx="Res.",gx="Retrosp.",fx="Rev.",bx="Rev.",yx="Rev.",vx="Revol.",jx="Rhet.",Nx="Rich.",wx="Rom.",_x="Rom.",Cx="Roxb.",Sx="Roy.",kx="St.",Px="SS.",Ex="Sam.",Ax="Sask.",Ix="Sat.",Dx="Sax.",Fx="Sch.",zx="Scotl.",Mx="Scot.",Rx="Script.",Tx="Sculpt.",Lx="Seismol.",Ox="Sel.",$x="Select.",qx="Sept.",Ux="LXX",Bx="Ser.",Wx="Sess.",Vx="Settlem.",Hx="Sev.",Gx="Shaks.",Kx="Sheph.",Yx="Shetl.",Jx="Shropsh.",Qx="SIL",Xx="sing.",Zx="S",eg="Soc.",tg="Som.",sg="Sonn.",rg="s.",ng="Span.",ag="Spec.",og="spec.",ig="Spectrosc.",lg="sp.",cg="Staffs.",dg="Stand.",mg="Statist.",ug="St.",hg="str.",pg="Stud.",xg="subj.",gg="subjunct.",fg="subord.",bg="Subscript.",yg="suff.",vg="Suff.",jg="superl.",Ng="Suppress.",wg="Sus.",_g="syll.",Cg="Symmetr.",Sg="Symp.",kg="Syst.",Pg="TAN",Eg="TEL",Ag="Techn.",Ig="Telecomm.",Dg="Telegr.",Fg="t.",zg="Teratol.",Mg="Terrestr.",Rg="Test.",Tg="Textbk.",Lg="Theoret.",Og="Thermonucl.",$g="Thes.",qg="Thess.",Ug="Tim.",Bg="Tit.",Wg="Trag.",Vg="trans.",Hg="Transl.",Gg="Transubstant.",Kg="Treat.",Yg="Treatm.",Jg="Trib.",Qg="Trigonom.",Xg="Trop.",Zg="Troubl.",ef="Typogr.",tf="ult.",sf="Univ.",rf="unkn.",nf="Unnat.",af="Unoffic.",of="unstr.",lf="Urin.",cf="usu.",df="Utilit.",mf="Vac.",uf="Valedict.",hf="var.",pf="vars.",xf="Veg.",gf="Venet.",ff="vb.",bf="vbl.",yf="vbs.",vf="Vertebr.",jf="Vict.",Nf="Va.",wf="Virol.",_f="Vocab.",Cf="Vol.",Sf="Vols.",kf="Vulg.",Pf="Vulg.",Ef="Warwicksh.",Af="wk.",If="Wk.",Df="Wkly.",Ff="w.",zf="west.",Mf="Westm.",Rf="Westmrld.",Tf="WHT",Lf="Will.",Of="Wiltsh.",$f="Wis.",qf="Wisd.",Uf="Wonderf.",Bf="Worcs.",Wf="Wd.",Vf="Wk.",Hf="Wks.",Gf="Yr.",Kf="Yearbk.",Yf="Yrs.",Jf="YLW",Qf="Yorksh.",Xf="Yng.",Zf="Zech.",eb="Zeitschr.",tb="Zeph.",sb="Zoogeogr.",rb={"abbreviation (of)":"abbrev.","abbreviation(s)":"Abbrev.",aberdeen:xr,aberdeenshire:gr,ablative:fr,abolition:br,aboriginal:yr,abridged:vr,abridgement:jr,absolute:Nr,"absolute(ly)":"absol.",abstract:wr,"abstract(s)":"Abstr.","academia, academy, academic(al)":"Acad.",acceptance:_r,accommodation:Cr,accomplished:Sr,"according (to)":"acc.",account:kr,"account(s)":"Acc.",accounts:Pr,accusative:Er,achievement:Ar,"adaptation of":"ad.","addendum, addenda":"Add.","addition(s)":"Addit.",address:Ir,"adjectival phrase":"adj. phr.","adjective, adjectival":"adj.",adjectives:Dr,"administration, administrative":"Admin.",admiral:Fr,admiralty:zr,admonition:Mr,advanced:Rr,"advancement(s)":"Advancem.",advances:Tr,"adventure(s)":"Adv.","adverb, adverbial(ly)":"advb.",adverbs:Lr,advertisement:Or,advertisements:$r,advices:qr,advocate:Ur,aerodynamics:Br,"aeronautics, aeronautical":"Aeronaut.",affairs:Wr,affecting:Vr,"affection(s)":"Affect.","africa(n)":"Afr.",against:Hr,"agriculture, agricultural":"Agric.",alchemy:Gr,algebra:Kr,allegiance:Yr,alliterative:Jr,almanac:Qr,"alphabet, alphabetical":"Alph.",alteration:Xr,"america, american":"Amer.",analysis:Zr,"analytic(al)":"Analyt.","anatomy, anatomical":"Anat.",ancient:en,anecdotes:tn,anglian:sn,"anglo-indian":"Anglo-Ind.","animal(s)":"Anim.","annal(s)":"Ann.",anniversary:rn,"anno domini":"A.D.",annotation:nn,annual:an,anonymous:on,answer:ln,ante:cn,anthropology:dn,"anthropology, anthropological":"Anthropol.",antiquities:mn,"antiquity, antiquities":"Antiq.","aphetic, aphetized":"aphet.","apocalyptic(al)":"Apoc.","apology, apologies":"Apol.",apparently:un,appendix:hn,"application(s)":"Applic.",applied:pn,"appositive(ly)":"appos.",april:xn,arabic:gn,arber:fn,"archaeology, archaeological":"Archaeol.",archaic:bn,archbishop:yn,archipelago:vn,architecture:jn,"architecture, architectural":"Archit.","archive(s)":"Arch.",argument:Nn,arithmetic:wn,"arithmetic, arithmetical":"Arithm.",arrangement:_n,article:Cn,articulation:Sn,artificial:kn,artillery:Pn,ashmole:En,"assembly, assemblies":"Assemb.",association:An,"association football":"Assoc. Football",assyriology:In,astrology:Dn,"astronautics, astronautical":"Astronaut.",astronomy:Fn,"astronomy, astronomic(al)":"Astron.",attic:zn,"attribute(s)":"Attrib.","attributive(ly)":"attrib.",august:Mn,"australia(n)":"Austral.","author(s)":"Auth.","authorized version":"A.V.",autobiography:Rn,"autobiography, autobiographic(al)":"Autobiogr.",ayrshire:Tn,"bacteriology, bacteriologic(al)":"Bacteriol.",bedfordshire:Ln,before:On,"before christ":"B.C.","bel and the dragon":"Bel & Dr.",belgian:$n,berkshire:qn,berwickshire:Un,between:Bn,bibliography:Wn,"biochemistry, biochemical":"Biochem.",biography:Vn,"biography, biographic(al)":"Biogr.","biology, biological":"Biol.",bishop:Hn,black:Gn,blue:Kn,book:Yn,books:Jn,border:Qn,"botany, botanic(al)":"Bot.",brazilian:Xn,"britain, british":"Brit.","british columbia":"B.C.","british national corpus":"BNC",brown:Zn,buckinghamshire:ea,building:ta,bulletin:sa,bureau:ra,calculus:na,calendar:aa,california:oa,calligraphy:ia,cambridge:la,campanology:ca,canadian:da,canterbury:ma,captain:ua,"cartography, cartographic(al)":"Cartogr.",catalogue:ha,catechism:pa,catholic:xa,central:ga,century:fa,ceramics:ba,certificate:ya,chamber:va,character:ja,charles:Na,"chemical engineering":"Chem. Engin.","chemistry, chemical":"Chem.",cheshire:wa,christian:_a,chronicles:Ca,chronology:Sa,"chronology, chronicle":"Chron.",church:ka,"church history":"Ch. Hist.","cinematography, cinematographic(al)":"Cinematogr.",circa:Pa,circle:Ea,"civil engineering":"Civil Engin.","civil law":"Civ. Law",classical:Aa,"classical antiquities":"Class. Antiq.",classification:Ia,clause:Da,climatology:Fa,clinical:za,club:Ma,"cognate with":"cogn. w.","collected, collection":"Coll.",collection:Ra,"collective(ly)":"collect.",college:Ta,"colloquial(ly)":"colloq.",colloquies:La,colonel:Oa,colossians:$a,"combination(s)":"Comb.",combinations:qa,"combining form":"comb. form",commandment:Ua,commendation:Ba,commentary:Wa,"commerce, in commercial usage":"Comm.",commercial:Va,"commercial law":"Comm. Law",commission:Ha,committee:Ga,common:Ka,commonwealth:Ya,"communication(s)":"Communic.",companion:Ja,"companion(s)":"Compan.",company:Qa,comparative:Xa,"comparative anatomy":"Comp. Anat.","compendium, compendious":"Compend.",complement:Za,complete:eo,composition:to,compound:so,"compound, composition":"comp.",concerning:ro,conchology:no,concise:ao,conclusion:oo,"concrete(ly)":"concr.","confer, \\u2018compare\\u2019":"cf.",conference:io,confession:lo,confidential:co,conflict:mo,confutation:uo,congregation:ho,congress:po,congressional:xo,conjugation:go,conjunction:fo,connecticut:bo,conscience:yo,"consecrated, consecration":"Consecr.","consideration(s)":"Consid.",consolation:vo,consonant:jo,"constitution(al)":"Constit.","constitutional history":"Constit. Hist.",construction:No,"construction, construed with":"const.",contemplation:wo,contemporary:_o,"contemptuous(ly)":"contempt.","contending(s)":"Contend.",contention:Co,continuation:So,"contracted, contraction":"contr.",contradiction:ko,"contrasted (with)":"contr.",contribution:Po,controversial:Eo,controversy:Ao,convention:Io,conversation:Do,convocation:Fo,corinthians:zo,cornwall:Mo,coronation:Ro,correspondence:To,"corresponding (to)":"corresp.",council:Lo,count:Oo,"county, counties":"C.",court:$o,courts:qo,courtship:Uo,craniology:Bo,craniometry:Wo,criminal:Vo,"criminal law":"Crim. Law",critical:Ho,criticism:Go,cryptography:Ko,crystallography:Yo,cumberland:Jo,cyclopaedia:Qo,"cytology, cytological":"Cytol.",daniel:Xo,dative:Zo,daughter:ei,debate:ti,december:si,declaration:ri,dedicated:ni,dedication:ai,defence:oi,definite:ii,definition:li,deliverance:ci,demonstration:di,demonstrative:mi,department:ui,depredation:hi,deputy:pi,derbyshire:xi,"derivative (in etymologies)":"deriv.",derogatory:gi,"description, descriptive":"Descr.",deuteronomy:fi,development:bi,devonshire:yi,dialect:vi,dictionary:ji,"difficult, difficulty":"Diffic.",diminutive:Ni,direction:wi,discipline:_i,discourse:Ci,discovery:Si,discrimination:ki,discussion:Pi,"disease(s)":"Dis.",dissertation:Ei,distemper:Ai,distilling:Ii,distribution:Di,district:Fi,"district of columbia":"D.C.",diversity:zi,divinity:Mi,division:Ri,doctrine:Ti,"document(s)":"Doc.",domestic:Li,duke:Oi,durham:$i,dyslogistic:qi,"early english text society":"E.E.T.S.","early old english":"eOE",east:Ui,"east africa(n)":"E. Afr.","east anglia(n)":"E. Angl.","east anglian":"E. Anglian","east indies, east indian":"E. Ind.","east midland (dialect)":"e. midl.","east, eastern":"E.","eastern (dialect)":"east.",ecclesiastes:Bi,ecclesiastical:Wi,"ecclesiastical history":"Eccl. Hist.","ecclesiastical law":"Eccl. Law",ecclesiasticus:Vi,"ecology, ecological":"Ecol.","economics, economic(al)":"Econ.",edinburgh:Hi,edition:Gi,"education, education(al)":"Educ.",electronics:Ki,edward:Yi,egyptian:Ji,egyptology:Qi,"electrical engineering":"Electr. Engin.","electricity, electric(al)":"Electr.","electro-magnetism":"Electro-magn.","electro-physiology":"Electro-physiol.","element(s), elementary":"Elem.",elizabeth:Xi,elizabethan:Zi,"elliptical(ly)":"ellipt.",embassy:el,"embryology, embryologic(al)":"Embryol.","emphatic(ally)":"emph.","encyclopaedia britannica":"Encycl. Brit.","encyclopaedia metropolitana":"Encycl. Metrop.","encyclopaedia, encyclopaedic":"Encycl.",engineering:tl,"england, english":"Eng.","english dialect dictionary":"E.D.D.",englishwomen:sl,enquiry:rl,enthusiasm:nl,"entomology, entomological":"Entomol.",enzymology:al,ephesians:ol,epilogue:il,episcopacy:ll,epistle:cl,epitaph:dl,equipment:ml,"erroneous(ly)":"erron.",esdras:ul,especially:hl,"essay(s)":"Ess.",essential:pl,establishment:xl,esther:gl,ethnology:fl,"etymological(ly)":"etymol.",etymology:bl,"etymology, etymological":"Etymol.","euphemistic(ally)":"euphem.",evaluation:yl,evangelical:vl,evening:jl,evidence:Nl,"evolution, evolutionary":"Evol.",exaltation:wl,examination:_l,except:Cl,exchange:Sl,exchequer:kl,execution:Pl,executive:El,"executive document":"Ex. doc.","exercise(s)":"Exerc.","exhibition, exhibit(s)":"Exhib.",exodus:Al,expedition:Il,"experiment, experimental":"Exper.",explanation:Dl,explication:Fl,exploration:zl,"exposition, expository":"Expos.","extra large":"XL","extra small":"XS",ezekiel:Ml,"fable(s)":"Fab.","familiar(ly)":"famil.",family:Rl,farewell:Tl,father:Ll,february:Ol,feminine:$l,fifeshire:ql,"figurative(ly)":"fig.","floruit, \\u2018flourished\\u2019":"fl.",folio:Ul,folios:Bl,footprint:Wl,forfarshire:Vl,fortification:Hl,fortnightly:Gl,"foundation(s)":"Found.","fragment(s)":"Fragm.",fraternity:Kl,french:Yl,frequently:Jl,friendship:Ql,from:Xl,"fundamental(s)":"Fund.",furniture:Zl,future:ec,galatians:tc,"garden, gardening":"Gard.",gastronomy:sc,gazette:rc,general:nc,"general(ly)":"gen.",genesis:ac,genitive:oc,geography:ic,"geography, geographic(al)":"Geogr.","geology, geologic(al)":"Geol.","geometry, geometric(al)":"Geom.",geomorphology:lc,george:cc,german:dc,gerundial:mc,"glacier(s)":"Glac.",glasgow:uc,glossary:hc,gloucestershire:pc,gold:xc,good:gc,"gospel(s)":"Gosp.",government:fc,grammar:bc,"grammatical analysis":"Gramm. Analysis",gray:yc,great:vc,green:jc,grey:Nc,gynaecology:wc,habakkuk:_c,haematology:Cc,haggai:Sc,hammer:kc,hampshire:Pc,handbook:Ec,hardware:Ac,hebrew:Ic,headphones:Dc,hebrews:Fc,henry:zc,heraldry:Mc,herbalism:Rc,herefordshire:Tc,hertfordshire:Lc,hieroglyphic:Oc,"histology, histologic(al)":"Histol.",historical:$c,"history, historic(al)":"Hist.",homilies:qc,horology:Uc,"horticulture, horticultural":"Hort.",hosea:Bc,hospital:Wc,household:Vc,housekeeping:Hc,husbandry:Gc,hydraulic:Kc,"hydrology, hydrological":"Hydrol.",ichthyology:Yc,icthyology:Jc,"ideology, ideological":"Ideol.",idolatry:Qc,"illustrated, illustration(s)":"Illustr.","imaginary, imagination":"Imag.",imitative:Xc,immunology:Zc,imperative:ed,imperfect:td,impersonal:sd,"impression(s)":"Impr.",imprint:rd,"improper(ly)":"improp.",improved:nd,inaugural:ad,inclosure:od,indefinite:id,"india(n)":"Ind.",indicative:ld,indirect:cd,industrial:dd,"industrial relations":"Industr. Rel.",industry:md,infinitive:ud,influence:hd,influenced:pd,"innocence, innocent":"Innoc.",inorganic:xd,inquiry:gd,"institute, institution":"Inst.",instruction:fd,instrumental:bd,intellectual:yd,"intelligence, intelligent":"Intell.",intercourse:vd,interjection:jd,interlude:Nd,international:wd,interpretation:_d,interrogative:Cd,intransitive:Sd,introduction:kd,"introduction, introductory":"Introd.","invention(s)":"Invent.","inventory, inventories":"Invent.","invertebrate zoology":"Invert. Zool.","invertebrate, invertebrated":"Invertebr.",investigation:Pd,investment:Ed,invocation:Ad,ireland:Id,irish:Dd,ironically:Fd,"irregular(ly)":"irreg.",isaiah:zd,italian:Md,jahrbuch:Rd,james:Td,jamieson:Ld,january:Od,japanese:$d,jeremiah:qd,"jocular(ly)":"joc.",joshua:Ud,journal:Bd,journals:Wd,judges:Vd,july:Hd,june:Gd,junior:Kd,jurisdiction:Yd,jurisprudence:Jd,justification:Qd,keeper:Xd,kentish:Zd,king:em,"king\\u2019s bench division":"King\\u2019s Bench Div.",kingdom:tm,kings:sm,knowledge:rm,laboratory:nm,lamentation:am,lamentations:om,lancashire:im,language:lm,languages:cm,large:dm,"late old english":"lOE",latin:mm,lavender:um,"lecture(s)":"Lect.",leechdom:hm,"legend(s)":"Leg.",leicestershire:pm,letter:xm,letters:gm,leviticus:fm,lexicon:bm,library:ym,limnology:vm,lincolnshire:jm,line:Nm,lines:wm,"linguistic(s)":"Ling.",linnean:_m,"literal(ly)":"lit.","literary, literature":"Lit.",lithography:Cm,lithology:Sm,liturgy:km,london:Pm,lord:Em,lords:Am,maccabees:Im,"machinery, machine(s)":"Mach.",magazine:Dm,"magnetism, magnetic":"Magn.",malachi:Fm,management:zm,manchester:Mm,manipulation:Rm,manual:Tm,"manufacturing, manufacture(s)":"Manuf.",manuscript:Lm,manuscripts:Om,march:$m,maroon:qm,masculine:Um,massachussets:Bm,"mathematics, mathematical":"Math.",matthew:Wm,measure:Vm,measurement:Hm,"mechanics, mechanical":"Mech.","medicine, medical":"Med.",medieval:Gm,meditation:Km,medium:Ym,meeting:Jm,"memoir(s)":"Mem.","merchant(s)":"Merch.",mercury:Qm,metalliferous:Xm,metallography:Zm,"metallography, metallographic(al)":"Metallogr.",metallurgy:eu,metamorphosis:tu,"metaphorical(ly)":"metaphor.",metaphysics:su,"meteorology, meteorologic(al)":"Meteorol.","method(s)":"Meth.","metri gratia":"metr. gr.","metropolitan, metropolis":"Metrop.",mexican:ru,micah:nu,michigan:au,microbiology:ou,"microscopic(al)":"Microsc.","midland(s) (dialect)":"midl.",military:iu,mineralogy:lu,"mineralogy, minaralogic(al)":"Mineral.","miscellaneous, miscellany":"Misc.",miscellany:cu,misprinted:du,modern:mu,monument:uu,morphology:hu,"mount(ain)":"Mt.",mountains:pu,municipal:xu,munificence:gu,muniment:fu,museum:bu,"music, musical":"Mus.",mystery:yu,mythology:vu,nahum:ju,narrative:Nu,natural:wu,"natural history":"Nat. Hist.","natural philosophy":"Nat. Philos.","natural science":"Nat. Sci.",nautical:_u,naval:Cu,navigation:Su,navy:ku,nehemiah:Pu,"neighbour(s), neighbourhood":"Neighb.",nervous:Eu,"neurology, neurologic(al)":"Neurol.",neurosurgery:Au,neuter:Iu,"new english dictionary":"N.E.D.","new hampshire":"New Hampsh.","new south wales":"N.S.W.","new testament":"N.T.","new york":"N.Y.","new zealand":"N.Z.",newcastle:Du,newsprint:Fu,nominative:zu,"nonce-word":"nonce-wd.","nonconformist(s)":"Nonconf.",norfolk:Mu,north:Ru,"north africa(n)":"N. Afr.","north america(n)":"N. Amer.","north carolina":"N. Carolina","north dakota":"N. Dakota","north, northern":"N.","north-east, north-eastern":"N.E.","north-eastern (dialect)":"n.e.","north-west, north-western":"N.W.","north-western (dialect)":"n.w.",northamptonshire:Tu,"northern (dialect)":"north.","northern ireland":"N. Irel.","northern irish":"N. Ir.",northumberland:Lu,"northumberland, northumbrian":"Northumb.",northumbrian:Ou,norwegian:$u,nottinghamshire:qu,noun:Uu,nouns:Bu,november:Wu,nuclear:Vu,number:Hu,numbers:Gu,numismatics:Ku,obadiah:Yu,obedience:Ju,"object(s)":"Obj.","object, objective":"obj.",oblique:Qu,"observation(s)":"Observ.",obsolete:Xu,"obstetric medicine":"Obstetr. Med.","obstetric(s)":"Obstetr.",occasional:Zu,occasionally:eh,"occupation(al)":"Occup.",occurrence:th,"oceanography, oceanographic(al)":"Oceanogr.",october:sh,official:rh,"official, office":"Off.",oklahoma:nh,"old english":"OE","old testament":"O.T.",olive:ah,ontario:oh,ophthalmology:ih,"ophthalmology, ophtalmologic(al)":"Ophthalmol.","opposed (to), the opposite (of)":"opp.",oppression:lh,optics:ch,"oracle(s)":"Orac.",orange:dh,"order(s)":"Ord.","ordinance(s)":"Ord.",organic:mh,"organic chemistry":"Org. Chem.","origin(al)(ly)":"orig.",original:uh,orkney:hh,ornithology:ph,"ornithology, ornithologic(al)":"Ornithol.",orthography:xh,outline:gh,oxford:fh,"oxford english dictionary":"O.E.D.",oxfordshire:bh,page:yh,palaeobotany:vh,palaeography:jh,palaeontology:Nh,"palaeontology, palaeontologic(al)":"Palaeontol.","paraphrase, paraphrased":"Paraphr.",parasitology:wh,"parliament, parliamentary":"Parl.",parnassus:_h,part:Ch,participial:Sh,"participial adjective":"ppl. adj.","participial adjectives":"ppl. adjs.",participle:kh,participles:Ph,"passive participle, past participle":"pa. pple.","passive(ly)":"pass.",past:Eh,"past tense":"pa. t.","pathology, pathologic(al)":"Pathol.","peculation(s)":"Peculat.",peninsula:Ah,pennsylvania:Ih,perfect:Dh,"perfect, perfection":"Perf.",perhaps:Fh,"periodontology, periodontologic(al)":"Periodontol.","persecution(s)":"Persec.",persian:zh,"person(al)":"pers.",personal:Mh,personified:Rh,perthshire:Th,peter:Lh,"petrography, petrographic(al)":"Petrogr.","petrology, petrologic(al)":"Petrol.",pharmaceutical:Oh,pharmacology:$h,"pharmacology, pharmacological":"Pharmacol.",philadelphia:qh,philemon:Uh,philippians:Bh,"philology, philologic(al)":"Philol.","philosophy, philosophic(al)":"Philos.",phoenician:Wh,"phonetic(ally)":"phonet.",phonology:Vh,photography:Hh,"photography, photographic(al)":"Photogr.",phrase:Gh,phrenology:Kh,"physical chemistry":"Physical Chem.","physical geography":"Physical Geogr.",physiography:Yh,physiology:Jh,"physiology, physiologic(al)":"Physiol.",pictorial:Qh,"picture(s)":"Pict.",pink:Xh,plural:Zh,"poetic(al)":"poet.",poetical:ep,"political economy":"Pol. Econ.","politics, political":"Polit.","polytechnic(al)":"Polytechn.",popular:tp,"popular(ly)":"pop.",porcelain:sp,portuguese:rp,possessive:np,"possible, possibly":"poss.","posthumous(ly)":"Posth.",postmaster:ap,pottery:op,practical:ip,practice:lp,preceding:cp,predicate:dp,"predicate, predicative(ly)":"predic.",prediction:mp,preface:up,prefix:hp,prehistoric:pp,"prehistory, prehistoric":"Prehist.","preposition(al)":"prep.",prerogative:xp,presbyterian:gp,presbytery:fp,present:bp,"present participle":"pr. pple.",preservation:yp,"primer(s)":"Prim.","principle(s)":"Princ.",printing:vp,privative:jp,"probability, probabilities":"Probab.",probably:Np,problem:wp,proceedings:_p,"product(s)":"Prod.",prologue:Cp,pronoun:Sp,pronunciation:kp,properly:Pp,"property, properties":"Prop.",proprietary:Ep,prosody:Ap,proverb:Ip,"proverb(ial)(ly)":"prov.",proverbs:Dp,"providence(s)":"Provid.",provincial:Fp,provisional:zp,psalms:Mp,"pseudo-archaic":"pseudo-arch.","pseudo-dialect":"pseudo-dial.","pseudo-scots":"pseudo-Sc.",psychoanalysis:Rp,psychoanalytic:Tp,psychology:Lp,"psychology, psychologic(al)":"Psychol.","psychopathology, psychopathologic(al)":"Psychopathol.",public:"Publ.","public records":"P. R.",publication:Op,purgatory:$p,purple:qp,"quantum mechanics":"Quantum Mech.",quarterly:Up,queen:Bp,"queen elizabeth":"Q. Eliz.","queen\\u2019s bench division":"Queen\\u2019s Bench Div.",queensland:Wp,"quod vide, \\u2018which see\\u2019":"q.v.",quotation:Vp,quotations:Hp,radiology:Gp,"reason(s)":"Reas.",rebellion:Kp,reclamation:Yp,recollection:Jp,"record(s)":"Rec.",red:Qp,redemption:Xp,reduplicating:Zp,"refashioned, refashioning":"refash.",reference:ex,"reflection(s)":"Refl.",reflexive:tx,reformation:sx,refusal:rx,refutation:nx,regicide:ax,register:ox,regular:ix,related:lx,relating:cx,relative:dx,"religion, religious":"Relig.","reminiscence(s)":"Reminisc.",remonstrance:mx,renfrewshire:ux,report:hx,"representative, representing":"repr.","reproduction, reproductive":"Reprod.",republic:px,research:xx,"residence, residential":"Resid.",retrospective:gx,return:"Ret.",revelation:fx,review:bx,revised:yx,revolution:vx,rhetoric:jx,"rhetorical(ly)":"rhet.","rhode island":"Rhode Isl.",richard:Nx,roman:wx,"roman antiquities":"Rom. Antiq.","roman catholic church":"R.C. Church","roman catholic(ism)":"R.C.",romans:_x,"ross-shire":"Ross-sh.",roxburgh:Cx,royal:Sx,"royal air force":"R.A.F.","royal navy":"R.N.","rudiment(s)":"Rudim.","russia, russian":"Russ.",saint:kx,saints:Px,samuel:Ex,saskatchewan:Ax,saturday:Ix,saxon:Dx,"scandinavia, scandinavian":"Scand.",school:Fx,"science(s), scientific":"Sci.","scilicet, \\u2018understand\\u2019 or \\u2018supply\\u2019":"sc.",scotland:zx,scottish:Mx,"scottish text society":"S.T.S.","scottish, scots":"Sc.",scripture:Rx,sculpture:Tx,seismology:Lx,"select committee":"Sel. comm.",selected:Ox,selection:$x,september:qx,septuagint:Ux,series:Bx,"sermon(s)":"Serm.",session:Wx,settlement:Vx,several:Hx,shakespeare:Gx,shepherd:Kx,shetland:Yx,shropshire:Jx,silver:Qx,singular:Xx,small:Zx,society:eg,"sociology, sociological":"Sociol.",somerset:tg,"song of solomon":"Song Sol.",sonnet:sg,south:rg,"south africa(n)":"S. Afr.","south carolina":"S. Carolina","south dakota":"S. Dakota","south, southern":"S.","south-east, south-eastern":"S.E.","south-eastern (dialect)":"s.e.","south-west, south-western":"S.W.","south-western (dialect)":"s.w.","southern (dialect)":"south.",spanish:ng,special:ag,specifically:og,"specification(s)":"Specif.","specimen(s)":"Specim.",spectroscopy:ig,spelling:lg,staffordshire:cg,standard:dg,statistical:mg,"stock exchange":"Stock Exch.","stratigraphy, stratigraphical":"Stratigr.",street:ug,strong:hg,"structure, structural":"Struct.",studies:pg,"sub verbo, \\u2018under the word\\u2019":"s.v.",subject:xg,"subject(s)":"Subj.",subjunctive:gg,subordinate:fg,"subordinate clause":"subord. cl.",subscription:bg,"subsequent(ly)":"subseq.","substantive(ly)":"subst.",suffix:yg,suffolk:vg,superlative:jg,"supplement, supplementary":"Suppl.","supplication(s)":"Supplic.",suppression:Ng,"surgery, surgical":"Surg.","survey, surveying":"Surv.",susanna:wg,syllable:_g,symmetrical:Cg,symposium:Sg,system:kg,tan:Pg,"taxonomy, taxonomic":"Taxon.",teal:Eg,technical:Ag,"technology, technological":"Technol.",telecommunications:Ig,telegraph:Dg,"telegraphy, telegraphic(al)":"Telegr.","telephony, telephonic":"Teleph.",tense:Fg,teratology:zg,"terminology, terminological":"Terminol.",terrestrial:Mg,testament:Rg,textbook:Tg,"theatre, theatrical":"Theatr.","theology, theological":"Theol.",theoretical:Lg,thermonuclear:Og,thesaurus:$g,thessalonians:qg,timothy:Ug,titus:Bg,"topography, topographic(al)":"Topogr.","tradition, traditional":"Trad.",tragedy:Wg,"transaction(s)":"Trans.","transferred sense":"transf.",transitive:Vg,translation:Hg,"translation, translating":"transl.",transubstantiation:Gg,"travel(s)":"Trav.","treasurer, treasury":"Treas.",treatise:Kg,treatment:Yg,tribune:Jg,trigonometry:Qg,tropical:Xg,troublesome:Zg,typography:ef,ultimately:tf,"union of soviet socialist republics":"U.S.S.R.","united kingdom":"U.K.","united states":"U.S.","united states air force":"U.S.A.F.",university:sf,unknown:rf,unnatural:nf,unofficial:af,unstressed:of,urinary:lf,usually:cf,utilitarian:df,vacation:mf,valediction:uf,variant:hf,"variant reading":"v.r.","variant readings":"v.rr.",variants:pf,vegetable:xf,"vegetable physiology":"Veg. Physiol.",venetian:gf,verb:ff,verbal:bf,"verbal noun":"vbl.n.","verbal nouns":"vbl. ns.",verbs:yf,vertebrate:vf,"veterinary medicine":"Vet. Med.","veterinary pathology":"Vet. Path.","veterinary science":"Vet. Sci.","veterinary surgery":"Vet. Surg.","veterinary, veterinary science":"Vet.",victoria:jf,"videlicet, \\u2018namely\\u2019":"viz.","vindication, vindicated":"Vindic.","virgin(s)":"Virg.",virginia:Nf,virology:wf,vocabulary:_f,volume:Cf,volumes:Sf,"voyage(s)":"Voy.",vulgar:kf,"vulgar(ly)":"vulg.",vulgate:Pf,warwickshire:Ef,weak:Af,week:If,weekly:Df,west:Ff,"west africa(n)":"W. Afr.","west indies":"W. Indies","west indies, west indian":"W. Ind.","west virginia":"W. Va.","west, western":"W.",western:zf,westminster:Mf,westmoreland:Rf,white:Tf,william:Lf,wiltshire:Of,wisconsin:$f,wisdom:qf,"wisdom of solomon":"Wisd.",wonderful:Uf,worcestershire:Bf,word:Wf,work:Vf,works:Hf,"writing(s)":"Writ.",year:Gf,yearbook:Kf,years:Yf,yellow:Jf,yorkshire:Qf,young:Xf,zechariah:Zf,zeitschrift:eb,zephaniah:tb,zoogeography:sb,"zoology, zoological":"Zool."},We=rb;function be(t){if(!t)return"";const a=t.trim().toLowerCase();if(We[a])return We[a].replace(/\./g,"").toUpperCase();const s=a.replace(/[^a-z0-9]/g,""),n=s[0].toUpperCase(),l=s.slice(1).toUpperCase().replace(/[AEIOU]/g,"");let m="";for(let u=0;u<l.length;u++)(u===0||l[u]!==l[u-1])&&(m+=l[u]);return(n+m).substring(0,3)}function ct(t,a,s,n){const r=(t||"").split(">").map(v=>v.trim()),m=(r.length>0?r[r.length-1]:"").split(" ")[0]||"",u=be(m),i=be(a||""),c=(s||"").split(" ")[0]||"",p=be(c),_=n?be(n):"",x=[u,i,p];return _&&x.push(_),x.filter(v=>v.length>0).join("-")}async function ze(t,a){if(!t)return!1;let s=k.from("products").select("id").eq("sku",t);a&&(s=s.neq("id",a));const{data:n,error:r}=await s;if(r)throw console.error("Error checking SKU existence:",r),r;return n&&n.length>0}async function dt(t){if(!t)return"";let a=t,s=1;const n=t.match(/^(.*)-(\d+)$/);n&&(a=n[1],s=parseInt(n[2],10)+1);const r=(m,u)=>`${m}-${u.toString().padStart(3,"0")}`;let l=r(a,s);for(;await ze(l)&&(s++,l=r(a,s),!(s>1e3)););return l}function nb({product:t,isOpen:a,onClose:s,onSave:n}){const[r,l]=d.useState({name:"",description:"",price:0,category:"",image:"",images:[],on_hand:0,cost:0,sku:"",variant:"",brand:"",weight:0,gtin:"",mpn:"",condition:"new",product_type:"",tags:[],status:"draft"}),[m,u]=d.useState(!1),[i,c]=d.useState(null),[p,_]=d.useState(null);d.useEffect(()=>{l(t||{name:"",description:"",price:0,category:"",image:"",images:[],on_hand:0,cost:0,sku:"",variant:"",brand:"",weight:0,gtin:"",mpn:"",condition:"new",product_type:"",tags:[],status:"draft"}),c(null),_(null),v(10)},[t,a]);const[x,v]=d.useState(10),f=et.filter(b=>b.toLowerCase().includes((r.category||"").toLowerCase())).slice(0,x),N=b=>{const{scrollTop:j,clientHeight:o,scrollHeight:w}=b.currentTarget;w-j<=o+20&&v(C=>C+10)},h=()=>{const b=ct(r.category||"",r.brand||"",r.name||"",r.variant||"");l(j=>({...j,sku:b}))};if(!a)return null;const y=async b=>{b.preventDefault(),u(!0),c(null),_(null);try{if(r.sku){const j=t?.id;if(await ze(r.sku,j)){const w=await dt(r.sku);throw _(w),new Error(`SKU "${r.sku}" already exists.`)}}if(t&&t.id){const{error:j}=await k.from("products").update(r).eq("id",t.id);if(j)throw j}else{const{error:j}=await k.from("products").insert([r]);if(j)throw j}n(),s()}catch(j){F.error("Error saving product:",j);const o=j instanceof Error?j.message:"Failed to save product";c(o)}finally{u(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-card w-full max-w-lg rounded-lg shadow-lg border border-border flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-border",children:[e.jsx("h2",{className:"text-xl font-semibold",children:t?"Edit Product":"Add New Product"}),e.jsx("button",{onClick:s,className:"text-muted-foreground hover:text-foreground transition-colors",children:e.jsx(K,{size:20})})]}),e.jsxs("form",{onSubmit:y,className:"p-6 overflow-y-auto flex-1 space-y-6",children:[i&&e.jsxs("div",{className:"bg-destructive/10 text-destructive text-sm p-3 rounded-md",children:[e.jsx("p",{children:i}),p&&e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsxs("span",{children:["Suggestion: ",e.jsx("span",{className:"font-mono font-bold",children:p})]}),e.jsx("button",{type:"button",onClick:()=>{l({...r,sku:p}),c(null),_(null)},className:"text-xs bg-background/50 hover:bg-background px-2 py-1 rounded border border-destructive/20 ml-auto",children:"Use This"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Name"}),e.jsx("input",{type:"text",required:!0,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.name||"",onChange:b=>l({...r,name:b.target.value})})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx("textarea",{required:!0,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.description||"",onChange:b=>l({...r,description:b.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Price ($)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",required:!0,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.price||0,onChange:b=>l({...r,price:parseFloat(b.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Cost ($)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.cost||0,onChange:b=>l({...r,cost:parseFloat(b.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Stock (On Hand)"}),e.jsx("input",{type:"number",min:"0",required:!0,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.on_hand||0,onChange:b=>l({...r,on_hand:parseInt(b.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"SKU"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring font-mono",value:r.sku||"",onChange:b=>l({...r,sku:b.target.value}),placeholder:"Auto-generated"}),e.jsx("button",{type:"button",onClick:h,className:"px-3 py-2 bg-secondary text-secondary-foreground rounded-md text-xs font-medium hover:bg-secondary/80 whitespace-nowrap",title:"Generate SKU from attributes",children:"Generate"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Variant"}),e.jsx("input",{type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.variant||"",onChange:b=>l({...r,variant:b.target.value}),placeholder:"e.g. Red, XL, 500GB"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Brand"}),e.jsx("input",{type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.brand||"",onChange:b=>l({...r,brand:b.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Weight (lb)"}),e.jsx("input",{type:"number",step:"0.01",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.weight||0,onChange:b=>l({...r,weight:parseFloat(b.target.value)})})]})]}),e.jsxs("div",{className:"space-y-2 relative group",children:[e.jsx("label",{className:"text-sm font-medium",children:"Category"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",required:!0,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.category||"",onChange:b=>{l({...r,category:b.target.value}),v(10)},placeholder:"Start typing to search categories..."}),f.length>0&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-popover border border-border rounded-md shadow-lg max-h-60 overflow-y-auto hidden group-focus-within:block",onScroll:N,children:f.map(b=>e.jsx("button",{type:"button",className:"w-full text-left px-3 py-2 text-sm hover:bg-accent hover:text-accent-foreground truncate block",title:b,onClick:()=>l({...r,category:b}),onMouseDown:j=>j.preventDefault(),children:b},b))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Status"}),e.jsxs("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.status||"draft",onChange:b=>l({...r,status:b.target.value}),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Barcode / GTIN / UPC"}),e.jsx("input",{type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.gtin||"",onChange:b=>l({...r,gtin:b.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"MPN"}),e.jsx("input",{type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.mpn||"",onChange:b=>l({...r,mpn:b.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Condition"}),e.jsxs("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.condition||"new",onChange:b=>l({...r,condition:b.target.value}),children:[e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"used",children:"Used"}),e.jsx("option",{value:"refurbished",children:"Refurbished"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Product Type"}),e.jsx("input",{type:"text",placeholder:"e.g. Physical, Digital",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.product_type||"",onChange:b=>l({...r,product_type:b.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Image URLs (one per line)"}),e.jsx("textarea",{className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.images?.join(`
`)||"",onChange:b=>{const o=b.target.value.split(`
`).map(w=>w.trim()).filter(Boolean);l({...r,images:o,image:o[0]||""})},placeholder:`https://example.com/image1.jpg
https://example.com/image2.jpg`}),r.images&&r.images.length>0&&e.jsx("div",{className:"flex gap-2 overflow-x-auto py-2",children:r.images.map((b,j)=>e.jsx("div",{className:"relative w-16 h-16 shrink-0 rounded border overflow-hidden",children:e.jsx("img",{src:J(b),alt:"",className:"w-full h-full object-cover"})},j))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Tags (comma separated)"}),e.jsx("input",{type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",value:r.tags?.join(", ")||"",onChange:b=>{const o=b.target.value.split(",").map(w=>w.trim()).filter(Boolean);l({...r,tags:o})},placeholder:"summer, sale, featured"})]})]}),e.jsxs("div",{className:"p-6 border-t border-border flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:s,disabled:m,className:"px-4 py-2 text-sm font-medium text-muted-foreground hover:text-foreground transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:y,disabled:m,className:"px-4 py-2 text-sm font-medium bg-primary text-primary-foreground rounded-md hovered:bg-primary/90 transition-colors flex items-center gap-2",children:[m&&e.jsx(ye,{size:16,className:"animate-spin"}),t?"Update Product":"Create Product"]})]})]})})}const ab=({product:t})=>{const[a,s]=d.useState(0),[n,r]=d.useState(!1),l=[...t.images||[],t.image].filter(Boolean),m=l.map(i=>J(i));if(l.length===0)return e.jsx("img",{src:"/open-e-commerce/logo.png",alt:t.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"});const u=()=>{a<l.length-1?s(i=>i+1):r(!0)};return e.jsx("img",{src:n?"/open-e-commerce/logo.png":m[a],alt:t.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",onError:u})};function ob(){const[t,a]=d.useState([]),[s,n]=d.useState(!0),[r,l]=d.useState(""),[m,u]=d.useState(null),[i,c]=d.useState(!1),[p,_]=d.useState([]),[x,v]=d.useState([]),[f,N]=d.useState([]),h=async()=>{try{const{data:g,error:L}=await k.from("products").select("*").order("name",{ascending:!0});if(L)throw L;a(g||[])}catch(g){F.error("Error fetching inventory:",g)}finally{n(!1)}};d.useEffect(()=>{h()},[]);const y=async(g,L)=>{if(confirm(`Are you sure you want to delete "${L}"? This action cannot be undone.`))try{const{error:R}=await k.from("products").delete().eq("id",g);if(R){if(R.code==="23503"&&confirm(`"${L}" cannot be deleted because it is in existing orders. Would you like to archive (deactivate) it instead?`)){const{error:B}=await k.from("products").update({status:"archived"}).eq("id",g);if(B)throw B;h();return}throw R}h()}catch(R){F.error("Error deleting product:",R);const B=R instanceof Error?R.message:"Failed to delete product. Please try again.";alert(B)}},b=async(g,L)=>{const R=g.on_hand+L;if(!(R<0)){a(t.map(B=>B.id===g.id?{...B,on_hand:R}:B));try{const{error:B}=await k.from("products").update({on_hand:R}).eq("id",g.id);if(B)throw B}catch(B){F.error("Error updating stock:",B),a(t.map(E=>E.id===g.id?{...E,on_hand:g.on_hand}:E)),alert("Failed to update stock")}}},j=g=>t.filter(L=>{const R=L.name.toLowerCase().includes(r.toLowerCase())||L.category.toLowerCase().includes(r.toLowerCase()),B=g==="status"||p.length===0||p.includes(L.status),E=g==="type"||x.length===0||x.includes(L.product_type||""),P=g==="tag"||f.length===0||L.tags&&L.tags.some(z=>f.includes(z));return R&&B&&E&&P}),o=Array.from(new Set(j("status").map(g=>g.status))),w=Array.from(new Set(j("type").map(g=>g.product_type||"").filter(Boolean))),C=Array.from(new Set(j("tag").flatMap(g=>g.tags||[]))),I=j(null),{items:U,requestSort:M,sortConfig:T}=Fe(I,{key:"name",direction:"ascending"},{image:g=>g.images?.[0]||g.image||"",images_count:g=>g.images?.length||0,tags_string:g=>g.tags?.join(", ")||""}),A=(g,L,R)=>{R&&R!=="all"&&!g.includes(R)&&L([...g,R])},S=(g,L,R)=>{L(g.filter(B=>B!==R))},D=()=>{u(null),c(!0)},O=()=>{const g=U.map(P=>({id:P.id,name:P.name,sku:P.sku,variant:P.variant,category:P.category,price:P.price,cost:P.cost,on_hand:P.on_hand,brand:P.brand,description:P.description,status:P.status,image:P.image||P.images?.[0]||"",images:P.images?.join("|"),weight:P.weight,gtin:P.gtin,mpn:P.mpn,condition:P.condition,product_type:P.product_type,tags:P.tags?.join("|")})),L=Le.unparse(g),R=new Blob([L],{type:"text/csv;charset=utf-8;"}),B=URL.createObjectURL(R),E=document.createElement("a");E.setAttribute("href",B),E.setAttribute("download",`inventory_export_${new Date().toISOString().split("T")[0]}.csv`),E.style.visibility="hidden",document.body.appendChild(E),E.click(),document.body.removeChild(E)},Y=async g=>{const L=g.target.files?.[0];L&&(n(!0),Le.parse(L,{header:!0,skipEmptyLines:!0,complete:async R=>{const B=R.data;let E=0,P=0;for(const z of B)try{if(!z.name||!z.price){console.warn("Skipping invalid row:",z),P++;continue}const H={name:z.name,sku:z.sku||void 0,variant:z.variant||void 0,category:z.category||"",price:parseFloat(z.price),cost:z.cost?parseFloat(z.cost):void 0,on_hand:z.on_hand?parseInt(z.on_hand):0,brand:z.brand||void 0,description:z.description||"",status:z.status||"draft",image:z.image||void 0,images:z.images?z.images.split("|"):[],weight:z.weight?parseFloat(z.weight):void 0,gtin:z.gtin||void 0,mpn:z.mpn||void 0,condition:z.condition||"new",product_type:z.product_type||void 0,tags:z.tags?z.tags.split("|"):[]};let V=null;if(H.sku){const{data:W}=await k.from("products").select("id").eq("sku",H.sku).single();V=W}if(V){const{error:W}=await k.from("products").update(H).eq("id",V.id);if(W)throw W}else{const{error:W}=await k.from("products").insert([H]);if(W)throw W}E++}catch(H){console.error("Error importing row:",z,H),P++}alert(`Import complete.
Success: ${E}
Failed: ${P}`),h(),n(!1),g.target.value=""},error:R=>{console.error("CSV Parse Error:",R),alert("Failed to parse CSV file."),n(!1)}}))};return s?e.jsx("div",{className:"p-8 text-center",children:"Loading inventory..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(se,{title:"Inventory Management",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center w-full sm:w-auto",children:[e.jsxs("div",{className:"relative w-full sm:w-72",children:[e.jsx(Je,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",size:18}),e.jsx("input",{type:"text",placeholder:"Search products...",className:"input pl-10",value:r,onChange:g=>l(g.target.value)})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:".csv",onChange:Y,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",title:"Import CSV"}),e.jsxs("button",{className:"px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/90 transition-colors flex items-center justify-center gap-2 font-medium w-full",children:[e.jsx(Rt,{size:18}),"Import"]})]}),e.jsxs("button",{onClick:O,className:"px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/90 transition-colors flex items-center justify-center gap-2 font-medium",children:[e.jsx(Tt,{size:18}),"Export"]}),e.jsxs("button",{onClick:D,className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors flex items-center justify-center gap-2 font-medium flex-1 sm:flex-none",children:[e.jsx(Se,{size:18}),"Add Product"]})]})]})}),e.jsxs("div",{className:"filter-section",children:[e.jsxs("div",{className:"space-y-2 w-full sm:flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsxs("select",{className:"input",value:"",onChange:g=>A(p,_,g.target.value),children:[e.jsx("option",{value:"",children:"Select Status..."}),["active","inactive","draft","archived"].filter(g=>o.includes(g)||p.includes(g)).map(g=>e.jsx("option",{value:g,className:"capitalize",children:g},g))]}),p.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(g=>e.jsxs("div",{onClick:()=>S(p,_,g),className:"filter-chip group",children:[e.jsx("span",{className:"capitalize",children:g}),e.jsx(K,{size:14,className:"opacity-50 group-hover:opacity-100"})]},g))})]}),e.jsxs("div",{className:"space-y-2 w-full sm:flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Type"}),e.jsxs("select",{className:"input",value:"",onChange:g=>A(x,v,g.target.value),children:[e.jsx("option",{value:"",children:"Select Type..."}),w.map(g=>e.jsx("option",{value:g,children:g},g))]}),x.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:x.map(g=>e.jsxs("div",{onClick:()=>S(x,v,g),className:"filter-chip group",children:[g,e.jsx(K,{size:14,className:"opacity-50 group-hover:opacity-100"})]},g))})]}),e.jsxs("div",{className:"space-y-2 w-full sm:flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Tag"}),e.jsxs("select",{className:"input",value:"",onChange:g=>A(f,N,g.target.value),children:[e.jsx("option",{value:"",children:"Select Tag..."}),C.map(g=>e.jsx("option",{value:g,children:g},g))]}),f.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(g=>e.jsxs("div",{onClick:()=>S(f,N,g),className:"filter-chip group",children:[g,e.jsx(K,{size:14,className:"opacity-50 group-hover:opacity-100"})]},g))})]}),e.jsx("button",{onClick:()=>{_([]),v([]),N([]),l("")},className:"btn btn-primary h-[38px] whitespace-nowrap shrink-0 mt-[28px]",children:"Clear Filters"})]}),e.jsx("div",{className:"rounded-lg border border-border overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-max",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{className:"border-b border-border",children:[e.jsx($,{label:"Image",sortKey:"image",onSort:M,currentSort:T}),e.jsx($,{label:"Title",sortKey:"name",onSort:M,currentSort:T}),e.jsx($,{label:"Description",sortKey:"description",onSort:M,currentSort:T}),e.jsx($,{label:"Images",sortKey:"images_count",onSort:M,currentSort:T,align:"center"}),e.jsx($,{label:"Category",sortKey:"category",onSort:M,currentSort:T}),e.jsx($,{label:"Brand",sortKey:"brand",onSort:M,currentSort:T}),e.jsx($,{label:"Price",sortKey:"price",onSort:M,currentSort:T,align:"right"}),e.jsx($,{label:"Cost",sortKey:"cost",onSort:M,currentSort:T,align:"right"}),e.jsx($,{label:"Stock",sortKey:"on_hand",onSort:M,currentSort:T,align:"center"}),e.jsx($,{label:"SKU",sortKey:"sku",onSort:M,currentSort:T}),e.jsx($,{label:"Variant",sortKey:"variant",onSort:M,currentSort:T}),e.jsx($,{label:"GTIN",sortKey:"gtin",onSort:M,currentSort:T}),e.jsx($,{label:"MPN",sortKey:"mpn",onSort:M,currentSort:T}),e.jsx($,{label:"Weight",sortKey:"weight",onSort:M,currentSort:T}),e.jsx($,{label:"Condition",sortKey:"condition",onSort:M,currentSort:T}),e.jsx($,{label:"Type",sortKey:"product_type",onSort:M,currentSort:T}),e.jsx($,{label:"Tags",sortKey:"tags_string",onSort:M,currentSort:T}),e.jsx($,{label:"Status",sortKey:"status",onSort:M,currentSort:T}),e.jsx("th",{className:"px-4 py-3 whitespace-nowrap text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-border",children:[U.map(g=>e.jsxs("tr",{className:"hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(q,{to:`/admin/product/${g.id}`,className:"block w-10 h-10 rounded-md bg-muted overflow-hidden shrink-0 group",children:e.jsx(ab,{product:g},`${g.id}-${g.images?.length||0}-${g.image||""}`)})}),e.jsx("td",{className:"px-4 py-3 font-medium text-foreground max-w-[200px]",children:e.jsx(q,{to:`/admin/product/${g.id}`,className:"hover:text-primary transition-colors truncate block",title:g.name,children:g.name})}),e.jsx("td",{className:"px-4 py-3 text-sm text-muted-foreground max-w-[300px]",children:e.jsx("div",{className:"truncate",title:g.description,children:g.description})}),e.jsx("td",{className:"px-4 py-3 text-center text-sm",children:e.jsx("span",{className:"inline-flex items-center justify-center px-2 py-1 rounded-md bg-muted text-muted-foreground text-xs font-medium",children:g.images?.length||0})}),e.jsx("td",{className:"px-4 py-3 text-sm max-w-[200px]",children:e.jsx("span",{className:"px-2 py-1 rounded-full bg-accent/50 text-accent-foreground text-xs font-medium truncate block",title:g.category,children:g.category})}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:g.brand||"-"}),e.jsxs("td",{className:"px-4 py-3 text-sm text-right font-medium whitespace-nowrap",children:["$",g.price.toFixed(2)]}),e.jsx("td",{className:"px-4 py-3 text-sm text-right text-muted-foreground whitespace-nowrap",children:g.cost?`$${g.cost.toFixed(2)}`:"-"}),e.jsx("td",{className:"px-4 py-3 text-center whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>b(g,-1),disabled:g.on_hand<=0,className:"p-1 rounded-md hover:bg-muted text-muted-foreground hover:text-foreground transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Ke,{size:14})}),e.jsxs(Z,{variant:g.on_hand>10?"success":g.on_hand>0?"warning":"error",className:"min-w-[60px] justify-center gap-1.5",children:[e.jsx(Ze,{size:12}),g.on_hand]}),e.jsx("button",{onClick:()=>b(g,1),className:"p-1 rounded-md hover:bg-muted text-muted-foreground hover:text-foreground transition-colors",children:e.jsx(Se,{size:14})})]})}),e.jsx("td",{className:"px-4 py-3 text-sm font-mono whitespace-nowrap text-muted-foreground",children:g.sku||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-muted-foreground",children:g.variant||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm font-mono whitespace-nowrap text-muted-foreground",children:g.gtin||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm font-mono whitespace-nowrap text-muted-foreground",children:g.mpn||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:g.weight?`${g.weight} lb`:"-"}),e.jsx("td",{className:"px-4 py-3 text-sm capitalize whitespace-nowrap",children:g.condition||"new"}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap",children:g.product_type||"-"}),e.jsx("td",{className:"px-4 py-3 text-xs whitespace-nowrap max-w-[200px] overflow-hidden",children:g.tags&&g.tags.length>0?e.jsx("div",{className:"flex gap-1 overflow-x-auto no-scrollbar",children:g.tags.map(L=>e.jsx("span",{className:"px-1 py-0.5 rounded bg-muted text-muted-foreground whitespace-nowrap",children:L},L))}):"-"}),e.jsx("td",{className:"px-4 py-3 text-center whitespace-nowrap",children:e.jsx(Z,{variant:g.status==="active"?"success":g.status==="draft"?"warning":g.status==="archived"?"orange":"neutral",children:g.status})}),e.jsx("td",{className:"px-4 py-3 text-right sticky right-0 bg-background/95 backdrop-blur-sm border-l shadow-sm",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(q,{to:`/admin/product/${g.id}`,className:"p-1.5 text-muted-foreground hover:text-primary hover:bg-primary/10 rounded-md transition-colors",title:"Edit Product",children:e.jsx(Lt,{size:16})}),e.jsx("button",{onClick:()=>y(g.id,g.name),className:"p-1.5 text-muted-foreground hover:text-destructive hover:bg-destructive/10 rounded-md transition-colors",title:"Delete Product",children:e.jsx(Ee,{size:16})})]})})]},g.id)),U.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:18,className:"px-4 py-8 text-center text-muted-foreground",children:"No products found matching your search."})})]})]})})}),e.jsx(nb,{isOpen:i,onClose:()=>c(!1),onSave:h,product:m})]})}function Q({title:t,description:a,children:s,className:n,level:r=1}){const l=`h${Math.min(r+3,6)}`,m=["lg","base","sm"];return e.jsxs("div",{className:de("sub-section-header",n),children:[e.jsxs("div",{children:[e.jsx(l,{className:`sub-section-title text-${m[r-1]}`,children:t}),a&&e.jsx("p",{className:"text-muted-foreground text-sm mt-1",children:a})]}),s&&e.jsx("div",{className:"flex gap-2 items-center",children:s})]})}function ib(){const{settings:t,updateSettings:a,loading:s}=ae(),[n,r]=d.useState({store_name:"",support_email:"",logo_url:"",primary_color:"#2563eb",secondary_color:"#f8fafc",colors_background_light:"#FFFFFF",colors_background_dark:"#09090b",colors_text_light:"#121212",colors_text_dark:"#f8fafc",colors_solid_button_labels:"#FFFFFF",colors_accent_1:"#000000",colors_accent_2:"#334FB4",gradient_background_1:"",type_header_font:"Assistant",type_body_font:"Inter",page_width:1200,spacing_grid_horizontal:8,spacing_grid_vertical:8,buttons_border_thickness:1,buttons_opacity:100,buttons_radius:0,buttons_shadow_opacity:0,buttons_shadow_horizontal_offset:0,image_ratio:"adapt",show_secondary_image:!0,show_brand:!1,show_rating:!1,enable_quick_add:!0,social_facebook_link:"",social_instagram_link:"",social_youtube_link:"",social_tiktok_link:"",social_twitter_link:"",social_pinterest_link:"",social_snapchat_link:"",social_tumblr_link:"",social_vimeo_link:"",social_github_link:"",favicon_url:"",currency_code_enabled:!0,cart_type:"drawer",predictive_search_enabled:!0}),[l,m]=d.useState(!1),[u,i]=d.useState(null);d.useEffect(()=>{t&&r(x=>({...x,...t,support_email:t.support_email||"",logo_url:t.logo_url||"",gradient_background_1:t.gradient_background_1||"",favicon_url:t.favicon_url||"",social_facebook_link:t.social_facebook_link||"",social_instagram_link:t.social_instagram_link||"",social_youtube_link:t.social_youtube_link||"",social_tiktok_link:t.social_tiktok_link||"",social_twitter_link:t.social_twitter_link||"",social_pinterest_link:t.social_pinterest_link||"",social_snapchat_link:t.social_snapchat_link||"",social_tumblr_link:t.social_tumblr_link||"",social_vimeo_link:t.social_vimeo_link||"",social_github_link:t.social_github_link||""}))},[t]);const c=x=>{const{name:v,value:f,type:N}=x.target;r(h=>({...h,[v]:N==="checkbox"?x.target.checked:N==="number"||N==="range"?Number(f):f}))},p=async x=>{x.preventDefault(),m(!0),i(null);try{await a(n),i({type:"success",text:"Settings saved successfully"})}catch(v){F.error("Failed to save settings:",v),i({type:"error",text:"Failed to save settings"})}finally{m(!1)}};if(s)return e.jsx("div",{className:"p-8 text-center text-muted-foreground",children:"Loading settings..."});const _=Array.from(new Set(st.map(x=>x.family))).sort();return e.jsxs("div",{className:"max-w-5xl",children:[e.jsx(se,{title:"Store Settings",children:e.jsx("p",{className:"text-muted-foreground",children:"Manage your store's branding and configuration."})}),e.jsxs("form",{onSubmit:p,className:"space-y-8 pb-20",children:[e.jsxs("div",{className:"card p-6 space-y-4",children:[e.jsx(Q,{title:"General Info"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(X,{label:"Store Name",name:"store_name",value:n.store_name,onChange:c,required:!0}),e.jsx(X,{label:"Support Email",name:"support_email",value:n.support_email,onChange:c,type:"email"}),e.jsx(X,{label:"Logo URL",name:"logo_url",value:n.logo_url,onChange:c})]})]}),e.jsxs("div",{className:"card p-6 space-y-6",children:[e.jsx(Q,{title:"Global Colors"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Q,{title:"Brand Identity",level:2}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(ee,{label:"Primary Color",name:"primary_color",value:n.primary_color,onChange:c}),e.jsx(ee,{label:"Secondary Color",name:"secondary_color",value:n.secondary_color,onChange:c})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(Q,{title:"Light Mode",level:2}),e.jsx(ee,{label:"Background",name:"colors_background_light",value:n.colors_background_light,onChange:c}),e.jsx(ee,{label:"Text",name:"colors_text_light",value:n.colors_text_light,onChange:c})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Q,{title:"Dark Mode",level:2}),e.jsx(ee,{label:"Background",name:"colors_background_dark",value:n.colors_background_dark,onChange:c}),e.jsx(ee,{label:"Text",name:"colors_text_dark",value:n.colors_text_dark,onChange:c})]})]}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx(Q,{title:"Theme Accents",level:2}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(ee,{label:"Accent 1",name:"colors_accent_1",value:n.colors_accent_1,onChange:c}),e.jsx(ee,{label:"Accent 2",name:"colors_accent_2",value:n.colors_accent_2,onChange:c}),e.jsx(ee,{label:"Solid Button Labels",name:"colors_solid_button_labels",value:n.colors_solid_button_labels,onChange:c}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Gradient Background"}),e.jsx("input",{type:"text",name:"gradient_background_1",value:n.gradient_background_1,onChange:c,className:"input",placeholder:"linear-gradient(...)"})]})]})]})]}),e.jsxs("div",{className:"card p-6 space-y-4",children:[e.jsx(Q,{title:"Typography"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Header Font"}),e.jsxs("select",{name:"type_header_font",value:n.type_header_font,onChange:c,className:"input",children:[_.map(x=>e.jsx("option",{value:x,children:x},x)),e.jsx("option",{value:"sans-serif",children:"System Sans"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Body Font"}),e.jsxs("select",{name:"type_body_font",value:n.type_body_font,onChange:c,className:"input",children:[_.map(x=>e.jsx("option",{value:x,children:x},x)),e.jsx("option",{value:"sans-serif",children:"System Sans"})]})]})]})]}),e.jsxs("div",{className:"card p-6 space-y-4",children:[e.jsx(Q,{title:"Layout"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(te,{label:"Page Width (px)",name:"page_width",value:n.page_width,min:800,max:1600,step:10,onChange:c}),e.jsx(te,{label:"Grid Spacing Horizontal (px)",name:"spacing_grid_horizontal",value:n.spacing_grid_horizontal,min:0,max:100,step:1,onChange:c}),e.jsx(te,{label:"Grid Spacing Vertical (px)",name:"spacing_grid_vertical",value:n.spacing_grid_vertical,min:0,max:100,step:1,onChange:c})]})]}),e.jsxs("div",{className:"card p-6 space-y-4",children:[e.jsx(Q,{title:"Buttons & Inputs"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(te,{label:"Border Thickness (px)",name:"buttons_border_thickness",value:n.buttons_border_thickness,min:0,max:10,step:1,onChange:c}),e.jsx(te,{label:"Opacity (%)",name:"buttons_opacity",value:n.buttons_opacity,min:0,max:100,step:5,onChange:c}),e.jsx(te,{label:"Corner Radius (px)",name:"buttons_radius",value:n.buttons_radius,min:0,max:40,step:1,onChange:c}),e.jsx(te,{label:"Shadow Opacity (%)",name:"buttons_shadow_opacity",value:n.buttons_shadow_opacity,min:0,max:100,step:5,onChange:c}),e.jsx(te,{label:"Shadow Offset X (px)",name:"buttons_shadow_horizontal_offset",value:n.buttons_shadow_horizontal_offset,min:-20,max:20,step:1,onChange:c})]})]}),e.jsxs("div",{className:"card p-6 space-y-4",children:[e.jsx(Q,{title:"Product Card"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Image Ratio"}),e.jsxs("select",{name:"image_ratio",value:n.image_ratio,onChange:c,className:"input",children:[e.jsx("option",{value:"adapt",children:"Adapt to Image"}),e.jsx("option",{value:"portrait",children:"Portrait"}),e.jsx("option",{value:"square",children:"Square"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 pt-6",children:[e.jsx(le,{label:"Show Secondary Image on Hover",name:"show_secondary_image",checked:n.show_secondary_image,onChange:c}),e.jsx(le,{label:"Show Brand",name:"show_brand",checked:n.show_brand,onChange:c}),e.jsx(le,{label:"Show Rating",name:"show_rating",checked:n.show_rating,onChange:c}),e.jsx(le,{label:"Enable Quick Add",name:"enable_quick_add",checked:n.enable_quick_add,onChange:c})]})]})]}),e.jsxs("div",{className:"card p-6 space-y-4",children:[e.jsx(Q,{title:"Social Media"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(X,{label:"Facebook Link",name:"social_facebook_link",value:n.social_facebook_link,onChange:c,placeholder:"https://facebook.com/..."}),e.jsx(X,{label:"Instagram Link",name:"social_instagram_link",value:n.social_instagram_link,onChange:c,placeholder:"https://instagram.com/..."}),e.jsx(X,{label:"YouTube Link",name:"social_youtube_link",value:n.social_youtube_link,onChange:c,placeholder:"https://youtube.com/..."}),e.jsx(X,{label:"TikTok Link",name:"social_tiktok_link",value:n.social_tiktok_link,onChange:c,placeholder:"https://tiktok.com/..."}),e.jsx(X,{label:"Twitter (X) Link",name:"social_twitter_link",value:n.social_twitter_link,onChange:c,placeholder:"https://twitter.com/..."}),e.jsx(X,{label:"Pinterest Link",name:"social_pinterest_link",value:n.social_pinterest_link,onChange:c,placeholder:"https://pinterest.com/..."}),e.jsx(X,{label:"GitHub Link",name:"social_github_link",value:n.social_github_link,onChange:c,placeholder:"https://github.com/..."})]})]}),e.jsxs("div",{className:"card p-6 space-y-4",children:[e.jsx(Q,{title:"Miscellaneous"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Favicon URL"}),e.jsx("input",{type:"text",name:"favicon_url",value:n.favicon_url,onChange:c,className:"input",placeholder:"https://example.com/favicon.png"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Cart Type"}),e.jsxs("select",{name:"cart_type",value:n.cart_type,onChange:c,className:"input",children:[e.jsx("option",{value:"drawer",children:"Drawer"}),e.jsx("option",{value:"page",children:"Page"}),e.jsx("option",{value:"notification",children:"Notification"})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 pt-6",children:[e.jsx(le,{label:"Enable Currency Code",name:"currency_code_enabled",checked:n.currency_code_enabled,onChange:c}),e.jsx(le,{label:"Enable Predictive Search",name:"predictive_search_enabled",checked:n.predictive_search_enabled,onChange:c})]})]})]}),e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-background border-t z-10 flex justify-end gap-4 max-w-[var(--container-width)] mx-auto",children:[u&&e.jsx("div",{className:`px-4 py-2 rounded-md flex items-center ${u.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:u.text}),e.jsx("button",{type:"submit",disabled:l,className:"btn btn-primary min-w-[120px]",children:l?"Saving...":"Save Settings"})]})]})]})}function ee({label:t,name:a,value:s,onChange:n}){return e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",name:a,value:lb(s),onChange:n,className:"w-10 h-10 p-1 rounded cursor-pointer border border-input",title:"Choose color"}),e.jsx("input",{type:"text",name:a,value:s,onChange:n,className:"input font-mono",placeholder:"#000000"})]})]})}function te({label:t,name:a,value:s,min:n,max:r,step:l,onChange:m}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("label",{className:"text-sm font-medium",children:t}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s})]}),e.jsx("input",{type:"range",name:a,value:s,min:n,max:r,step:l,onChange:m,className:"w-full"})]})}function le({label:t,name:a,checked:s,onChange:n}){return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:a,name:a,checked:s,onChange:n,className:"w-4 h-4 rounded border-input"}),e.jsx("label",{htmlFor:a,className:"text-sm cursor-pointer select-none",children:t})]})}function X({label:t,name:a,value:s,onChange:n,placeholder:r,type:l="text",required:m=!1}){return e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:t}),e.jsx("input",{type:l,name:a,value:s,onChange:n,className:"input",placeholder:r,required:m})]})}let ce=null;function lb(t){if(!t)return"#000000";if(/^#[0-9A-F]{6}$/i.test(t))return t;if(typeof document>"u")return"#000000";try{if(ce||(ce=document.createElement("canvas").getContext("2d",{willReadFrequently:!0})),!ce)return"#000000";ce.fillStyle="#000000",ce.fillStyle=t;const a=ce.fillStyle;if(a.startsWith("#")){if(a.length===7)return a;if(a.length===4)return"#"+a[1]+a[1]+a[2]+a[2]+a[3]+a[3]}if(a.startsWith("rgb")){const s=a.match(/\d+/g);if(s&&s.length>=3){const n=r=>parseInt(r).toString(16).padStart(2,"0");return`#${n(s[0])}${n(s[1])}${n(s[2])}`}}}catch{return"#000000"}return"#000000"}function cb(){const[t,a]=d.useState([]),[s,n]=d.useState(!0),[r,l]=d.useState("all"),m=d.useCallback(async()=>{n(!0);try{let i=k.from("reviews").select(`
          *,
          profiles (full_name),
          products (name)
        `).order("created_at",{ascending:!1});r!=="all"&&(i=i.eq("status",r));const{data:c,error:p}=await i;if(p)throw p;a(c||[])}catch(i){F.error("Error fetching admin reviews:",i)}finally{n(!1)}},[r]);d.useEffect(()=>{m()},[m]);const u=async(i,c)=>{try{const{error:p}=await k.from("reviews").update({status:c}).eq("id",i);if(p)throw p;a(_=>_.map(x=>x.id===i?{...x,status:c}:x))}catch(p){F.error("Error updating review status:",p),alert("Failed to update status")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Product Reviews"}),e.jsx("div",{className:"flex items-center gap-2 bg-card border border-border rounded-lg p-1",children:["all","pending","approved","rejected"].map(i=>e.jsx("button",{onClick:()=>l(i),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors capitalized ${r===i?"bg-primary text-primary-foreground shadow-sm":"text-muted-foreground hover:bg-muted"}`,children:i.charAt(0).toUpperCase()+i.slice(1)},i))})]}),e.jsx("div",{className:"bg-card border border-border rounded-xl shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-muted/50 border-b border-border",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 font-medium text-muted-foreground",children:"Product"}),e.jsx("th",{className:"p-4 font-medium text-muted-foreground",children:"User"}),e.jsx("th",{className:"p-4 font-medium text-muted-foreground",children:"Rating"}),e.jsx("th",{className:"p-4 font-medium text-muted-foreground w-1/3",children:"Comment"}),e.jsx("th",{className:"p-4 font-medium text-muted-foreground",children:"Date"}),e.jsx("th",{className:"p-4 font-medium text-muted-foreground",children:"Status"}),e.jsx("th",{className:"p-4 font-medium text-muted-foreground text-right w-32",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:s?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-8 text-center text-muted-foreground",children:"Loading reviews..."})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-8 text-center text-muted-foreground",children:"No reviews found matching filter."})}):t.map(i=>e.jsxs("tr",{className:"group hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"p-4 font-medium truncate max-w-[150px]",title:i.products?.name,children:e.jsx(q,{to:`/product/${i.product_id}`,className:"hover:underline text-primary",children:i.products?.name||`Product #${i.product_id}`})}),e.jsx("td",{className:"p-4 whitespace-nowrap",children:i.profiles?.full_name||"Anonymous"}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-bold",children:i.rating}),e.jsx(oe,{rating:i.rating,size:14})]})}),e.jsx("td",{className:"p-4",children:e.jsx("p",{className:"line-clamp-2 text-muted-foreground group-hover:text-foreground transition-colors",title:i.comment||"",children:i.comment})}),e.jsx("td",{className:"p-4 whitespace-nowrap text-muted-foreground",children:new Date(i.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${i.status==="approved"?"bg-green-500/10 text-green-600 border-green-500/20":i.status==="rejected"?"bg-red-500/10 text-red-600 border-red-500/20":"bg-yellow-500/10 text-yellow-600 border-yellow-500/20"}`,children:i.status})}),e.jsx("td",{className:"p-4 text-right",children:i.status==="pending"?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>u(i.id,"approved"),className:"p-1.5 rounded-md hover:bg-green-100 text-green-600 transition-colors",title:"Approve",children:e.jsx(Ot,{size:18})}),e.jsx("button",{onClick:()=>u(i.id,"rejected"),className:"p-1.5 rounded-md hover:bg-red-100 text-red-600 transition-colors",title:"Reject",children:e.jsx(K,{size:18})})]}):e.jsxs("div",{className:"flex justify-end gap-2 opacity-0 group-hover:opacity-50 transition-opacity",children:[i.status==="rejected"&&e.jsx("button",{onClick:()=>u(i.id,"approved"),className:"text-xs hover:underline",children:"Approve"}),i.status==="approved"&&e.jsx("button",{onClick:()=>u(i.id,"rejected"),className:"text-xs hover:underline",children:"Reject"})]})})]},i.id))})]})})})]})}function db(){const[t,a]=$t(),s=t.get("tab")||"orders",n=r=>{a({tab:r})};return e.jsxs("div",{className:"max-w-6xl mx-auto animate-in fade-in duration-500",children:[e.jsx("h2",{className:"text-3xl font-bold mb-8",children:"Admin Dashboard"}),e.jsx("div",{className:"flex gap-4 mb-6",children:e.jsxs("div",{className:"bg-muted p-1 rounded-lg inline-flex",children:[e.jsx("button",{onClick:()=>n("orders"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${s==="orders"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:"Orders"}),e.jsx("button",{onClick:()=>n("customers"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${s==="customers"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:"Customers"}),e.jsx("button",{onClick:()=>n("inventory"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${s==="inventory"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:"Inventory"}),e.jsx("button",{onClick:()=>n("reviews"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${s==="reviews"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:"Reviews"}),e.jsx("button",{onClick:()=>n("settings"),className:`px-4 py-2 rounded-md text-sm font-medium transition-all ${s==="settings"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,children:"Settings"})]})}),e.jsxs("div",{className:"card p-6",children:[s==="orders"&&e.jsx(hr,{}),s==="customers"&&e.jsx(pr,{}),s==="inventory"&&e.jsx(ob,{}),s==="reviews"&&e.jsx(cb,{}),s==="settings"&&e.jsx(ib,{})]})]})}function Ve(){const{id:t}=xe(),{user:a,role:s}=ue(),[n,r]=d.useState([]),[l,m]=d.useState(!0),[u,i]=d.useState(null),[c,p]=d.useState([]),[_,x]=d.useState(!1),[v,f]=d.useState(!1),[N,h]=d.useState(""),y=t||a?.id,b=!t||t===a?.id,[j,o]=d.useState({fullName:"",phoneNumber:""}),[w,C]=d.useState({newEmail:"",newPassword:"",confirmPassword:""}),[I,U]=d.useState(!1),[M,T]=d.useState(!1),[A,S]=d.useState(!1);d.useEffect(()=>{if(!y)return;const E=async()=>{const{data:V,error:W}=await k.from("orders").select("*").eq("user_id",y).order("created_at",{ascending:!1});W?F.error("Error fetching orders:",W):r(V||[])},P=async()=>{const{data:V,error:W}=await k.from("profiles").select("*").eq("id",y).single();W&&W.code!=="PGRST116"&&F.error("Error fetching profile:",W),V?(i(V),o({fullName:V.full_name||"",phoneNumber:V.phone_number||""})):o(_e=>({..._e,fullName:b&&a?.user_metadata?.full_name||""}))},z=async()=>{const{data:V,error:W}=await k.from("addresses").select("*").eq("user_id",y).order("is_default",{ascending:!1}).order("created_at",{ascending:!1});W?F.error("Error fetching addresses",W):p(V||[])};(async()=>(m(!0),await Promise.all([E(),P(),z()]),m(!1)))()},[y,b,a]);const D=async E=>{E.preventDefault(),h(""),f(!0);try{const P={id:y,full_name:j.fullName,phone_number:j.phoneNumber,updated_at:new Date().toISOString()},{error:z}=await k.from("profiles").upsert(P);if(z)throw z;i(H=>H?{...H,...P}:P),x(!1),alert("Profile updated successfully!")}catch(P){console.error("Error saving profile:",P),h(P instanceof Error?P.message:"Failed to save profile.")}finally{f(!1)}},O=async E=>{if(E.preventDefault(),!!w.newEmail){U(!0);try{const{error:P}=await k.auth.updateUser({email:w.newEmail});if(P)throw P;alert(`Confirmation email sent to ${w.newEmail}. Please click the link in both your old and new emails to finalize the change.`),C(z=>({...z,newEmail:""}))}catch(P){F.error("Error updating email:",P),alert(P instanceof Error?P.message:"Failed to update email")}finally{U(!1)}}},Y=async E=>{if(E.preventDefault(),w.newPassword!==w.confirmPassword){alert("Passwords do not match");return}if(w.newPassword.length<6){alert("Password must be at least 6 characters");return}U(!0);try{const{error:P}=await k.auth.updateUser({password:w.newPassword});if(P)throw P;alert("Password updated successfully"),C(z=>({...z,newPassword:"",confirmPassword:""}))}catch(P){F.error("Error updating password:",P),alert(P instanceof Error?P.message:"Failed to update password")}finally{U(!1)}},g=async()=>{const E=u?.email;if(!E){alert("No email address found for this user.");return}if(confirm(`Send password reset email to ${E}?`))try{const{error:P}=await k.auth.resetPasswordForEmail(E,{redirectTo:window.location.origin+"/reset-password"});if(P)throw P;alert(`Password reset email sent to ${E}`)}catch(P){F.error("Admin reset password error:",P),alert("Failed to send reset email.")}},L=async E=>{if(window.confirm("Are you sure you want to delete this address?"))try{const{error:P}=await k.from("addresses").delete().eq("id",E);if(P)throw P;p(z=>z.filter(H=>H.id!==E))}catch(P){F.error("Failed to delete address",P),alert("Failed to delete address")}},R=async E=>{try{const P=c.find(V=>V.is_default);P&&await k.from("addresses").update({is_default:!1}).eq("id",P.id);const{error:z}=await k.from("addresses").update({is_default:!0}).eq("id",E);if(z)throw z;const{data:H}=await k.from("addresses").select("*").eq("user_id",y).order("is_default",{ascending:!1});H&&p(H)}catch(P){F.error("Failed to set default address",P),alert("Failed to set default address")}},B=async E=>{S(!0);try{const P={user_id:y,...E,is_default:c.length===0?!0:E.is_default};if(P.is_default&&c.length>0){const V=c.find(W=>W.is_default);V&&await k.from("addresses").update({is_default:!1}).eq("id",V.id)}const{data:z,error:H}=await k.from("addresses").insert(P).select().single();if(H)throw H;p(V=>{let W=[...V];return z.is_default&&(W=W.map(_e=>({..._e,is_default:!1}))),[z,...W]}),T(!1),alert("Address added successfully!")}catch(P){F.error("Error saving address:",P),alert("Failed to save address. Please try again.")}finally{S(!1)}};return!b&&s!=="admin"?e.jsx("div",{className:"text-center p-8 text-destructive",children:"You do not have permission to view this profile."}):e.jsxs("div",{className:"max-w-4xl mx-auto animate-in fade-in duration-500",children:[e.jsx(De,{title:b?"My Profile":"Customer Profile",className:"mb-8"}),e.jsx(se,{title:"Contact Information"}),e.jsxs("div",{className:"card p-6 mb-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(b||s==="admin")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Email"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-base font-medium text-foreground",children:b?a?.email:u?.email||"Email not public"}),(b&&a?.email||u?.email)&&e.jsx(Z,{variant:u?.email_verified?"success":"warning",children:u?.email_verified?"Verified":"Unverified"})]}),s==="admin"&&!b&&u?.email&&e.jsx("button",{onClick:g,className:"text-xs text-primary hover:underline mt-1 block",children:"Send Password Reset Email"})]}),s==="admin"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Role"}),e.jsx("div",{className:"text-base font-medium text-foreground capitalize",children:u?.role||"User"})]})]}),_?e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[N&&e.jsx("div",{className:"p-3 rounded-md bg-destructive/10 text-destructive text-sm",children:N}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:j.fullName,onChange:E=>o({...j,fullName:E.target.value}),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",value:j.phoneNumber,onChange:E=>o({...j,phoneNumber:E.target.value}),className:"form-input",placeholder:"123-456-7890"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>x(!1),className:"btn btn-secondary",disabled:v,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:v,children:v?"Validating & Saving...":"Save Profile"})]})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Full Name"}),e.jsx("div",{className:"text-base font-medium text-foreground",children:u?.full_name||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-1",children:"Phone Number"}),e.jsx("div",{className:"text-base font-medium text-foreground",children:u?.phone_number||"-"})]}),e.jsx("button",{onClick:()=>x(!0),className:"btn btn-secondary text-sm w-max",children:"Edit Contact Info"})]})]}),e.jsx(se,{title:"Security"}),b&&e.jsx("div",{className:"card p-6 mb-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Change Email"}),e.jsxs("form",{onSubmit:O,className:"space-y-3",children:[e.jsx("input",{type:"email",placeholder:"New Email Address",value:w.newEmail,onChange:E=>C({...w,newEmail:E.target.value}),className:"form-input",required:!0}),e.jsx("button",{type:"submit",className:"btn btn-secondary w-full text-sm",disabled:I,children:"Update Email"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"You will receive a confirmation link at your new email address."})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Change Password"}),e.jsxs("form",{onSubmit:Y,className:"space-y-3",children:[e.jsx("input",{type:"password",placeholder:"New Password",value:w.newPassword,onChange:E=>C({...w,newPassword:E.target.value}),className:"form-input"}),e.jsx("input",{type:"password",placeholder:"Confirm New Password",value:w.confirmPassword,onChange:E=>C({...w,confirmPassword:E.target.value}),className:"form-input"}),e.jsx("button",{type:"submit",className:"btn btn-secondary w-full text-sm",disabled:I,children:"Update Password"})]})]})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(se,{title:"Saved Addresses"}),!M&&e.jsx("button",{onClick:()=>T(!0),className:"btn btn-primary text-sm",children:"Add New Address"})]}),M&&e.jsxs("div",{className:"card p-6 mb-6 border-2 border-primary/20",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Add New Address"}),e.jsx(lt,{onSave:B,onCancel:()=>T(!1),isSaving:A})]}),c.length===0?e.jsx("div",{className:"card p-6 text-center text-muted-foreground",children:"No addresses saved. Add one during checkout."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:c.map(E=>e.jsxs("div",{className:"card p-4 relative group",children:[E.is_default&&e.jsx("span",{className:"absolute top-2 right-2 bg-primary/10 text-primary text-xs font-bold px-2 py-1 rounded-full",children:"Default"}),e.jsx("h4",{className:"font-medium text-lg mb-1",children:E.address_line1}),E.address_line2&&e.jsx("div",{className:"text-muted-foreground",children:E.address_line2}),e.jsxs("div",{className:"text-muted-foreground mb-3",children:[E.city,", ",E.state," ",E.zip_code]}),e.jsxs("div",{className:"flex gap-2 text-sm",children:[!E.is_default&&e.jsx("button",{onClick:()=>R(E.id),className:"text-primary hover:underline",children:"Make Default"}),e.jsx("button",{onClick:()=>L(E.id),className:"text-destructive hover:underline",children:"Delete"})]})]},E.id))})]}),e.jsx(se,{title:b?"My Orders":"Customer Orders"}),l?e.jsx("div",{className:"text-center p-8",children:"Loading orders..."}):n.length===0?e.jsx("div",{className:"card p-8 text-center text-muted-foreground",children:"You haven't placed any orders yet."}):e.jsx("div",{className:"overflow-x-auto border border-border rounded-lg",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted",children:[e.jsx("th",{className:"p-3 text-sm font-semibold text-muted-foreground border-b border-border",children:"Order ID"}),e.jsx("th",{className:"p-3 text-sm font-semibold text-muted-foreground border-b border-border",children:"Date"}),e.jsx("th",{className:"p-3 text-sm font-semibold text-muted-foreground border-b border-border",children:"Total"}),e.jsx("th",{className:"p-3 text-sm font-semibold text-muted-foreground border-b border-border",children:"Status"}),e.jsx("th",{className:"p-3 text-sm font-semibold text-muted-foreground border-b border-border",children:"Shipping Address"})]})}),e.jsx("tbody",{children:n.map(E=>e.jsxs("tr",{className:"border-b border-border last:border-0 hover:bg-muted/50 transition-colors",children:[e.jsx("td",{className:"p-3 text-sm",children:e.jsxs(q,{to:`/order/${E.id}`,className:"hover:text-primary ",children:["#",E.id]})}),e.jsx("td",{className:"p-3 text-sm",children:new Date(E.created_at).toLocaleDateString()}),e.jsxs("td",{className:"p-3 text-sm font-medium",children:["$",E.total_amount.toFixed(2)]}),e.jsx("td",{className:"p-3 text-sm",children:e.jsx(Z,{variant:E.status==="shipped"?"success":E.status==="processing"?"info":E.status==="cancelled"?"neutral":"warning",children:E.status})}),e.jsx("td",{className:"p-3 text-sm max-w-[200px] truncate",children:E.shipping_address})]},E.id))})]})})]})}function He({requireAdmin:t=!1}){const{user:a,role:s,loading:n}=ue(),r=qt();return n?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."}):a?t&&s!=="admin"?e.jsx(Te,{to:"/",replace:!0}):e.jsx(Ye,{}):e.jsx(Te,{to:"/login",state:{from:r},replace:!0})}class mb extends d.Component{state={hasError:!1};static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(a,s){F.error("Uncaught error:",a,s)}render(){return this.state.hasError?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen p-6 text-center bg-background text-foreground",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Something went wrong."}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"We're sorry, but an unexpected error occurred."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-primary",children:"Reload Page"})]}):this.props.children}}function ub(){const{id:t}=xe(),{user:a,role:s}=ue(),n=ie(),[r,l]=d.useState(null),[m,u]=d.useState([]),[i,c]=d.useState(!0),[p,_]=d.useState(""),[x,v]=d.useState(!1),[f,N]=d.useState(null);d.useEffect(()=>{if(!t)return;(async()=>{c(!0),_("");try{const{data:o,error:w}=await k.from("orders").select("*").eq("id",t).single();if(w)throw w;if(!o)throw new Error("Order not found");if(s!=="admin"&&o.user_id!==a?.id){_("You do not have permission to view this order."),c(!1);return}l(o);const{data:C,error:I}=await k.from("order_items").select("*, products(image)").eq("order_id",t);if(I)throw I;u(C||[])}catch(o){F.error("Error fetching order details:",o),_(o.message||"Failed to load order details.")}finally{c(!1)}})()},[t,a,s]);const h=async j=>{if(r)try{const{error:o}=await k.from("orders").update({status:j}).eq("id",r.id);if(o)throw o;l({...r,status:j})}catch(o){F.error("Error updating status:",o),alert("Failed to update status.")}},y=j=>{N({productId:j.product_id,productName:j.product_name}),v(!0)};if(i)return e.jsx("div",{className:"text-center p-8",children:"Loading order details..."});if(p)return e.jsxs("div",{className:"max-w-4xl mx-auto p-8 text-center",children:[e.jsx("div",{className:"text-destructive mb-4",children:p}),e.jsx("button",{onClick:()=>n(-1),className:"btn btn-secondary",children:"Go Back"})]});if(!r)return null;const b=a?.id===r.user_id;return e.jsxs("div",{className:"max-w-4xl mx-auto animate-in fade-in duration-500 py-8 px-4",children:[e.jsx(De,{title:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>n(-1),className:"text-muted-foreground hover:text-foreground",children:"← Back"}),e.jsxs("span",{className:"text-3xl font-bold",children:["Order #",r.id]})]}),className:"mb-8",children:s==="admin"?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Status:"}),e.jsxs("select",{value:r.status,onChange:j=>h(j.target.value),className:"h-9 px-3 rounded-md border border-input bg-background",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}):e.jsx(Z,{variant:r.status==="shipped"?"success":r.status==="processing"?"info":r.status==="cancelled"?"neutral":"warning",children:r.status})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsx("div",{className:"md:col-span-2 space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"p-4 border-b border-border bg-muted/30",children:e.jsx("h2",{className:"font-semibold",children:"Order Items"})}),e.jsx("div",{className:"divide-y divide-border",children:m.map(j=>e.jsxs("div",{className:"p-4 flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-16 w-16 bg-secondary rounded overflow-hidden flex-shrink-0 border border-border",children:e.jsx("img",{src:J(j.products?.image),alt:j.product_name,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx(q,{to:`/product/${j.product_id}`,className:"font-medium text-foreground hover:underline hover:text-primary transition-colors block",children:j.product_name}),e.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:["Qty: ",j.quantity," × $",j.price.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 justify-between sm:justify-end w-full sm:w-auto",children:[e.jsxs("div",{className:"font-bold",children:["$",(j.price*j.quantity).toFixed(2)]}),b&&e.jsx("button",{onClick:()=>y(j),className:"btn btn-sm btn-primary",children:"Write Review"})]})]},j.id))})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"font-semibold mb-4",children:"Order Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsxs("span",{children:["$",m.reduce((j,o)=>j+o.price*o.quantity,0).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Shipping"}),e.jsx("span",{children:"Free"})]}),e.jsxs("div",{className:"border-t border-border my-2 pt-2 flex justify-between font-bold text-base",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",r.total_amount.toFixed(2)]})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"font-semibold mb-4",children:"Shipping Details"}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-line",children:r.shipping_address})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h2",{className:"font-semibold mb-4",children:"Order Info"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Date Placed"}),e.jsx("span",{children:new Date(r.created_at).toLocaleDateString()})]}),s==="admin"&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Customer ID"}),e.jsxs("span",{className:"font-mono text-xs",children:[r.user_id.split("-")[0],"..."]})]})]})]})]})]}),x&&f&&r&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-card w-full max-w-lg rounded-lg shadow-xl border border-border p-6 relative animate-in zoom-in-95 duration-200",children:[e.jsx("button",{onClick:()=>v(!1),className:"absolute top-4 right-4 text-muted-foreground hover:text-foreground",children:e.jsx(K,{size:20})}),e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Write a Review"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-6",children:["Sharing your thoughts on ",e.jsx("span",{className:"font-medium text-foreground",children:f.productName})]}),e.jsx(it,{productId:f.productId,userId:a?.id||"",orderId:r.id,onReviewSubmitted:()=>{v(!1),alert("Review submitted successfully!")},onCancel:()=>v(!1)})]})})]})}function hb(){const{id:t}=xe(),a=ie(),[s,n]=d.useState(!0),[r,l]=d.useState(!1),[m,u]=d.useState(null),[i,c]=d.useState(!1),[p,_]=d.useState(null),[x,v]=d.useState(null),[f,N]=d.useState(!1),[h,y]=d.useState({name:"",description:"",price:0,category:"",image:"",images:[],on_hand:0,cost:0,sku:"",brand:"",weight:0,gtin:"",mpn:"",product_type:"",tags:[],status:"active",variant:""}),[b,j]=d.useState(10);d.useEffect(()=>{j(10)},[h.category]);const[o,w]=d.useState(new Set);d.useEffect(()=>{w(new Set)},[h.images]);const C=S=>{const{scrollTop:D,clientHeight:O,scrollHeight:Y}=S.currentTarget;Y-D<=O+20&&j(g=>g+10)};d.useEffect(()=>{async function S(){if(t)try{const{data:D,error:O}=await k.from("products").select("*").eq("id",t).single();if(O)throw O;D&&y(D)}catch(D){F.error("Error fetching product:",D),u("Failed to load product")}finally{n(!1)}}S()},[t]);const I=async S=>{l(!0),v(S),u(null),c(!1),_(null);try{if(h.sku&&t&&await ze(h.sku,parseInt(t))){const Y=await dt(h.sku);throw _(Y),new Error(`SKU "${h.sku}" already exists.`)}const{error:D}=await k.from("products").update(h).eq("id",t);if(D)throw D;c(!0),setTimeout(()=>{c(!1),v(null)},3e3)}catch(D){F.error("Error saving product:",D),u(D instanceof Error?D.message:"Failed to save product")}finally{l(!1)}},U=async()=>{if(confirm("Are you sure you want to delete this product? This cannot be undone."))try{const{error:S}=await k.from("products").delete().eq("id",t);if(S){if(S.code==="23503"&&confirm("This product cannot be deleted because it is part of existing orders. Would you like to archive it instead?")){const{error:D}=await k.from("products").update({status:"archived"}).eq("id",t);if(D)throw D;v(x||"top"),c(!0),setTimeout(()=>a("/admin?tab=inventory"),1500);return}throw S}a("/admin?tab=inventory")}catch(S){const D=S;F.error("Error deleting product:",D),u(D.message||"Failed to delete product")}},M=()=>{const S=ct(h.category||"",h.brand||"",h.name||"",h.variant||"");y(D=>({...D,sku:S}))},T=async S=>{if(!(!S.target.files||S.target.files.length===0)){N(!0);try{const D=S.target.files[0],O=await ss(D),g=[...h.images||[],O];y(L=>({...L,images:g,image:L.image||O}))}catch(D){F.error("Error uploading image:",D),u("Failed to upload image. Please try again.")}finally{N(!1),S.target.value=""}}};if(s)return e.jsx("div",{className:"p-8 text-center",children:"Loading product..."});const A=et.filter(S=>S.toLowerCase().includes((h.category||"").toLowerCase())).slice(0,b);return e.jsxs("div",{className:"max-w-4xl mx-auto pb-16 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs(q,{to:"/admin?tab=inventory",className:"inline-flex items-center gap-2 text-muted-foreground hover:text-primary transition-colors",children:[e.jsx(Xe,{size:20})," Back to Inventory"]}),e.jsxs("button",{onClick:U,className:"text-destructive hover:bg-destructive/10 px-3 py-2 rounded-md transition-colors flex items-center gap-2 text-sm font-medium",children:[e.jsx(Ee,{size:16})," Delete Product"]})]}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Edit Product"}),e.jsxs("div",{className:"flex items-center gap-4",children:[i&&x==="top"&&e.jsxs("span",{className:"text-sm text-green-600 animate-in fade-in slide-in-from-right-2 flex items-center gap-1",children:[e.jsx(ge,{size:14})," Saved!"]}),e.jsxs("button",{onClick:()=>I("top"),disabled:r,className:"btn btn-primary flex items-center gap-2",children:[r&&x==="top"?e.jsx(ye,{size:18,className:"animate-spin"}):e.jsx(ge,{size:18}),"Save Changes"]})]})]}),m&&e.jsxs("div",{className:"bg-destructive/10 text-destructive p-4 rounded-lg mb-6 border border-destructive/20",children:[e.jsx("p",{children:m}),p&&e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-foreground/80",children:"Suggestion:"}),e.jsx("code",{className:"text-sm font-mono bg-background/50 px-2 py-1 rounded border border-destructive/20",children:p}),e.jsx("button",{type:"button",onClick:()=>{y({...h,sku:p}),u(null),_(null)},className:"text-xs px-3 py-1 bg-background hover:bg-muted border border-border rounded transition-colors",children:"Use Suggestion"})]})]}),e.jsxs("form",{onSubmit:S=>{S.preventDefault(),I("bottom")},className:"space-y-8",children:[e.jsxs("section",{className:"bg-card border border-border rounded-xl p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 border-b border-border pb-2",children:"Basic Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Product Name"}),e.jsx("input",{type:"text",required:!0,className:"input w-full",value:h.name||"",onChange:S=>y({...h,name:S.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Brand"}),e.jsx("input",{type:"text",className:"input w-full",value:h.brand||"",onChange:S=>y({...h,brand:S.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx("textarea",{required:!0,className:"input w-full min-h-[120px]",value:h.description||"",onChange:S=>y({...h,description:S.target.value})})]})]})]}),e.jsxs("section",{className:"bg-card border border-border rounded-xl p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 border-b border-border pb-2",children:"Pricing & Inventory"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Price ($)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",required:!0,className:"input w-full",value:h.price||0,onChange:S=>y({...h,price:parseFloat(S.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Cost ($)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"input w-full",value:h.cost||0,onChange:S=>y({...h,cost:parseFloat(S.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Stock (On Hand)"}),e.jsx("input",{type:"number",min:"0",required:!0,className:"input w-full",value:h.on_hand||0,onChange:S=>y({...h,on_hand:parseInt(S.target.value)})})]})]})]}),e.jsxs("section",{className:"bg-card border border-border rounded-xl p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 border-b border-border pb-2",children:"Identification & Shipping"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"SKU"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",className:"input w-full font-mono",value:h.sku||"",onChange:S=>y({...h,sku:S.target.value})}),e.jsx("button",{type:"button",onClick:M,className:"px-3 py-2 bg-secondary text-secondary-foreground rounded-md text-xs font-medium hover:bg-secondary/80 whitespace-nowrap",title:"Generate SKU from attributes",children:"Generate"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Variant"}),e.jsx("input",{type:"text",className:"input w-full",value:h.variant||"",onChange:S=>y({...h,variant:S.target.value}),placeholder:"e.g. Red, XL"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"GTIN / UPC"}),e.jsx("input",{type:"text",className:"input w-full font-mono",value:h.gtin||"",onChange:S=>y({...h,gtin:S.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"MPN"}),e.jsx("input",{type:"text",className:"input w-full font-mono",value:h.mpn||"",onChange:S=>y({...h,mpn:S.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Weight (lb)"}),e.jsx("input",{type:"number",step:"0.01",className:"input w-full",value:h.weight||0,onChange:S=>y({...h,weight:parseFloat(S.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Condition"}),e.jsxs("select",{className:"input w-full",value:h.condition||"new",onChange:S=>y({...h,condition:S.target.value}),children:[e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"used",children:"Used"}),e.jsx("option",{value:"refurbished",children:"Refurbished"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Product Type"}),e.jsx("input",{type:"text",className:"input w-full",value:h.product_type||"",onChange:S=>y({...h,product_type:S.target.value})})]})]})]}),e.jsxs("section",{className:"bg-card border border-border rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 border-b border-border pb-2 flex items-center gap-2",children:[e.jsx(Ut,{size:18})," Media"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Upload Image"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"file",accept:"image/*",className:"input w-full p-1.5 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-primary-foreground hover:file:bg-primary/90",onChange:T,disabled:f}),f&&e.jsx(ye,{className:"animate-spin text-muted-foreground my-auto",size:20})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium",children:"Image URLs (One per line)"}),o.size>0&&e.jsxs("span",{className:"text-xs text-destructive flex items-center gap-1 font-medium animate-in fade-in",children:[e.jsx(Ge,{size:12}),o.size," broken URL",o.size!==1?"s":""," detected"]})]}),e.jsx("textarea",{className:`input w-full min-h-[100px] font-mono text-xs ${o.size>0?"border-destructive focus-visible:ring-destructive":""}`,placeholder:"https://example.com/image1.jpg",value:h.images?.join(`
`)||"",onChange:S=>{const D=S.target.value.split(`
`).map(O=>O.trim()).filter(Boolean);y({...h,images:D,image:D[0]||""})}}),o.size>0&&e.jsxs("p",{className:"text-[11px] text-destructive",children:["Lines with errors: ",Array.from(o).map(S=>S+1).join(", ")]})]}),h.images&&h.images.length>0&&e.jsx("div",{className:"flex gap-4 overflow-x-auto py-2",children:h.images.map((S,D)=>e.jsxs("div",{className:`relative w-24 h-24 shrink-0 rounded-lg border overflow-hidden bg-muted group ${o.has(D)?"border-destructive ring-1 ring-destructive":""}`,children:[o.has(D)?e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-destructive bg-destructive/10",children:[e.jsx(Bt,{size:24,className:"mb-1"}),e.jsx("span",{className:"text-[10px] font-medium",children:"Broken"})]}):e.jsx("img",{src:J(S),alt:"",className:"w-full h-full object-cover",onError:()=>{w(O=>new Set(O).add(D))},onLoad:()=>{if(o.has(D)){const O=new Set(o);O.delete(D),w(O)}}}),e.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-black/50 text-white text-[10px] p-1 text-center truncate px-2 opacity-0 group-hover:opacity-100 transition-opacity",children:["Image ",D+1]})]},`${S}-${D}`))})]})]}),e.jsxs("section",{className:"bg-card border border-border rounded-xl p-6 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 border-b border-border pb-2",children:"Organization"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 relative group",children:[e.jsx("label",{className:"text-sm font-medium",children:"Category"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",required:!0,className:"input w-full",value:h.category||"",onChange:S=>y({...h,category:S.target.value}),placeholder:"Start typing to search categories...",title:h.category}),A.length>0&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-popover border border-border rounded-md shadow-lg max-h-60 overflow-y-auto hidden group-focus-within:block",onScroll:C,children:A.map(S=>e.jsx("button",{type:"button",className:"w-full text-left px-3 py-2 text-sm hover:bg-accent hover:text-accent-foreground truncate block",title:S,onClick:()=>y({...h,category:S}),children:S},S))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Tags (comma separated)"}),e.jsx("input",{type:"text",className:"input w-full",value:h.tags?.join(", ")||"",onChange:S=>{const D=S.target.value.split(",").map(O=>O.trim()).filter(Boolean);y({...h,tags:D})}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Status"}),e.jsxs("select",{className:"input w-full",value:h.status||"draft",onChange:S=>y({...h,status:S.target.value}),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"archived",children:"Archived"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 items-center",children:[i&&x==="bottom"&&e.jsxs("span",{className:"text-sm text-green-600 animate-in fade-in slide-in-from-right-2 flex items-center gap-1",children:[e.jsx(ge,{size:14})," Saved!"]}),e.jsxs("button",{type:"button",onClick:()=>I("bottom"),disabled:r,className:"btn btn-primary flex items-center gap-2",children:[r&&x==="bottom"?e.jsx(ye,{size:18,className:"animate-spin"}):e.jsx(ge,{size:18}),"Save Changes"]})]})]})]})}function pb(){return e.jsx(os,{children:e.jsx(rs,{children:e.jsx(Xt,{children:e.jsx(mb,{children:e.jsx(Wt,{basename:"/open-e-commerce/",children:e.jsx(ns,{children:e.jsx(Vt,{children:e.jsxs(G,{path:"/",element:e.jsx(ls,{}),children:[e.jsx(G,{index:!0,element:e.jsx($e,{})}),e.jsx(G,{path:"category/*",element:e.jsx($e,{})}),e.jsx(G,{path:"product/:id",element:e.jsx(or,{})}),e.jsx(G,{path:"cart",element:e.jsx(dr,{})}),e.jsx(G,{path:"login",element:e.jsx(mr,{})}),e.jsx(G,{path:"register",element:e.jsx(ur,{})}),e.jsxs(G,{element:e.jsx(He,{requireAdmin:!0}),children:[e.jsx(G,{path:"admin",element:e.jsx(db,{})}),e.jsx(G,{path:"admin/product/:id",element:e.jsx(hb,{})})]}),e.jsxs(G,{element:e.jsx(He,{}),children:[e.jsx(G,{path:"profile",element:e.jsx(Ve,{})}),e.jsx(G,{path:"profile/:id",element:e.jsx(Ve,{})}),e.jsx(G,{path:"order/:id",element:e.jsx(ub,{})})]})]})})})})})})})})}Ht.createRoot(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx(pb,{})}));
